Version =20
VersionRequired =20
Checksum =-478559174
Begin Form
    Modal = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    Width =5040
    ItemSuffix =20
    Left =-22692
    Top =1692
    Right =-15864
    Bottom =6492
    RecSrcDt = Begin
        0xd359ddb3b2c4e140
    End
    Caption ="PrintAll American Invoices"
    MenuBar ="Dialog"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010418009c00b803033f80000100010000000000640001000700580202000100 ,
        0x5802000000004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000001000000 ,
        0x0000000000000000000000000000000000000000000000000000000094042e00 ,
        0x4850204c617365724a65742032323030205365726965732050434c2036000000 ,
        0x0000000000000400320090018603789c6590cf4b545114c7bfdf779ede9a3467 ,
        0x51265179d14a0d794d43b46da105428b20f2c7425733e4ab38679807a2483f66 ,
        0x19816d5a14b40882fe8408755bff48d4ba9d3fcaa6fbdee0207816df73bfdf7b ,
        0xb8f7f0c9b2e31511cb1c88427bca2f70ab24e07a0aedcdd5dad02b944db6db36 ,
        0xca56443dc19663ebbde845ca860c426722fd06db8a6d9cb646bd4cbd46bd4a9b ,
        0x6078608c09427bc812749ebac0dccd769c75dc5c70d6b9cbed3acb702ff2bf1b ,
        0xcfa9cf8a9149c680d662b714977037d5345b4ef5116c3146d8dce8f3a19f3294 ,
        0x37a00cf92135b85f12a1a830f39897a827693bd00334f7a17fa1c3b45dd81fe8 ,
        0x3fd859ea20f51cf59d98a70d51fa59839ea6956903b4d7d2fa24fa4a1a5ba2df ,
        0x23f9201f1118c86dbeec3317e908ddd702daf9422f14fa1b417b89c335808de4 ,
        0xf014e2b81b7f3e1af774e3b7ddd86dcb7554ab958a7f506fa6f5cc8fdf9fbae7 ,
        0x6f4dccd69b596aeafdcda49adc482a7ebabe92f83c2da8efe10c648af3914c07 ,
        0xd137d2b853e09c613fac443d45ed0bf862e6849ed0059261e3ff7ab562800000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x0800260038000100000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000048504c617365724a ,
        0x65743232303000
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    Begin
        Begin CommandButton
            TextFontFamily =2
        End
        Begin ComboBox
            SpecialEffect =2
            FontName ="Tahoma"
        End
        Begin Section
            Height =2760
            BackColor =12632256
            Name ="Detail0"
            GUID = Begin
                0x2f8224f191c17b4985279462c41212f9
            End
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =855
                    Top =2040
                    Width =1242
                    Height =598
                    FontSize =8
                    TabIndex =2
                    Name ="Rate"
                    Caption ="Print Sorted by Rate"
                    StatusBarText ="Preview Report"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x95d653096ec72848b1acfa5a845fd866
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =85
                    TextAlign =3
                    Left =861
                    Top =555
                    Width =2010
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text8"
                    Caption ="Invoice Number From: "
                    GUID = Begin
                        0xa478f181575d2443a35dd35acec3e5fb
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =85
                    TextAlign =3
                    Left =885
                    Top =915
                    Width =1980
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text11"
                    Caption ="  Invoice Number To: "
                    GUID = Begin
                        0xc4c2624054a87e498055bf2baafc0fd4
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =60
                    Top =1560
                    Width =4890
                    Height =360
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text16"
                    Caption ="To print \"all\" invoices, leave invoice numbers blank."
                    GUID = Begin
                        0x38ca10e469db754ba4411da1d4dc73e9
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =2715
                    Top =2040
                    Width =1242
                    Height =598
                    FontSize =8
                    TabIndex =3
                    Name ="Name"
                    Caption ="Print Sorted by Name"
                    StatusBarText ="Preview Report"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xff9f1e3c11e1a84eac95485c81bdc73a
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =2901
                    Top =555
                    Width =1413
                    FontSize =10
                    ColumnInfo ="\"\";\"\";\"10\";\"32\""
                    GUID = Begin
                        0xabfeb2f9f6e6494e8848afd24d53b2f0
                    End
                    Name ="InvFrom"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ARHDR.TransactionNumber FROM ARHDR INNER JOIN tblGrp ON ARHDR.CustomerKey"
                        " = tblGrp.GROUPid WHERE (((tblGrp.GroupType)=4)) ORDER BY ARHDR.TransactionNumbe"
                        "r;"
                    FontName ="MS Sans Serif"
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =2901
                    Top =915
                    Width =1413
                    FontSize =10
                    TabIndex =1
                    ColumnInfo ="\"\";\"\";\"10\";\"32\""
                    GUID = Begin
                        0x8ee9ec2ec94d5c4997894348e1eba44c
                    End
                    Name ="InvTo"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ARHDR.TransactionNumber\015\012FROM ARHDR INNER JOIN tblGrp ON ARHDR.Cust"
                        "omerKey = tblGrp.GROUPid\015\012WHERE (((tblGrp.GroupType)=4))\015\012ORDER BY A"
                        "RHDR.TransactionNumber;\015\012"
                    FontName ="MS Sans Serif"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit
Sub BuildTempTables(strSelection As String, strInvFrom As String, strInvTo As String)

    On Error GoTo ErrorHandler
    
    Dim db As DAO.Database
    
    Dim strWhere As String
    Dim strSQL As String
    
    Set db = CurrentDb()
    
    db.Execute "DELETE ARHDR_temp.* FROM ARHDR_temp;", dbSeeChanges
    db.Execute "DELETE ARLIN_temp.* FROM ARLIN_temp;", dbSeeChanges
    
    If strSelection = "All" Then
        'build temp tables for report
        DoCmd.SetWarnings False
        DoCmd.OpenQuery "qappARHDR_temp"
        DoCmd.OpenQuery "qappARLIN_temp"
        DoCmd.SetWarnings True
    ElseIf strSelection = "Range" Then
        'header records
        strWhere = "WHERE [ARHDR].[TransactionNumber] Between '" & strInvFrom & "' and '" & strInvTo & "';"
        
        strSQL = "INSERT INTO ARHDR_temp ( Custkey, Custname, " & _
             "CustAdd1Trim, Custaddr2, CityStateZip, Tranno, " & _
             "Invdate, Salespkey, Spare, InvTot, GroupType, " & _
             "GroupID, InvoiceType ) " & _
             "SELECT DISTINCTROW ARHDR.CustomerKey, ARHDR." & _
             "CustomerName, Trim([CustomerAddress1]) AS " & _
             "CustAdd1Trim, CustomerAddress2, " & _
             "Trim([CustomerCity]) & ', ' & Trim([CustomerState]) " & _
             "& '  ' & Trim([CustomerZipCode]) AS CityStateZip, " & _
             "ARHDR.TransactionNumber, ARHDR.InvoiceDate, " & _
             "ARHDR.SalespersonKey, ARHDR.Spare, " & _
             "SumInvoice([TransactionNumber]) AS InvTot, tblGrp.GroupType, " & _
             "tblGrp.GroupID, tblGrp.InvoiceType " & _
             "FROM ARHDR INNER JOIN tblGrp ON ARHDR.CustomerKey = tblGrp.GroupID " & _
             strWhere
             
        
        db.Execute strSQL, dbSeeChanges
        
        strWhere = "WHERE [ARLIN].[TransactionNumber] Between '" & strInvFrom & "' and '" & strInvTo & "';"
        
        strSQL = "INSERT INTO ARLIN_temp ( Tranno, Description, "
        strSQL = strSQL & "Unitprice ) "
        strSQL = strSQL & "SELECT DISTINCTROW ARLIN.TransactionNumber, ARLIN."
        strSQL = strSQL & "ItemDescription, ARLIN.Unitprice "
        strSQL = strSQL & "FROM ARLIN " & strWhere
        
        db.Execute strSQL, dbSeeChanges
    End If
    
    db.Close
    Set db = Nothing
    
Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
  
End Sub
Private Sub Name_Click()

    On Error GoTo ErrorHandler
    
    Dim strInvFrom As String
    Dim strInvTo As String
    
    Me.Visible = False
    
    If IsNull([InvFrom]) Then
        Call BuildTempTables("All", "", "")
        DoCmd.OpenReport "rptInvbyNAME_AA", A_PREVIEW, "qrptInv"
    Else
        If Not IsNull([InvFrom]) Then
            strInvFrom = Me![InvFrom]
        End If

        If IsNull([InvTo]) Then
            strInvTo = [InvFrom]
        End If

        If Not IsNull([InvTo]) Then
            strInvTo = Me![InvTo]
        End If
    
        Call BuildTempTables("Range", strInvFrom, strInvTo)
        DoCmd.OpenReport "rptInvbyNAME_AA", A_PREVIEW, "qrptInv"
    End If

Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub
Private Sub Rate_Click()
    
    On Error GoTo ErrorHandler
    
    Dim strInvFrom As String
    Dim strInvTo As String
    
    Me.Visible = False
    
    If IsNull([InvFrom]) Then
        Call BuildTempTables("All", "", "")
        DoCmd.OpenReport "rptInv_AA", A_PREVIEW, "qrptInv"
    Else
        If Not IsNull([InvFrom]) Then
            strInvFrom = Me![InvFrom]
        End If

        If IsNull([InvTo]) Then
            strInvTo = [InvFrom]
        End If

        If Not IsNull([InvTo]) Then
            strInvTo = Me![InvTo]
        End If
        
        Call BuildTempTables("Range", InvFrom, InvTo)
        DoCmd.OpenReport "rptInv_AA", A_PREVIEW, "qrptInv"
    End If
 
Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
  
End Sub