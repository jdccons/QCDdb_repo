Version =20
VersionRequired =20
Checksum =1521942019
Begin Form
    Modal = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    DefaultView =0
    ScrollBars =0
    Width =12225
    ItemSuffix =133
    Left =3945
    Top =330
    Right =13650
    Bottom =6420
    RecSrcDt = Begin
        0xe1b18ba291ade440
    End
    GUID = Begin
        0x46b83ddd145666478f936aa94d621ae8
    End
    NameMap = Begin
        0x0acc0e5500000000b9f595f3667f1d409b69478a65c2db2000000000c26eb118 ,
        0xb8b1e44005000000220100007100660072006d0049006e00760049006e006400 ,
        0x69007600000000000000349751615eab514c9bd4220d3cc03b8e0100000010a1 ,
        0xfc18b8b1e4400000000000000000660073007500620049006e00760049006e00 ,
        0x6400690076000000000000001d611e90a9a1af46a49d7ca2491bf32800000000 ,
        0x5841f918b8b1e440000000009300009371007200790049006e0076004c006900 ,
        0x6e00000000000000850467d145f5a844914ec7c767cca057070000001d611e90 ,
        0xa9a1af46a49d7ca2491bf328430055005300540020004b004500590000000000 ,
        0x00004e81f5d55fab62418f3a85da98e9d27407000000b9f595f3667f1d409b69 ,
        0x478a65c2db20430055005300540020004b0045005900000000000000361952fb ,
        0x81a12e43964edaff0f5c49a000000000af6ce518b8b1e44018b6a70a78e20365 ,
        0x740062006c0047007200700000000000000073a4ac18ec8def479d81914ffab6 ,
        0x46d007000000361952fb81a12e43964edaff0f5c49a0470072006f0075007000 ,
        0x54007900700065000000000000007c4f9012e87d8c4893353549ef3287fc0000 ,
        0x00002b7fd118b8b1e4400000000000000000740062006c005300750062007300 ,
        0x630072000000000000002a5df1aa6cc03847a3243b01bdde9a20070000007c4f ,
        0x9012e87d8c4893353549ef3287fc530075006200430061006e00630065006c00 ,
        0x6c0065006400000000000000acb8dd16b9c17849945a26aa6bc033f907000000 ,
        0x7c4f9012e87d8c4893353549ef3287fc50006c00740043007500730074004b00 ,
        0x6500790000000000000067639120c697d447870eff44a5bafe87070000007c4f ,
        0x9012e87d8c4893353549ef3287fc5300750062005f004c0055004e0061006d00 ,
        0x650000000000000016cf135b2f108142a74a3e5dfdcc18df070000007c4f9012 ,
        0xe87d8c4893353549ef3287fc5300750062004900440000000000000092de078b ,
        0x2d956a4a9822c3177fe9d77e070000007c4f9012e87d8c4893353549ef3287fc ,
        0x530075006200470072006f007500700049004400000000000000ff5d8209c2c7 ,
        0x6a44a0561e61a8d79b2207000000361952fb81a12e43964edaff0f5c49a04700 ,
        0x72006f0075007000490044000000000000005f77eb9d694ed74d87036345f482 ,
        0xc4cc07000000b9f595f3667f1d409b69478a65c2db2043005500530054002000 ,
        0x4e0041004d00450000000000000075060ba4629a2940a1c098da01b2bfa40700 ,
        0x0000b9f595f3667f1d409b69478a65c2db204100440044005200450053005300 ,
        0x20003100000000000000c2b73e6c41b63940aab78e2d6b73fa5e07000000b9f5 ,
        0x95f3667f1d409b69478a65c2db20410044004400520045005300530020003200 ,
        0x0000000000004df4e9c31f87814d909f9c8855e11e0007000000b9f595f3667f ,
        0x1d409b69478a65c2db204300490054005900000000000000fab0671e9a3b0040 ,
        0xb2208c0c956eeb2507000000b9f595f3667f1d409b69478a65c2db2053005400 ,
        0x410054004500000000000000296457627a7ed6429a305aeb7fd51d1607000000 ,
        0xb9f595f3667f1d409b69478a65c2db205a0049005000200043004f0044004500 ,
        0x000000000000301a9309342dd3478278e6e3e130c41d07000000b9f595f3667f ,
        0x1d409b69478a65c2db205400520041004e00530020004e004f00000000000000 ,
        0xddd00da0b70c03458e65eea1f5d4499607000000b9f595f3667f1d409b69478a ,
        0x65c2db2049004e005600200044004100540045000000000000009034b7b686f1 ,
        0xc44d8775beb43b5cf64507000000b9f595f3667f1d409b69478a65c2db205400 ,
        0x450052005200490054004f005200590020004b0045005900000000000000828d ,
        0x4d03242f0f4187d5350df9da8ca507000000b9f595f3667f1d409b69478a65c2 ,
        0xdb204300550053005400200043004c00410053005300000000000000472d9b54 ,
        0x384f7a4397736f6ea3aaafa507000000b9f595f3667f1d409b69478a65c2db20 ,
        0x53005900530044004f00430049004400000000000000e40bb75f97fe1a4d84d3 ,
        0x3c6d9212636007000000b9f595f3667f1d409b69478a65c2db20520065006300 ,
        0x550073006500720049004400000000000000d8d8503b62eea34d9cc410d73bad ,
        0x5a9507000000b9f595f3667f1d409b69478a65c2db2052006500630054006900 ,
        0x6d006500000000000000d6088ee496fcb64085ae62eefcc7d1e307000000b9f5 ,
        0x95f3667f1d409b69478a65c2db20520065006300440061007400650000000000 ,
        0x0000d620331b367a7341b88a7f66c09d209107000000b9f595f3667f1d409b69 ,
        0x478a65c2db205300500041005200450033000000000000003880b75f0e616543 ,
        0x9168b1b67e1ad6f9010000003d9c0f19b8b1e44020004b004500590073006600 ,
        0x72006d0049006e0076004100670065006e0074007300000000000000b9b48d8e ,
        0x11ccc640b1838289d13bee8000000000fab40019b8b1e440e2e0e67700000000 ,
        0x71007200790049006e006400690076004100670074000000000000009eab770c ,
        0xa933f14ebb20863cf3dc858007000000b9b48d8e11ccc640b1838289d13bee80 ,
        0x530075006200730063007200490064000000000000006c29b3a40bb45143b9b3 ,
        0x16092e4c077d07000000b9f595f3667f1d409b69478a65c2db20530050004100 ,
        0x52004500000000000000a9dcb9c8f466ac4f8c11428cc48e1ca50600000046b8 ,
        0x3ddd145666478f936aa94d621ae8660073007500620049006e00760049006e00 ,
        0x640069007600000000000000000000000000000000000000000000000c000000 ,
        0x030000000000000000000000000000000000
    End
    RecordSource ="qfrmInvIndiv"
    Caption ="Sales Receipts Entry - Individual One Off"
    MenuBar ="InvoiceIndiv_One"
    PrtMip = Begin
        0xd002000038040000d0020000d002000000000000a02900004029000001000000 ,
        0x010000006801000000000000a10700000100000000000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00fc0243ff800701001400ea0a6f08640001000002580202000100 ,
        0x5802020000004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200c000fc020000ac13d8c00000000000000000000000000000000000000000 ,
        0x0000000000000000050000000000070000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000c0000000534d544a ,
        0x000000001000b000530065006e006400200074006f0020004d00690063007200 ,
        0x6f0073006f006600740020004f006e0065004e006f0074006500200031003500 ,
        0x20004400720069007600650072000000524553444c4c00556e69726573444c4c ,
        0x00506170657253697a65004c4554544552004f7269656e746174696f6e00504f ,
        0x525452414954005265736f6c7574696f6e0044504936303000436f6c6f724d6f ,
        0x646500323462707000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08002c0041000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x006e756c3a00
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin ComboBox
            SpecialEffect =2
            FontName ="Tahoma"
        End
        Begin FormHeader
            Height =1905
            BackColor =12632256
            Name ="FormHeader0"
            GUID = Begin
                0x0612c27db4e6b14a938baf97bcc44d32
            End
            Begin
                Begin TextBox
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =1449
                    Top =120
                    Width =1020
                    Name ="INPUT_DATE"
                    Format ="m/d/yyyy"
                    FontName ="MS Sans Serif"
                    InputMask ="99/99/0000;0;_"
                    GUID = Begin
                        0x04b11e808f6487448ecaf86f7f32cfae
                    End
                    AsianLineBreak =0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =2565
                            Top =135
                            Width =7965
                            Height =255
                            Name ="Label126"
                            Caption ="Enter a date (usually the first day of the month). Then enter individual custome"
                                "r key  below."
                            GUID = Begin
                                0x291330c9b92ef5439059aed9ef0a6ed6
                            End
                        End
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =144
                    Top =120
                    Width =1245
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="lblINPUT_DATE"
                    Caption ="Input Date: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xa2d83fb1c0ac724da1edc32c49d20ead
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =150
                    Top =435
                    Width =1245
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label125"
                    Caption ="Individual: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x380daafb5fb0aa4c907fb0d71c35cc31
                    End
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =3600
                    Left =1455
                    Top =435
                    Width =1770
                    TabIndex =1
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"10\""
                    GUID = Begin
                        0x8a93bc50dfad4347ad3dba4700edd057
                    End
                    Name ="cboPltCustKeySelect"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tblSubscr.PltCustKey, tblSubscr.Sub_LUName, tblSubscr.SubID FROM tblSubsc"
                        "r INNER JOIN tblGrp ON tblSubscr.SubGroupID=tblGrp.GroupID WHERE (((tblGrp.Group"
                        "Type)=9) AND ((tblSubscr.SubCancelled)=1)) ORDER BY tblSubscr.PltCustKey; "
                    ColumnWidths ="1440;2160"
                    FontName ="MS Sans Serif"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3285
                            Top =450
                            Width =8310
                            Height =255
                            Name ="Label124"
                            Caption ="Select an Individual  customer key for a One Off sales receipt.  Then click File"
                                " | Create Sales Receipt on the menu. "
                            GUID = Begin
                                0x73d32f62b03201498cdaebee05d9401b
                            End
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =3315
                    Top =930
                    Width =8235
                    Height =885
                    Name ="Label132"
                    Caption ="The sales receipts you enter should all be in the same month.  You may enter a d"
                        "ifferent input date for each sales receipt.  However, they must all be in the sa"
                        "me month.  If you have sales receipts for multiple months, create them one month"
                        " at at time.  When you are finished with one month, post that month,\015\012then"
                        " begin entering sales receipts for another month and post that month."
                    GUID = Begin
                        0x30e046df42a1504f8e43a2c075c3469d
                    End
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =5490
            BackColor =12632256
            Name ="Detail Section"
            EventProcPrefix ="Detail_Section"
            GUID = Begin
                0xd7f46e4bd7b8e44c812061d134310775
            End
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =144
                    Top =810
                    Width =1260
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text5"
                    Caption =" Name: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x4e971ad9658baf40936fe0a7e2a1dcad
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =159
                    Top =1065
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text6"
                    Caption =" Address: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x6a9055f6e734994da48356fb559d029a
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =87
                    TextAlign =3
                    Left =159
                    Top =1305
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text7"
                    Caption ="Address 2: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x532645928014e748b67afffe14c16dd4
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =159
                    Top =1575
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text8"
                    Caption ="City: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xe065b30ca32d3e458c37b561aa89f4ea
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =3219
                    Top =1575
                    Width =651
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text9"
                    Caption ="State: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xa697c922692dde40aed4671e01f8555e
                    End
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1449
                    Top =810
                    Width =3171
                    ColumnWidth =2100
                    TabIndex =2
                    Name ="CUST NAME"
                    ControlSource ="CUST NAME"
                    FontName ="MS Sans Serif"
                    EventProcPrefix ="CUST_NAME"
                    GUID = Begin
                        0xfd6565294eff9143896121697f0149ed
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =93
                    Left =1449
                    Top =1065
                    Width =3168
                    TabIndex =3
                    Name ="ADDRESS 1"
                    ControlSource ="ADDRESS 1"
                    FontName ="MS Sans Serif"
                    EventProcPrefix ="ADDRESS_1"
                    GUID = Begin
                        0x810c5d61da743245b982356b67d65d44
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =87
                    Left =1449
                    Top =1305
                    Width =3168
                    TabIndex =4
                    Name ="ADDRESS 2"
                    ControlSource ="ADDRESS 2"
                    FontName ="MS Sans Serif"
                    EventProcPrefix ="ADDRESS_2"
                    GUID = Begin
                        0xe0161faf6ff00c4abe8192a469f48125
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1449
                    Top =1575
                    Width =1728
                    TabIndex =5
                    Name ="CITY"
                    ControlSource ="CITY"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x5f2708bb7ec8884aa4dc267eff668dbb
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =3924
                    Top =1575
                    Width =387
                    Height =225
                    TabIndex =6
                    Name ="STATE"
                    ControlSource ="STATE"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x23082fb11b51f14c8de67ef1d3531e22
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =5040
                    Top =1590
                    Width =1008
                    Height =210
                    TabIndex =7
                    Name ="ZIP CODE"
                    ControlSource ="ZIP CODE"
                    FontName ="MS Sans Serif"
                    InputMask ="00000\\-9999;;_"
                    EventProcPrefix ="ZIP_CODE"
                    GUID = Begin
                        0x3d0b449eeadcd14094486ce225bdc9f7
                    End
                    AsianLineBreak =0
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =3
                            Left =4389
                            Top =1575
                            Width =546
                            Height =225
                            FontWeight =700
                            BackColor =12632256
                            Name ="Text10"
                            Caption ="Zip: "
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0xcc9c097e743ad14ab274d603e0eedf51
                            End
                        End
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =6270
                    Top =60
                    Width =1290
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text67"
                    Caption ="Sale No: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x6e2db96697e74e498a432b0d2b72646b
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =7701
                    Top =60
                    Width =1050
                    TabIndex =8
                    BackColor =12632256
                    Name ="TRANS NO"
                    ControlSource ="TRANS NO"
                    FontName ="MS Sans Serif"
                    EventProcPrefix ="TRANS_NO"
                    GUID = Begin
                        0x01ae97837ed7264a81bc56122e23cdcf
                    End
                    AsianLineBreak =0
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =150
                    Top =240
                    Width =1275
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text69"
                    Caption ="Sls Rec Date:"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x4e38d3ea4be4fe418c2a94e4aff3977f
                    End
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1448
                    Top =240
                    Width =906
                    Name ="INV DATE"
                    ControlSource ="INV DATE"
                    Format ="m/d/yyyy"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    InputMask ="99/99/0000;0;_"
                    OnLostFocus ="[Event Procedure]"
                    EventProcPrefix ="INV_DATE"
                    GUID = Begin
                        0xb577dc19788a8a4a8b31c8653071db0d
                    End
                    AsianLineBreak =0
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =5985
                    Top =315
                    Width =1575
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text73"
                    Caption ="Territory/GEO: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x544940ac327c8d4ebab6ef7ec4eda12d
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =7701
                    Top =315
                    Width =1050
                    TabIndex =9
                    BackColor =12632256
                    Name ="TERRITORY KEY"
                    ControlSource ="TERRITORY KEY"
                    FontName ="MS Sans Serif"
                    EventProcPrefix ="TERRITORY_KEY"
                    GUID = Begin
                        0x4496d6d001cec14894ab1b2435a66e97
                    End
                    AsianLineBreak =0
                End
                Begin Subform
                    OverlapFlags =85
                    Left =1440
                    Top =2160
                    Width =6564
                    Height =3285
                    TabIndex =10
                    Name ="fsubInvIndiv"
                    SourceObject ="Form.fsubInvIndiv"
                    LinkChildFields ="CUST KEY"
                    LinkMasterFields ="CUST KEY"
                    GUID = Begin
                        0xa9dcb9c8f466ac4f8c11428cc48e1ca5
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =159
                    Top =555
                    Width =1260
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text102"
                    Caption ="Plt Cust Key:"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xfd9a22dcbe4b81468c0497baa059afba
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =9405
                    Top =2250
                    Width =1050
                    TabIndex =11
                    BackColor =12632256
                    Name ="CUST CLASS"
                    ControlSource ="CUST CLASS"
                    DefaultValue ="\"INDIV\""
                    FontName ="MS Sans Serif"
                    EventProcPrefix ="CUST_CLASS"
                    GUID = Begin
                        0x1b9d93c521245344999ba3fbffe30c9e
                    End
                    AsianLineBreak =0
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =3
                            Left =8175
                            Top =2250
                            Width =1215
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="Text103"
                            Caption ="Cust Class: "
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0xb980e4b8d8ff8b42a4112e065db31c21
                            End
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =8850
                    Top =300
                    Width =2445
                    TabIndex =12
                    BackColor =12632256
                    Name ="txtGeoDesc"
                    ControlSource ="=DLookUp(\"[GEODESC]\",\"tblGeographical\",\"[GeoID] = Forms![frmInvIndiv_One]!["
                        "TERRITORY KEY]\")"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xfd121bf33915964ba420a7096dcdf6ff
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8955
                    Top =2880
                    Width =1020
                    TabIndex =13
                    BackColor =65535
                    Name ="txtSYSDOCID"
                    ControlSource ="SYSDOCID"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xad861bd1e2439542820aa2a6367efc88
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8955
                    Top =3225
                    Width =1020
                    TabIndex =14
                    BackColor =65535
                    Name ="txtRecUserID"
                    ControlSource ="RecUserID"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x72dccac932676e4bbf25e0df0a7c86cb
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =10005
                    Top =2880
                    Width =1020
                    TabIndex =15
                    BackColor =65535
                    Name ="txtRecTime"
                    ControlSource ="RecTime"
                    Format ="Long Time"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xaddd005c7e009a4994fd49d5c0c5c365
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =10035
                    Top =3225
                    Width =1020
                    TabIndex =16
                    BackColor =65535
                    Name ="txtRecDate"
                    ControlSource ="RecDate"
                    Format ="Short Date"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xf9436d152aab5b45bfd1733c1418110c
                    End
                    AsianLineBreak =0
                End
                Begin Subform
                    Locked = NotDefault
                    OverlapFlags =87
                    SpecialEffect =2
                    Left =6336
                    Top =840
                    Width =5715
                    Height =1260
                    TabIndex =17
                    Name ="sfrmAgentsAA"
                    SourceObject ="Form.sfrmInvAgents"
                    LinkChildFields ="SubscrId"
                    LinkMasterFields ="SPARE"
                    GUID = Begin
                        0xcd516eca9eff7d409b52c3c93ca3f399
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =1
                    Left =6303
                    Top =600
                    Width =1275
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label123"
                    Caption ="Agents: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xbeb7c14ce4025c44b8a60b75bdeb0350
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =2649
                    Top =510
                    TabIndex =18
                    BackColor =10092543
                    Name ="SubID"
                    ControlSource ="SPARE3"
                    StatusBarText ="The QCD assign subscriber ID.  This is an eight digit number that will print on "
                        "cards.  It is not an SSN."
                    GUID = Begin
                        0xf5614afd0620374d9f3755e129c50c88
                    End
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1449
                    Top =555
                    Width =906
                    TabIndex =1
                    Name ="CUST KEY"
                    ControlSource ="CUST KEY"
                    FontName ="MS Sans Serif"
                    EventProcPrefix ="CUST_KEY"
                    GUID = Begin
                        0xed250adfd27b9844ba1ba108cd978047
                    End
                End
            End
        End
        Begin FormFooter
            Height =555
            BackColor =12632256
            Name ="FormFooter1"
            GUID = Begin
                0xff294530ec6f79448c7c49b9a41ceecd
            End
            Begin
                Begin TextBox
                    FELineBreak = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =7020
                    Top =90
                    Width =1332
                    Height =255
                    Name ="INVOICE TOTAL"
                    ControlSource ="=IIf(IsNumeric(fsubInvIndiv.Form!SubTotal),fsubInvIndiv.Form!SubTotal,0)"
                    Format ="$#,##0.00;($#,##0.00)"
                    FontName ="MS Sans Serif"
                    EventProcPrefix ="INVOICE_TOTAL"
                    GUID = Begin
                        0x66f8f54fbb8e2f48abbbc8c59ca11d20
                    End
                    AsianLineBreak =0
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =5670
                    Top =90
                    Width =1335
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text92"
                    Caption ="SaleTotal: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x545cc160e43fe0429a10b7075c9f700f
                    End
                End
                Begin Line
                    OverlapFlags =85
                    Left =5805
                    Top =360
                    Width =2592
                    Name ="Line115"
                    GUID = Begin
                        0x168dd25f5199e9448adeb38f27a8995d
                    End
                End
                Begin Line
                    OverlapFlags =85
                    Left =5805
                    Top =420
                    Width =2592
                    Name ="Line116"
                    GUID = Begin
                        0xbc2615a7d20dbe42b75c4a1a6d223528
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3195
                    Top =45
                    Width =288
                    Height =288
                    FontSize =8
                    TabIndex =1
                    ForeColor =8454143
                    Name ="btnPostPlt"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x9ce82db2d887ee44915e70b55c2c4314
                    End
                    Begin
                        Begin Label
                            Visible = NotDefault
                            BackStyle =1
                            OldBorderStyle =1
                            OverlapFlags =85
                            Left =3483
                            Top =45
                            Width =1515
                            Height =315
                            BackColor =8454143
                            BorderColor =255
                            ForeColor =255
                            Name ="lblPostPlt"
                            Caption ="Post sales receipt(s)"
                            GUID = Begin
                                0xdba41cf0169d01418843808eadfc3c26
                            End
                        End
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =8460
                    Top =90
                    Width =288
                    Height =288
                    TabIndex =2
                    Name ="btnDelete"
                    OnClick ="[Event Procedure]"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff000000c0c0c000ffff00000000ff00c0c0c00000ffff00 ,
                        0xffffff0000000000
                    End
                    ControlTipText ="Delete Record"
                    GUID = Begin
                        0x0e64bba7a28ab34b833fde13452a0659
                    End
                    Begin
                        Begin Label
                            Visible = NotDefault
                            BackStyle =1
                            OldBorderStyle =1
                            OverlapFlags =85
                            Left =8748
                            Top =75
                            Width =1515
                            Height =285
                            BackColor =8454143
                            BorderColor =255
                            ForeColor =255
                            Name ="Label131"
                            Caption ="Delete"
                            GUID = Begin
                                0xc8166f5092200840b0ffc762f7d5b7a4
                            End
                        End
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =120
                    Top =45
                    Width =288
                    Height =288
                    FontSize =8
                    TabIndex =3
                    Name ="btnCreateInvoice"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xc27da3f9302b5b458fb90aa7d395379b
                    End
                    Begin
                        Begin Label
                            Visible = NotDefault
                            BackStyle =1
                            OldBorderStyle =1
                            OverlapFlags =85
                            Left =450
                            Top =45
                            Width =2340
                            Height =255
                            BackColor =8454143
                            BorderColor =255
                            ForeColor =255
                            Name ="Label127"
                            Caption ="Create One Off sales receipt(s)"
                            GUID = Begin
                                0xc53e1a164c90314dbcdbb15dbec1867d
                            End
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit

'Declare module level global variables
Dim mstrCustKey As String
Dim mstrTranNo As String
Dim mlngSysDocId As Long
Dim mdteSalesReceiptDate As Date
Public Sub btnCreateInvoice_Click()
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    ' Object:   btnCreateInvoice
    ' Purpose:  This procedure creates individual invoice(s);
    '           calls a stored procedure that retrieves data
    '           from the SQL Server database and populates a
    '           temp table bound to the form
    '
    ' Stored Proc:     usp_InvoicePreIndiv
    ' Parameters:      InvoiceDate DateTime
    '                  PltCustKey nchar(5)
    '                  UserName nvarchar(20)
    '
    ' Date Created:     9/15/2014
    ' Developer:        John Criswell
    '
    ' Change Log
    ' Date Modified     Version     Developer       Purpose
    ' ------------------------------------------------------------
    ' 2015-09-15        1.0         J Criswell      Creates sales receipts
    '
    ' ------------------------------------------------------------
    ' None
    '
    ' Returns:
    ' ------------------------------------------------------------
    ' Nothing
    '
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    
    On Error GoTo PROC_ERR
    
    Dim proc_name As String
    Dim strCustKey As String
    Dim dteSalesReceiptDate As Date
    Dim strUserName As String
    Dim strDocumentNumber As String
    Dim dblDocumentAmt As Double
    Dim strSQL As String
    
    If Me.cboPltCustKeySelect = "" Then
        MsgBox "You must select a PltCustKey before creating an invoice.", vbOKOnly, "QCD: One Off Invoice"
        Me.cboPltCustKeySelect.SetFocus
        GoTo PROC_EXIT
    End If
    
    ' set values for variables
    proc_name = "usp_InvoicePreIndiv"
    
    strUserName = GetCurrentUserName()
    
    With Me
        strCustKey = .cboPltCustKeySelect
        If IsDate(.INPUT_DATE) Then
            dteSalesReceiptDate = .INPUT_DATE
        Else
            dteSalesReceiptDate = FirstDayInMonth(date)
        End If
    End With
    
    ' get the indivual's rate
    strSQL = "SELECT PltCustKey, '" & dteSalesReceiptDate & "', " & "s.SubRate"
    strSQL = strSQL & " FROM tblSubscr s"
    strSQL = strSQL & " WHERE s.PltCustKey = '" & strCustKey & "';"
    LoadADORecordset (strSQL)
    dblDocumentAmt = Nz(g_adoRS("SubRate"))
    If g_adoRS.STATE = adStateOpen Then g_adoRS.Close
    If g_adoConnection.STATE = adStateOpen Then g_adoConnection.Close
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    ' validate INPUT_DATE control
    If IsNull(Me.INPUT_DATE) Or Me.INPUT_DATE = "" Or IsNull(Me.cboPltCustKeySelect) Or Me.cboPltCustKeySelect = "" Then
        MsgBox "You must first enter an input date and then select an individual from the Individual drop down."
        Me.INPUT_DATE.SetFocus
    Else
        '  check for duplicate PltCustKeys
        If DupPltCustKeys() Then
            MsgBox "There are duplicate PltCustKeys.  The process will fail unless the duplicates are fixed."
            GoTo PROC_EXIT
        End If
        
        ' check to see if a transaction
        ' for this subscriber
        ' has previously been posted in this month
        ' if yes, then message and exit
        If IsThereOneOff(strCustKey, dteSalesReceiptDate, dblDocumentAmt) Then
             MsgBox "This sales receipt is already in the transaction table.  " & vbCrLf & _
            "Please remove the sales receipt in the transaction table if you want to " & vbCrLf & _
            "process this sales receipt." & vbCrLf & vbCrLf & _
            "If you feel the transaction in the transaction table is valid, " & vbCrLf & _
            "then you do not try to enter it again.", vbCritical, "QCD Sales Receipts: Process Error."
            GoTo PROC_EXIT
        End If
        
        ' save the date entered in INPUT_DATE
        Call SaveInvoiceDate(dteSalesReceiptDate)
        
        ' create the sales receipt
        If Create_Invoice_Data(proc_name, dteSalesReceiptDate, strCustKey, strUserName) Then
            MsgBox "The sales receipt was created and stored in a temp table.", vbOKOnly, "QCD: Create One Off sales receipts"
            Me.cboPltCustKeySelect = ""
            Forms![frmInvIndiv_One].Requery
        Else
            MsgBox "There was an issue creating your sales receipt. Contact support.", vbOKOnly, "QCD: Create One Off sales receipts"
            Me.Refresh
        End If
    End If
    
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
    
PROC_EXIT:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub
    
PROC_ERR:
    If Err.Number = 94 Then
        Resume Next
    Else
        MsgBox "The following error occured: " & Error$
    End If
    Resume Next
    
End Sub


Public Sub btnPostPlt_Click()
'================================================================================
' Object:                   btnPostPlt_Click
' Purpose:                  Post sales receipts transactions to
'                           transaction table and exports transactions
'                           to a csv file.  This procedure was designed
'                           for the yearly one-offs.  It does not do
'                           bulk monthlies like the procedure in
'                           frmInvIndiv_btnPostAllToPlat_Click
'
'
' VBA Parameters            ParameterName   DateType    Returns
' -------------------------------------------------------------------------------
' None
'
' Stored Procedures:        Name                            Parms               DataType        Returns     Notes
'                           usp_InvoicePostIndiv            SalesReceiptDate    Date            integer
'                                                           UserName            nvarchar(20)
'                           usp_IndividualInvoice_One_csv   SalesReceiptDate    Date            integer
'                                                           UserName            nvarchar(20)
'
'
' Change Log
' Date Modified     Version       Developer         Purpose
' -------------------------------------------------------------------------------
' 2014-09-14        1.0           J Criswell        Created
'
'
'
'=================================================================================
    
    
    On Error GoTo PROC_ERR
    
    Dim strSQL As String
    Dim dteSalesReceiptDate As Date
    Dim strSubID As String
    Dim strUserName As String
    Dim strInput As String
    
    strSubID = Me.SubID
    strUserName = GetCurrentUserName()
        
    ' prompt user for invoice date
    strInput = InputBox("Enter any date in the month you want to post - i.e. 11/16/2015. Any date in the month you wish to post will post all sales receipts for that month.", "QCD Sales Receipts: Post")
    Select Case StrPtr(strInput)
        Case 0
            GoTo PROC_EXIT
        Case Else
            Do While Not IsDate(strInput)
                Select Case StrPtr(strInput)
                    Case 0
                        GoTo PROC_EXIT
                    Case Else
                        strInput = InputBox("The date you entered is not a valid date." & vbCrLf & "Please re-enter a valid sales receipt date.", "QCD Sales Receipts: Post")
                End Select
            Loop
    End Select
    dteSalesReceiptDate = CDate(strInput)
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False

    '  check for duplicate PltCustKeys
    If DupPltCustKeys() Then
        MsgBox "There are duplicate PltCustKeys in the subscriber table.  The process will fail unless the duplicates are fixed.", vbCritical, "QCD Sales Receipts: Dup PltCustKey in Cust table."
        GoTo PROC_EXIT
    End If
    
    ' check for sales receipts in temp table
    ' that appear to be duplicates based on
    ' the customer key and sales receipt amount being the same
    If IsThereDupOneOff() Then
        MsgBox "One or more of the sales receipts appear to be duplicates.  Please remove them from the temp table.", vbCritical, "QCD Sales Receipts: Process Error."
        GoTo PROC_EXIT
    End If
    
    ' run post process
    ' processes pre-condition sales receipts in
    ' and inserts them into ARTRANH_local
    If InvoicePostIndiv("usp_InvoicePostIndivOne", dteSalesReceiptDate, strUserName) Then
        ' nothing
    Else
        MsgBox "The stored procedure to add invoices to the invoice table failed." & vbCrLf & "Contact support.", vbCritical, "QCD Sales Receipts: Process Error."
        GoTo PROC_EXIT
    End If
    
    ' check ARTRANH_local
    ' to see if sales receipt posted correctly
    If DidAllInvoicesPosttoPlat() Then
        MsgBox "sales receipts were properly saved to the transaction table.", vbInformation, "QCD Sales Receipts: Process Success."
    Else
        MsgBox "sales receipts were not save properly to the transaciton table.", vbCritical, "QCD Sales Receipts: Process Error."
        GoTo PROC_EXIT
    End If
    
    ' create csv file
    ' for importing into QuickBooks;
    ' run stored procedure that calls the SSIS package to
    ' create a CSV file for all the "One Offs" the user created
    If Export_Invoice_Data("usp_InvoicePostIndivOne_csv", dteSalesReceiptDate, strUserName) Then
        MsgBox "sales receipt data export succeeded.", vbInformation, "QCD Sales Receipts: Process Success."
    Else
        MsgBox "sales receipt data export failed.", vbCritical, "QCD Sales Receipts: Process Error."
        GoTo PROC_EXIT
    End If
    
    'remove data from form
    DoCmd.OpenQuery "qdelDelInvHdr_AllIndiv"
    Me.cboPltCustKeySelect = ""
    Me.Requery
    Me.[INPUT_DATE].SetFocus
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
    Exit Sub
    
PROC_EXIT:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub
    
PROC_ERR:
    MsgBox "There was an error processing Individual sales receipts." & vbCrLf & _
    vbCrLf & "The error number is: " & Err.Number & " and the system Error message is: " & Err.DESCRIPTION, vbCritical, "Procedure:  frmInvIndiv_One_btnPostPlt_Click"
    Resume PROC_EXIT
    
End Sub

Private Sub Form_Load()
    On Error GoTo PROC_ERR
    
    Dim strOpenArgs As String
    strOpenArgs = Me.OpenArgs
    
    If strOpenArgs <> "" Or Not IsNull(strOpenArgs) Then
        Me.cboPltCustKeySelect = strOpenArgs
    Else
        Me.cboPltCustKeySelect = ""
    End If
    
    With Me
        .INPUT_DATE.SetFocus
    End With
    
PROC_EXIT:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub
    
PROC_ERR:
    If Err.Number = 94 Then
        Resume Next
    Else
        MsgBox "Error number " & Err.Number & ": " & Err.DESCRIPTION
        Resume PROC_EXIT:
    End If
    
End Sub

Private Sub INV_DATE_AfterUpdate()

'============================================================================================================
' Object:                   INV_DATE_AfterUpdate
' Purpose:                  Saves the entered invoice date for reuse.
'
'
' VBA Parameters:           Name   DateType       Returns
' -----------------------------------------------------------------------------------------------------------
' None
'
' Stored Procedures:        Name                        Parms               DataType        Returns     Notes
' -----------------------------------------------------------------------------------------------------------
' None
'
' Change Log
' Date Modified     Version       Developer         Purpose
' -----------------------------------------------------------------------------------------------------------
' Date              1.0           Developer's Name  Created
'
'
'
'============================================================================================================


    
    On Error GoTo PROC_ERR
    
    Dim strSQL As String
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    mdteSalesReceiptDate = Me.INPUT_DATE
    
    ' save the date entered in INPUT_DATE
    Call SaveInvoiceDate(mdteSalesReceiptDate)
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
    Exit Sub
    
PROC_EXIT:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub
    
PROC_ERR:
    If Err.Number = 94 Then
        Resume Next
    Else
        MsgBox "Error number " & Err.Number & ": " & Err.DESCRIPTION
        Resume PROC_EXIT:
    End If
    
End Sub

Private Sub INV_DATE_LostFocus()
    
    Call INV_DATE_AfterUpdate
    
End Sub

' --------------   deletes the current sales receipt   ---------
Public Sub btnDelete_Click()
    
    On Error GoTo Err_btnDelete_Click
    
    If MsgBox("Do you wish to delete this record?", vbYesNo, "Delete Confirmation") = vbYes Then
        Me.Refresh
        DoCmd.RunCommand acCmdDeleteRecord
    End If
    Me.Requery
    Me.Refresh
    Me.[INPUT_DATE].SetFocus

Exit_btnDelete_Click:
Exit Sub

Err_btnDelete_Click:
MsgBox Err.DESCRIPTION
Resume Exit_btnDelete_Click

End Sub