Version =17
VersionRequired =17
Checksum =-612876026
Begin Form
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DefaultView =0
    ScrollBars =0
    Width =6045
    ItemSuffix =24
    Left =1080
    Top =1125
    Right =7125
    Bottom =5775
    RecSrcDt = Begin
        0x2223dcb3b2c4e140
    End
    Caption ="Contract Expiration Report - Group"
    Begin
        Begin CommandButton
            TextFontFamily =2
        End
        Begin Section
            Height =4663
            BackColor =12632256
            Name ="Detail0"
            Begin
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =3
                    Left =735
                    Top =705
                    Width =2565
                    Height =210
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text67"
                    Caption ="Contract Ending Date From: "
                End
                Begin OptionGroup
                    SpecialEffect =1
                    OverlapFlags =85
                    Left =1950
                    Top =2340
                    Width =2879
                    Height =1335
                    TabIndex =4
                    Name ="OptSortBy"
                    DefaultValue ="1"
                    Begin
                        Begin Label
                            BackStyle =0
                            OverlapFlags =215
                            Left =2130
                            Top =2505
                            Width =1560
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="LblSortBy"
                            Caption ="Sort By"
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =2670
                            Top =2820
                            Width =165
                            Height =180
                            OptionValue =1
                            Name ="BtnCustID"
                            Begin
                                Begin Label
                                    BackStyle =0
                                    OverlapFlags =95
                                    Left =2958
                                    Top =2820
                                    Width =1740
                                    Height =240
                                    BackColor =12632256
                                    Name ="LblContractEnd"
                                    Caption ="Contract Ending Date"
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =2670
                            Top =3060
                            Width =165
                            Height =180
                            OptionValue =2
                            Name ="BtnCustName"
                            Begin
                                Begin Label
                                    BackStyle =0
                                    OverlapFlags =95
                                    Left =2958
                                    Top =3060
                                    Width =1740
                                    Height =240
                                    BackColor =12632256
                                    Name ="LblGeo"
                                    Caption ="Geographical"
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =2670
                            Top =3300
                            Width =1584
                            OptionValue =3
                            Name ="Button21"
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =2954
                                    Top =3300
                                    Width =1740
                                    Height =240
                                    BackColor =12632256
                                    Name ="LblGroup"
                                    Caption ="Group"
                                End
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =82
                    Left =2916
                    Top =4185
                    Width =717
                    Height =478
                    TabIndex =5
                    Name ="PreviewButton"
                    Caption ="Print Preview&R"
                    StatusBarText ="Preview Report"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000017000000160000000100040000000000080100000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888889888888888888888888888884 ,
                        0x88888888888888888888888388888888888888888888888e8888000000000000 ,
                        0x8800888288880ffffffffff08000888d88880fffffff00007008888888880fff ,
                        0xfff078870788888588880fffff0788f77088888288880fffff08888780888884 ,
                        0x88880fffff08f8878088888888880fffff07ff877088888088880ffffff07887 ,
                        0x0888888088880fffffff00008888888088880ffffffffff08888888088880fff ,
                        0xffff00008888888088880fffffff08088888888188880fffffff008888888886 ,
                        0x8888000000000888888888808888888888888888888888808888888888888888 ,
                        0x8888888088888888888888888888888000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =87
                    Left =3300
                    Top =705
                    Width =1005
                    Name ="FromDate"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0000;0;_"
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =85
                    Left =3300
                    Top =1065
                    Width =1005
                    TabIndex =1
                    Name ="ToDate"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0000;0;_"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =2715
                            Top =1065
                            Width =555
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="Text7"
                            Caption ="To: "
                        End
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =3
                    Left =1308
                    Top =1425
                    Width =2010
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text15"
                    Caption ="Geographical From: "
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =3
                    Left =1284
                    Top =1785
                    Width =2010
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text8"
                    Caption =" To: "
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    LimitToList = NotDefault
                    SpecialEffect =2
                    OverlapFlags =215
                    ColumnCount =2
                    ListWidth =3670
                    Left =3300
                    Top =1425
                    Width =1000
                    TabIndex =2
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"5\""
                    Name ="c-GEOfrom"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT qryGeoID.GEOid AS Geo_ID, qryGeoID.GEOdesc AS Geo_Description FROM qryGeo"
                        "ID ORDER BY qryGeoID.GEOid;"
                    ColumnWidths ="915;2505"
                    EventProcPrefix ="c_GEOfrom"
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    LimitToList = NotDefault
                    SpecialEffect =2
                    OverlapFlags =87
                    ColumnCount =2
                    ListWidth =3670
                    Left =3300
                    Top =1785
                    Width =1000
                    TabIndex =3
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"5\""
                    Name ="c-GEOto"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT qryGeoID.GEOid AS Geo_ID, qryGeoID.GEOdesc AS Geo_Description FROM qryGeo"
                        "ID ORDER BY qryGeoID.GEOid;"
                    ColumnWidths ="915;2505"
                    EventProcPrefix ="c_GEOto"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit


Private Sub PreviewButton_Click()

On Error GoTo Err_PreviewButton_Click

    Dim strWhere As String
    Dim strData As String
    strData = "qrptContExpirGrp"

    'contract expiration date
    If Not IsNull([FromDate]) Then
        If Not IsNull([ToDate]) Then
            strWhere = "[GRcontEND] BETWEEN #" & Me![FromDate] & "# AND #" & Me![ToDate] & "#"
        Else
            strWhere = "[GRcontEND] >= #" & [FromDate] & "#"
        End If
    ElseIf Not IsNull([ToDate]) Then
        strWhere = "[GRcontEND] <= #" & Me![ToDate] & "#"
    End If

    'geographical id
    If Not IsNull([c-GEOfrom]) Then
        If Not IsNull([c-GEOto]) Then
            If strWhere = "" Then
                strWhere = "[GRPgeoID] BETWEEN '" & Me![c-GEOfrom] & "' AND '" & Me![c-GEOto] & "'"
            Else
                strWhere = strWhere & " AND [GRPgeoID] BETWEEN '" & Me![c-GEOfrom] & "' AND '" & Me![c-GEOto] & "'"
            End If
        Else
            If strWhere = "" Then
                strWhere = "[GRPgeoID] >= '" & Me![c-GEOfrom] & "'"
            Else
                strWhere = strWhere & " AND [GRPgeoID] >= '" & Me![c-GEOfrom] & "'"
            End If
        End If
    ElseIf Not IsNull([c-GEOto]) Then
        If strWhere = "" Then
            strWhere = "[GRPgeoID] <= '" & Me![c-GEOto] & "'"
        Else
            strWhere = strWhere & " AND [GRPgeoID] <= '" & Me![c-GEOto] & "'"
        End If
    End If
    
    '' check to see if criteria produces any records
    
   If DCount("*", strData, strWhere) = 0 Then
        MsgBox "The criteria you have chosen has resulted in no records." & vbCrLf & vbCrLf & "Please make another criteria selection and try again!"
        DoCmd.Hourglass False
    Exit Sub
   
        Else
        
    DoCmd.Hourglass True
    gintSortOrder = Me![OptSortBy]
    Me.Visible = False
    DoCmd.OpenReport "rptContExpirGrp", A_PREVIEW, , strWhere
    DoCmd.Hourglass False
  End If
Exit_PreviewButton_Click:
    Exit Sub

Err_PreviewButton_Click:
    MsgBox Error$
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Resume Exit_PreviewButton_Click

End Sub