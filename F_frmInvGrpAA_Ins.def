Version =20
VersionRequired =20
Checksum =-262342953
Begin Form
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    Width =10224
    ItemSuffix =124
    Left =8130
    Top =105
    Right =10530
    Bottom =5625
    RecSrcDt = Begin
        0x20d75f84d4b1e440
    End
    GUID = Begin
        0x7f0abb27250d9e49af1275412e7c1357
    End
    NameMap = Begin
        0x0acc0e5500000000ffdce768b1f7ed43a2160a368771b82b000000005ebf39e9 ,
        0x54bce440fd110088ea60cc02740062006c0049006e0076004800640072000000 ,
        0x00000000321586a0647ca644bb346e5a10b7a49007000000ffdce768b1f7ed43 ,
        0xa2160a368771b82b5300500041005200450033000000000000005dd9f7d07c2b ,
        0x7f4ab6b08c0d2792203407000000ffdce768b1f7ed43a2160a368771b82b4300 ,
        0x55005300540020004b00450059000000000000001ae03749916bf24a8566a4a3 ,
        0x61f6b6ea07000000ffdce768b1f7ed43a2160a368771b82b4300550053005400 ,
        0x20004e0041004d004500000000000000f19941449feb154c9ea34e9dee4db911 ,
        0x07000000ffdce768b1f7ed43a2160a368771b82b410044004400520045005300 ,
        0x53002000310000000000000096debd002e7c69449e6722d189f8bc1507000000 ,
        0xffdce768b1f7ed43a2160a368771b82b41004400440052004500530053002000 ,
        0x320000000000000042aa22d46ef95a469992684b1d975d6507000000ffdce768 ,
        0xb1f7ed43a2160a368771b82b4100440044005200450053005300200033000000 ,
        0x00000000e879be30f51a0f4c87ab1a0f411ed30f07000000ffdce768b1f7ed43 ,
        0xa2160a368771b82b4300490054005900000000000000938685b85aa9444294d7 ,
        0xda346896cea907000000ffdce768b1f7ed43a2160a368771b82b530054004100 ,
        0x540045000000000000007868deb34adb70498202f09f8f6a66d307000000ffdc ,
        0xe768b1f7ed43a2160a368771b82b5a0049005000200043004f00440045000000 ,
        0x0000000098c7daaf2accb64cbd73b595fd612e4307000000ffdce768b1f7ed43 ,
        0xa2160a368771b82b43004f0055004e005400520059000000000000009af3d990 ,
        0xe5640e498a5cbd67b50667df07000000ffdce768b1f7ed43a2160a368771b82b ,
        0x41005400540045004e00540049004f004e000000000000003f2318d8f5fcd349 ,
        0xb83c7dee94214c0d07000000ffdce768b1f7ed43a2160a368771b82b54005200 ,
        0x41004e00530020004e004f00000000000000b9d7163706edd240a835892034cd ,
        0xfe2707000000ffdce768b1f7ed43a2160a368771b82b4100500050004c005900 ,
        0x2d0054004f0000000000000095e957053070b54d8441cafb7426502607000000 ,
        0xffdce768b1f7ed43a2160a368771b82b530045004c0020005300540041005400 ,
        0x55005300000000000000089542ae657c154fb99fb25840d8a3e707000000ffdc ,
        0xe768b1f7ed43a2160a368771b82b49004e005600200044004100540045000000 ,
        0x00000000ca2d86ccefeb22438295c0c8d42ac6bd07000000ffdce768b1f7ed43 ,
        0xa2160a368771b82b520045004300520020004300590043004c00450000000000 ,
        0x0000b885a38bb173e14c803b26da15927ba107000000ffdce768b1f7ed43a216 ,
        0x0a368771b82b4200550059004500520000000000000043401d33baddb745bed8 ,
        0x2a8491d842d007000000ffdce768b1f7ed43a2160a368771b82b430055005300 ,
        0x5400200050004f000000000000000cde6ac1216e664e980cf5453270513f0700 ,
        0x0000ffdce768b1f7ed43a2160a368771b82b43004800450043004b0020004e00 ,
        0x4f0000000000000043839da730313642b7efda7dd0303f6307000000ffdce768 ,
        0xb1f7ed43a2160a368771b82b43004800450043004b00200041004d0054005200 ,
        0x0000000000006720789d2e6cbb44941eb83e934d14bc07000000ffdce768b1f7 ,
        0xed43a2160a368771b82b43004f004d004d0020004f0056005200440000000000 ,
        0x0000cae88d6cb310584182154cccbeaf7e2a07000000ffdce768b1f7ed43a216 ,
        0x0a368771b82b4c004f0043004100540049004f004e00200020004b0045005900 ,
        0x0000000000001342eb778ea8fc4fb098cf7d3b0bf86807000000ffdce768b1f7 ,
        0xed43a2160a368771b82b5400450052005200490054004f005200590020004b00 ,
        0x4500590000000000000026233ed5e24fa240abd34c73af59976307000000ffdc ,
        0xe768b1f7ed43a2160a368771b82b530041004c00450053005000200020002000 ,
        0x20004b0045005900000000000000a4ce18d968aa4143a30453cf6bcf0e800700 ,
        0x0000ffdce768b1f7ed43a2160a368771b82b5400450052004d00530000000000 ,
        0x000033bfcdd0e2d9224ba313d74763f48e0b07000000ffdce768b1f7ed43a216 ,
        0x0a368771b82b46004f00420000000000000072940e720b986b4daf5baa48a60e ,
        0x753b07000000ffdce768b1f7ed43a2160a368771b82b53004800490050002000 ,
        0x560049004100000000000000dc10a4df09f94b4ab024706a8070fad707000000 ,
        0xffdce768b1f7ed43a2160a368771b82b43004f004d004d0045004e0054002000 ,
        0x4b00450059000000000000002b335bbe88bb1344955af87c8f51614b07000000 ,
        0xffdce768b1f7ed43a2160a368771b82b4300550053005400200043004c004100 ,
        0x53005300000000000000401f2f890b75ed47a2f041dd0047042107000000ffdc ,
        0xe768b1f7ed43a2160a368771b82b460052004500490047004800540000000000 ,
        0x0000c403fd3cdf42864d9a1b491c9478241007000000ffdce768b1f7ed43a216 ,
        0x0a368771b82b44004900530043004f0055004e00540020004d0055004c005400 ,
        0x0000000000000fb383a00a465248b763e1dc7d9c60e707000000ffdce768b1f7 ,
        0xed43a2160a368771b82b4300520020004d0045004d004f00200046004c004100 ,
        0x47000000000000001567ada50986ac488d342512bf0f85ca07000000ffdce768 ,
        0xb1f7ed43a2160a368771b82b49004e0056004f0049004300450020004e004f00 ,
        0x000000000000c2cb119b2fde304496aac4e3fd52c97607000000ffdce768b1f7 ,
        0xed43a2160a368771b82b530050004100520045000000000000009481f54f2732 ,
        0xf1428194ba7248e10fe907000000ffdce768b1f7ed43a2160a368771b82b5300 ,
        0x50004100520045003200000000000000e4ca074e4aca4042a69a22f3ec5fb7d7 ,
        0x07000000ffdce768b1f7ed43a2160a368771b82b49004e0056004f0049004300 ,
        0x450054004f00540041004c00000000000000a58a4c9ca30e2d4aa2023b909e7a ,
        0x6e2307000000ffdce768b1f7ed43a2160a368771b82b53005900530044004f00 ,
        0x430049004400000000000000aa334a372d6e364bb97b19edeea3ab8d07000000 ,
        0xffdce768b1f7ed43a2160a368771b82b52006500630055007300650072004900 ,
        0x44000000000000007e03c38934016e4b905e9fca781742e407000000ffdce768 ,
        0xb1f7ed43a2160a368771b82b5200650063004400610074006500000000000000 ,
        0x37e602b889c67845ae1661dd709d360b07000000ffdce768b1f7ed43a2160a36 ,
        0x8771b82b520065006300540069006d006500000000000000a00da54796d9e945 ,
        0x9162fe4ffc7569b307000000ffdce768b1f7ed43a2160a368771b82b75007000 ,
        0x730069007a0065005f00740073000000000000002151adfa0acd59438c51e7e2 ,
        0x3e1371f507000000ffdce768b1f7ed43a2160a368771b82b4400610074006500 ,
        0x4d006f00640069006600690065006400000000000000b28e9cc4e2aceb4db898 ,
        0xa99649d8d3d701000000df52e282d4b1e440a46dbf0400000000660073007500 ,
        0x620049006e007600470072007000410041000000000000001d611e90a9a1af46 ,
        0xa49d7ca2491bf328000000005841f918b8b1e44000000000c90100c871007200 ,
        0x790049006e0076004c0069006e0000000000000075258fb9db7e0c4fa61a7834 ,
        0x5264af39070000001d611e90a9a1af46a49d7ca2491bf3284300550053005400 ,
        0x20004b0045005900000000000000438da9268fd2ef4eac658e3f4b975ac40100 ,
        0x0000c0a0ad82d4b1e44020004b00450059007300660072006d00410067006500 ,
        0x6e0074007300410041000000000000003096eee65d6eb64681e15dff331869bb ,
        0x00000000efe76380d4b1e440e7faffff05000000710072007900470072007000 ,
        0x410067007400000000000000e6f050c3c81235429572882d3592049b07000000 ,
        0x3096eee65d6eb64681e15dff331869bb470052004f0055005000690064000000 ,
        0x000000000cb4f98ddad2c8488386d320c35bb991060000007f0abb27250d9e49 ,
        0xaf1275412e7c1357660073007500620049006e00760047007200700041004100 ,
        0x000000000000000000000000000000000000000000000c000000030000000000 ,
        0x000000000000000000000000
    End
    RecordSource ="SELECT DISTINCTROW tblInvHdr.[CUST KEY], tblInvHdr.[CUST NAME], tblInvHdr.[ADDRE"
        "SS 1], tblInvHdr.[ADDRESS 2], tblInvHdr.[ADDRESS 3], tblInvHdr.CITY, tblInvHdr.S"
        "TATE, tblInvHdr.[ZIP CODE], tblInvHdr.COUNTRY, tblInvHdr.ATTENTION, tblInvHdr.[T"
        "RANS NO], tblInvHdr.[APPLY-TO], tblInvHdr.[SEL STATUS], tblInvHdr.[INV DATE], tb"
        "lInvHdr.[RECR CYCLE], tblInvHdr.BUYER, tblInvHdr.[CUST PO], tblInvHdr.[CHECK NO]"
        ", tblInvHdr.[CHECK AMTR], tblInvHdr.[COMM OVRD], tblInvHdr.[LOCATION  KEY], tblI"
        "nvHdr.[TERRITORY KEY], tblInvHdr.[SALESP    KEY], tblInvHdr.TERMS, tblInvHdr.FOB"
        ", tblInvHdr.[SHIP VIA], tblInvHdr.[COMMENT KEY], tblInvHdr.[CUST CLASS], tblInvH"
        "dr.FREIGHT, tblInvHdr.[DISCOUNT MULT], tblInvHdr.[CR MEMO FLAG], tblInvHdr.[INVO"
        "ICE NO], tblInvHdr.SPARE, tblInvHdr.SPARE2, tblInvHdr.SPARE3, tblInvHdr.INVOICET"
        "OTAL, tblInvHdr.SYSDOCID, tblInvHdr.RecUserID, tblInvHdr.RecDate, tblInvHdr.RecT"
        "ime, tblInvHdr.upsize_ts, tblInvHdr.DateModified FROM tblInvHdr WHERE (((tblInvH"
        "dr.SPARE3)=\"All American\")); "
    Caption ="Invoice Entry - All American"
    OnCurrent ="[Event Procedure]"
    MenuBar ="InvoiceAllAmerican"
    PrtMip = Begin
        0xd002000038040000d0020000d002000000000000a02900004029000001000000 ,
        0x010000006801000000000000a10700000100000000000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010402059c00f4040367000001000100ea0a6f086400010001002c0101000100 ,
        0x2c01020001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe220000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000000000c40200000000000000000000000000000000 ,
        0x00000000000000000300000000000000300210005c4b03006843040000000000 ,
        0x000000000000000000000000000000000000000000000000449f6be605000000 ,
        0x04000000ff00ff00010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x3002000045424441000001000100000001000000010000000100000000000000 ,
        0x5300740061006e00640061007200640000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000001000000
    End
    PrtDevNames = Begin
        0x08001c0026000100000000000000000000000000000000000000000000000000 ,
        0x0000000000004d7920446f63756d656e74735c2a2e70646600
    End
    OnLoad ="=LockBoundControls(screen.ActiveForm,True)"
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin Subform
            SpecialEffect =2
        End
        Begin FormHeader
            CanGrow = NotDefault
            Height =510
            BackColor =12632256
            Name ="FormHeader0"
            GUID = Begin
                0x2e24168548233345aa52fe03aef0d5a5
            End
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =255
                    Top =150
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label122"
                    Caption ="Input Date: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xb28ef49bab8e4c4e91ccef4c3fa8495d
                    End
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =1650
                    Top =150
                    Width =1020
                    Name ="INPUT_DATE"
                    Format ="m/d/yyyy"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="=DateSerial(Year(Date()),Month(Date())+1,1)"
                    InputMask ="99/99/0000;0;_"
                    GUID = Begin
                        0x123c90ad888f324f9ea70cb81d85e629
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =2790
                    Top =135
                    Width =4815
                    Height =255
                    Name ="Label126"
                    Caption ="Enter an invoice date and click File>Create Invoices"
                    GUID = Begin
                        0xc15b218dff0261438b3ab153e068c03e
                    End
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =4260
            BackColor =12632256
            Name ="Detail Section"
            EventProcPrefix ="Detail_Section"
            GUID = Begin
                0xc4416b236efeec42987f5eb06fad4239
            End
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =249
                    Top =606
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text5"
                    Caption ="Group Name: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x8ee96baf7aeaf14b88876ec2cda48608
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =95
                    TextAlign =3
                    Left =249
                    Top =846
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text6"
                    Caption =" Address: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x939b4d55f90fc34d9ca71c93861a42df
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =95
                    TextAlign =3
                    Left =249
                    Top =1086
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text7"
                    Caption ="Address 2: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xe23c54f66291f74082d6ae69aba5c393
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =95
                    TextAlign =3
                    Left =249
                    Top =1326
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text8"
                    Caption ="City: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x575a288ef3aeaa4094a49f9d4bf1f4ee
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =215
                    TextAlign =3
                    Left =849
                    Top =1536
                    Width =651
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text9"
                    Caption ="State: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x5db9654de0e10f41b514a557a9458e62
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =1974
                    Top =1551
                    Width =471
                    Height =225
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text10"
                    Caption ="Zip: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x5519c6816af534409aab6be86f71ae21
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =93
                    Left =1524
                    Top =591
                    Width =2466
                    TabIndex =2
                    BackColor =12632256
                    Name ="CUST NAME"
                    ControlSource ="CUST NAME"
                    EventProcPrefix ="CUST_NAME"
                    GUID = Begin
                        0xaffb7a1044749249bb111af08998f188
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =95
                    Left =1524
                    Top =831
                    Width =2463
                    TabIndex =3
                    BackColor =12632256
                    Name ="ADDRESS 1"
                    ControlSource ="ADDRESS 1"
                    EventProcPrefix ="ADDRESS_1"
                    GUID = Begin
                        0x3ed0544d9835b243b88ca2c3e573c03e
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =95
                    Left =1524
                    Top =1071
                    Width =2463
                    TabIndex =4
                    BackColor =12632256
                    Name ="ADDRESS 2"
                    ControlSource ="ADDRESS 2"
                    EventProcPrefix ="ADDRESS_2"
                    GUID = Begin
                        0x4a0d15074e28854494714376dd718057
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =95
                    Left =1524
                    Top =1311
                    Width =1728
                    TabIndex =5
                    BackColor =12632256
                    Name ="CITY"
                    ControlSource ="CITY"
                    GUID = Begin
                        0xa47a70dc643a704c81e83e0caabb30c1
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =95
                    Left =1524
                    Top =1551
                    Width =432
                    Height =225
                    TabIndex =6
                    BackColor =12632256
                    Name ="STATE"
                    ControlSource ="STATE"
                    GUID = Begin
                        0x76683aec34d28142aa040ae0d23f8673
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =95
                    Left =2439
                    Top =1566
                    Width =1008
                    Height =210
                    TabIndex =7
                    BackColor =12632256
                    Name ="ZIP CODE"
                    ControlSource ="ZIP CODE"
                    InputMask ="00000\\-9999;;_"
                    EventProcPrefix ="ZIP_CODE"
                    GUID = Begin
                        0x29392342b78166428ba2cac2c1d02f7e
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =219
                    Top =1806
                    Width =1281
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text65"
                    Caption ="Attn: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xb1244d8aa1027840b7a531e4b1c9177f
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =87
                    Left =1524
                    Top =1791
                    Width =2448
                    TabIndex =8
                    BackColor =12632256
                    Name ="ATTENTION"
                    ControlSource ="ATTENTION"
                    GUID = Begin
                        0x29fa983afbbcd7499a19c1ab665385d6
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =5070
                    Top =120
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text67"
                    Caption ="Invoice No: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x247fd0f6a415a64ca96d3429e5795861
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =6480
                    Top =105
                    Width =1020
                    TabIndex =9
                    BackColor =12632256
                    Name ="TRANS NO"
                    ControlSource ="TRANS NO"
                    EventProcPrefix ="TRANS_NO"
                    GUID = Begin
                        0xb164223eabf73c44a32d978ae19ee919
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =150
                    Top =60
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text69"
                    Caption ="Invoice Date: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xbf85aa7a06e6aa4aac4f3b1a087cc77e
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =87
                    TextAlign =1
                    Left =1515
                    Top =60
                    Width =1020
                    BackColor =12632256
                    Name ="INV DATE"
                    ControlSource ="INV DATE"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0000;0;_"
                    EventProcPrefix ="INV_DATE"
                    GUID = Begin
                        0x5688607467e7a4438d60cea64e760fa6
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =5070
                    Top =600
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text71"
                    Caption ="Comm Ovrd: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xf49b74348d95a944a85b016876b117d2
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =93
                    Left =6480
                    Top =585
                    Width =1020
                    TabIndex =10
                    BackColor =12632256
                    Name ="COMM OVRD"
                    ControlSource ="COMM OVRD"
                    EventProcPrefix ="COMM_OVRD"
                    GUID = Begin
                        0x4f149f4a5df1f44592e51d016e5f43f4
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =95
                    TextAlign =3
                    Left =5070
                    Top =840
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text73"
                    Caption ="Territory/GEO: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xe857eb8938f603488737c76d6492d9c8
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =95
                    Left =6480
                    Top =825
                    Width =1020
                    TabIndex =11
                    BackColor =12632256
                    Name ="TERRITORY KEY"
                    ControlSource ="TERRITORY KEY"
                    EventProcPrefix ="TERRITORY_KEY"
                    GUID = Begin
                        0x58a611cef2497440a1bc4936e438d3b7
                    End
                End
                Begin Subform
                    OverlapFlags =85
                    SpecialEffect =0
                    Left =1500
                    Top =2145
                    Width =6669
                    Height =1965
                    TabIndex =12
                    Name ="fsubInvGrpAA"
                    SourceObject ="Form.fsubInvGrpAA"
                    LinkChildFields ="CUST KEY"
                    LinkMasterFields ="CUST KEY"
                    GUID = Begin
                        0x0cb4f98ddad2c8488386d320c35bb991
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =240
                    Top =330
                    Width =1260
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text102"
                    Caption ="Group ID: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xa518c5cb799b8b428d6e46fa52f202cc
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    SpecialEffect =0
                    OverlapFlags =93
                    TextAlign =1
                    Left =7590
                    Top =1155
                    Width =1830
                    TabIndex =13
                    BackColor =12632256
                    Name ="AGENT1 NAME"
                    ControlSource ="=DLookUp(\"[AGENT_LUname]\",\"tblAgent\",\"[AGENTid] = Forms![frmInvGrpAA_Ins]!["
                        "SALESP    KEY]\")"
                    EventProcPrefix ="AGENT1_NAME"
                    GUID = Begin
                        0x3a39102ecd728c49996b3f511fbb22c2
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    SpecialEffect =0
                    OverlapFlags =95
                    TextAlign =1
                    Left =7590
                    Top =1395
                    Width =1830
                    TabIndex =14
                    BackColor =12632256
                    Name ="AGENT2 NAME"
                    ControlSource ="=DLookUp(\"[AGENT_LUname]\",\"tblAgent\",\"[AGENTid] = Forms![frmInvGrpAA_Ins]!["
                        "SPARE3]\")"
                    EventProcPrefix ="AGENT2_NAME"
                    GUID = Begin
                        0x6f41586d3a255d4f903a40a58f1f2661
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    SpecialEffect =0
                    OverlapFlags =93
                    TextAlign =1
                    Left =7515
                    Top =825
                    Width =2685
                    TabIndex =15
                    BackColor =12632256
                    Name ="TERRITORY NAME"
                    ControlSource ="=DLookUp(\"[GEODESC]\",\"tblGeographical\",\"[GEOid] = Forms![frmInvGrpAA_ins]!["
                        "TERRITORY KEY]\")"
                    EventProcPrefix ="TERRITORY_NAME"
                    GUID = Begin
                        0xbf58b12b8632a9419a2bf828fabae271
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =4020
                    Top =105
                    Width =288
                    Height =288
                    FontSize =8
                    TabIndex =16
                    Name ="Bulk_Invoices"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x3d73a7ec1a96ea4c9620800824a67def
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =7575
                    Top =105
                    Width =1020
                    Height =216
                    TabIndex =17
                    BackColor =65535
                    Name ="txtSYSDOCID"
                    ControlSource ="SYSDOCID"
                    GUID = Begin
                        0xe67d6ccb5871e149b3f2f5628158ed4a
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =93
                    Left =7575
                    Top =390
                    Width =1020
                    Height =216
                    TabIndex =18
                    BackColor =65535
                    Name ="txtRecUserID"
                    ControlSource ="RecUserID"
                    GUID = Begin
                        0xc2193c615460c34a8923c3fa65319967
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8730
                    Top =105
                    Width =1020
                    Height =216
                    TabIndex =19
                    BackColor =65535
                    Name ="txtRecTime"
                    ControlSource ="RecTime"
                    Format ="Long Time"
                    GUID = Begin
                        0x7832a807dcf2ce499883627ce0db0449
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8730
                    Top =390
                    Width =1020
                    Height =216
                    TabIndex =20
                    BackColor =65535
                    Name ="txtRecDate"
                    ControlSource ="RecDate"
                    Format ="Short Date"
                    GUID = Begin
                        0x60f0d88375421244b5c46c2dab48ce2a
                    End
                End
                Begin Subform
                    Locked = NotDefault
                    OverlapFlags =247
                    Left =5085
                    Top =1080
                    Width =4710
                    Height =795
                    TabIndex =21
                    Name ="sfrmAgentsAA"
                    SourceObject ="Form.sfrmAgentsAA"
                    LinkChildFields ="GROUPid"
                    LinkMasterFields ="CUST KEY"
                    GUID = Begin
                        0xfc02807711b06e4e8353cf9d9a914fe7
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =87
                    Left =7590
                    Top =615
                    Width =1020
                    Height =216
                    TabIndex =22
                    BackColor =65535
                    Name ="CUST CLASS"
                    ControlSource ="CUST CLASS"
                    EventProcPrefix ="CUST_CLASS"
                    GUID = Begin
                        0xc3252b573d078841bcc3bd3faeec1c50
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =87
                    Left =1524
                    Top =336
                    Width =1008
                    TabIndex =1
                    BackColor =12632256
                    Name ="CUST KEY"
                    ControlSource ="CUST KEY"
                    AfterUpdate ="[Event Procedure]"
                    EventProcPrefix ="CUST_KEY"
                    GUID = Begin
                        0xb463f9386dab754282f4ddcc050fc8ee
                    End
                End
            End
        End
        Begin FormFooter
            Height =720
            BackColor =12632256
            Name ="FormFooter1"
            GUID = Begin
                0x8f9bd052867a70439d8c6075ef91c21f
            End
            Begin
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =93
                    Left =6540
                    Top =90
                    Width =1332
                    Name ="INVOICE TOTAL"
                    ControlSource ="=fsubInvGrpAA.Form!SubTotal"
                    Format ="$#,##0.00;($#,##0.00)"
                    EventProcPrefix ="INVOICE_TOTAL"
                    GUID = Begin
                        0x2ded9089a1fff449959e719e206e43f4
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =87
                    TextAlign =3
                    Left =5190
                    Top =90
                    Width =1335
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text92"
                    Caption ="Invoice Total: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xc3fb4772f91f2f4081455e7b516164ba
                    End
                End
                Begin Line
                    LineSlant = NotDefault
                    BorderWidth =1
                    OverlapFlags =85
                    Left =5220
                    Top =360
                    Width =2640
                    Height =15
                    Name ="Line97"
                    GUID = Begin
                        0x86f574d37c16ef48b57496ea898d2650
                    End
                End
                Begin Line
                    LineSlant = NotDefault
                    BorderWidth =1
                    OverlapFlags =85
                    Left =5220
                    Top =390
                    Width =2640
                    Height =15
                    Name ="Line98"
                    GUID = Begin
                        0xf03d343ae55605448913e5462f350a4a
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3600
                    Top =105
                    Width =288
                    Height =288
                    FontSize =8
                    TabIndex =1
                    Name ="btnPostAlltoPlat"
                    Caption ="\015\012 Invs to QB"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xbbb05d6ab2e29d498efe112f01bc6ff4
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit

'Declare module level global variables
Dim mstrCustKey As String
Dim mstrTranNo As String
Dim mlngSysDocId As Long
Dim mdteInvoiceDate As Date
Function Export_Invoice_Data(dteInvoiceDate As Date) As Integer

    Dim strSQL As String
    strSQL = "usp_AllAmericanInvoice_csv"
    If g_adoConnection.STATE = adStateOpen Then g_adoConnection.Close
    With g_adoConnection
         .ConnectionString = SetConnxn
         .Open
    End With
    With g_adoCommand
          .ActiveConnection = g_adoConnection
          .CommandType = adCmdStoredProc
          .CommandText = strSQL
          Set g_adoParm = .CreateParameter("@ReturnParm", adInteger, adParamReturnValue) 'Return parm
          .Parameters.Append g_adoParm
          Set g_adoParm = .CreateParameter("@InvoiceDate", adDate, adParamInput)
          .Parameters.Append g_adoParm
          .Parameters("@InvoiceDate").Value = dteInvoiceDate
          .Execute
          g_iRtnVal = .Parameters.Item("@ReturnParm")
    End With
    
    g_adoConnection.Close
  
    Set g_adoCommand = Nothing
    Set g_adoConnection = Nothing
    Set g_adoParm = Nothing
    
    Export_Invoice_Data = g_iRtnVal
  
End Function
' post All American Invoices to QuickBooks
Public Sub btnPostAlltoPlat_Click()
'Purpose:  Posts All American groups to QuickBooks
'Programmer:  Tim Cook
'Date Created:  1/31/02
'Updated by:  John Criswell
'Date Updated:  3/19/02
'Updated by:  John Criswell
'Date Updated:  9/14/2014
'Reason:  changed processing code to stored procedures

'Updated by:  John Criswell
'Date Updated:  11/08/2015
'Reason:  added stored procedure to create csv file for QuickBooks
  On Error GoTo PROC_ERR
  
    Dim dteInvoiceDate As Date
    Dim strGroupType As String
    Dim strInput As String
    
    strGroupType = "All American"
    strInput = InputBox("Enter an invoice date.")
     
    Do While Not IsDate(strInput)
         strInput = InputBox("The date you entered is not a valid date." & vbCrLf & "Please re-enter a valid invoice date")
    Loop
    
    dteInvoiceDate = CDate(strInput)
    
    '  check for duplicate PltCustKeys
    If DupPltCustKeys() Then
        MsgBox "There are duplicate PltCustKeys.  The process will fail unless the duplicates are fixed."
        GoTo PROC_EXIT
    End If
    
   'check to see if any invoices being posted were posted before
    If AreAnyInvoicesInPlat(dteInvoiceDate, strGroupType) Then
       MsgBox "One or more of the invoices you are trying to post already exist in the QB transaction table.  Please remove these transactions and start over."
       GoTo PROC_EXIT
    Else
      'Nothing
    End If
     
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
       
   ' process invoices in pre condition
   ' and insert them into ARTRANH_local (post)
   ExecuteSQL "usp_InvoicePostGroup" & "' " & dteInvoiceDate & "', " & "'" & strGroupType & "'"
   
   'Check ARTRANH_local
   'to insure data was transferred correctly
    If DidAllInvoicesPosttoPlat() Then
        MsgBox "All invoices posted to QuickBooks holding table."
    Else
        MsgBox "At least one invoice did not post to QuickBooks holding table."
        GoTo PROC_EXIT
    End If
    
    ' create csv file for importing into QuickBooks
    If Export_Invoice_Data(dteInvoiceDate) = 1 Then
        MsgBox "invoice data export succeeded."
    Else
        MsgBox "invoice data export failed."
    End If
       
    'remove data from form
    DoCmd.OpenQuery "qdelDelInvHdr_all"
    Forms![frmInvGrpAA_Ins].Requery
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
    Exit Sub
       
PROC_EXIT:
  DoCmd.SetWarnings True
  DoCmd.Hourglass False
  Exit Sub

PROC_ERR:
  
  MsgBox "There was an error processing All American invoices." & vbCrLf & _
    vbCrLf & "The error number is: " & Err.Number & " and the system Error message is: " & Err.DESCRIPTION, vbCritical, "Export Error"
  
  Resume PROC_EXIT:
  
End Sub
Public Sub Bulk_Invoices_Click()
  
  On Error GoTo PROC_ERR
   
    Dim strGroupType As String
    Dim dteInvoiceDate As Date
    Dim strUserName As String
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    If IsNull(Me.INPUT_DATE) Or Me.INPUT_DATE = "" Then
        MsgBox "Input date required."
        Me.INPUT_DATE.SetFocus
    Else
        dteInvoiceDate = Me.INPUT_DATE
        
        ' save the date entered in INPUT_DATE
        Call SaveInvoiceDate(dteInvoiceDate)
        
        strGroupType = "All American"
        strUserName = GetCurrentUserName()
        ExecuteSQL "usp_InvoicePreGroup '" & dteInvoiceDate & "', " & "'" & strGroupType & "', " & "'" & strUserName & "'"
    End If
    
    Forms![frmInvGrpAA_Ins].Requery
    Me.Refresh
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
  
  Exit Sub

PROC_EXIT:
  DoCmd.SetWarnings True
  DoCmd.Hourglass False
  Exit Sub
    
PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub



Private Sub CUST_KEY_AfterUpdate()
'Purpose:  gets information for the form based on the customer key,
'          and appends data to tblInvHdr
'Programmer:  Suzanne Johnsen
'Date Created:  9/21/99
'Date Updated:  5/21/2005
'Updated by:  John Criswell

  On Error GoTo Err_CUST_KEY_AfterUpdate
  
    'Check to see if this is an existing record
    'or a new one.  It is an existing record
    'if the tran no control has a value in it.
    If Not IsNull(Me![TRANS NO]) Then
        MsgBox ("This is not a new record")
        Exit Sub
    End If

    Dim db As DAO.Database
    Dim rs As DAO.Recordset
    Dim strWhere As String
    Dim strCriterion As String
    Dim strTranNo As String
    Dim lngSysDocId As Long
    Dim varInvoiceDate As Variant
    Dim varRecTime As Variant
    Dim varRecDate As Variant
    Dim strRecUserID As String
    Dim strSQL As String
    
    DoCmd.Hourglass True
    
    Set db = CurrentDb()
    
    'get the invoice date from tblConstants
    Set rs = db.OpenRecordset("tblConstants", dbOpenSnapshot)
    varInvoiceDate = rs("FieldDateValue")
    rs.Close
    
    'Get the next Platinum tran no from ARONE_R9
    strTranNo = GetCurrentTranNo()
    If strTranNo = "0" Then
        GoTo Exit_CUST_KEY_AfterUpdate
    Else
        Forms![frmInvGrpAA_Ins]![TRANS NO] = Mid(Year(varInvoiceDate), 4, 1) & Format(strTranNo, "000000")
    End If
    
    ' Get the next SysDocID from ARNEXTSY
    lngSysDocId = GetCurrentSysDocID()
       
    Forms![frmInvGrpAA_Ins]![SYSDOCID] = lngSysDocId
    Forms![frmInvGrpAA_Ins]![RecUserID] = "INVOICE"
    Forms![frmInvGrpAA_Ins]![RecDate] = date
    Forms![frmInvGrpAA_Ins]![RecTime] = Time()
        
    strCriterion = Forms![frmInvGrpAA_Ins]![CUST KEY]
    
    strSQL = "SELECT tblGrp.*, tblGrpAgt.AGENTid, tblGrpAgt.Primary, tblGrpAgt.AgentRATE, tblGrpAgt.CommOwed, tblAgent.AGENT_LUname, tblAgent.AGENTfirst, tblAgent.AGENTlast, tblAgent.AGENTtype " & _
             "FROM tblAgent INNER JOIN (tblGrp INNER JOIN tblGrpAgt ON tblGrp.GroupID = tblGrpAgt.GroupID) ON tblAgent.AGENTid = tblGrpAgt.AGENTid " & _
             "WHERE (((tblGrp.GroupID)='" & strCriterion & "'));"
    
    Set rs = db.OpenRecordset(strSQL, dbOpenDynaset, dbSeeChanges)
    With Forms![frmInvGrpAA_Ins]
        [CUST NAME] = rs("GRname")
        [ADDRESS 1] = rs("GRstreet1")
        [ADDRESS 2] = rs("GRstreet2")
        [CITY] = rs("GRcity")
        [STATE] = rs("GRstate")
        [ZIP CODE] = rs("GRzip")
        [ATTENTION] = rs("GRmainCONT")
        [TERRITORY KEY] = rs("GRGeoID")
        [CUST CLASS] = rs("GRclassKEY")
        [INV DATE] = varInvoiceDate
    End With
    rs.Close
    db.Close
    Set db = Nothing
    
    Me.Dirty = False
    DoCmd.Hourglass False

Exit Sub

Exit_CUST_KEY_AfterUpdate:
    DoCmd.Hourglass False
    Exit Sub

Err_CUST_KEY_AfterUpdate:
  MsgBox "The following error occured: " & Error$
  GoTo Exit_CUST_KEY_AfterUpdate
End Sub
Function GetInvoiceDate()

    Dim strSQL As String
    strSQL = " SELECT FieldDateValue FROM dbo.tblConstants WHERE FieldName = 'InvoiceDate';"
    LoadADORecordset (strSQL)
    
    If Len(g_adoRS("FieldDateValue")) > 0 Then
        GetInvoiceDate = g_adoRS("FieldDateValue")
    Else
        GetInvoiceDate = DateSerial(Year(date), Month(date) + 1, 1)
    g_adoRS.Close
    End If

End Function
Private Sub Form_Current()
    
    On Error GoTo PROC_ERR
    
    With Forms![frmInvGrpAA_Ins]
        INPUT_DATE = GetInvoiceDate()
    End With
    
PROC_EXIT:
  DoCmd.SetWarnings True
  DoCmd.Hourglass False
  Exit Sub
    
PROC_ERR:
  MsgBox "Error: (" & Err.Number & ") " & Err.DESCRIPTION, vbCritical, " Function: frmInvGrpAA_Ins.Form_Current "
  Resume PROC_EXIT
    
End Sub

Private Sub INPUT_DATE_AfterUpdate()
    
   On Error GoTo PROC_ERR
    
    Dim dteInputDate As Date
    dteInputDate = Me.INPUT_DATE
    ' save the date
    
PROC_EXIT:
  DoCmd.SetWarnings True
  DoCmd.Hourglass False
  Exit Sub
    
PROC_ERR:
  MsgBox "Error: (" & Err.Number & ") " & Err.DESCRIPTION, vbCritical, " Function: frmInvGrpAA_Ins.INPUT_DATE_AfterUpdate "
  Resume PROC_EXIT
    
End Sub