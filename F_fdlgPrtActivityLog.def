Version =20
VersionRequired =20
Checksum =-1201373609
Begin Form
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    GridX =24
    GridY =24
    Width =4800
    ItemSuffix =42
    Left =2055
    Top =2115
    Right =6855
    Bottom =4665
    RecSrcDt = Begin
        0x2223dcb3b2c4e140
    End
    Caption ="Print Group Activity Log Report"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010402059c00f40453ef800101000100ea0a6f08640001000f00b00402000100 ,
        0xb004030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe220000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000000000c40200000000000000000000000000000000 ,
        0x00000000000000000300000000000000300210005c4b03006843040000000000 ,
        0x000000000000000000000000000000000000000000000000449f6be605000000 ,
        0x04000000ff00ff00010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x3002000045424441000001000100000001000000010000000100000000000000 ,
        0x5300740061006e00640061007200640000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000001000000
    End
    PrtDevNames = Begin
        0x08001c0026000100000000000000000000000000000000000000000000000000 ,
        0x0000000000004d7920446f63756d656e74735c2a2e70646600
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin FormHeader
            Height =0
            BackColor =12632256
            Name ="FormHeader"
        End
        Begin Section
            Height =1980
            BackColor =12632256
            Name ="Detail0"
            Begin
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =240
                    Top =240
                    Width =2565
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text67"
                    Caption ="Appt/Call Date From: "
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =87
                    Left =2820
                    Top =240
                    Width =1005
                    Name ="ctlLogDate1"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0000;0;_"
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =87
                    Left =2820
                    Top =597
                    Width =1005
                    TabIndex =1
                    Name ="ctlLogDate2"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0000;0;_"
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =93
                            TextAlign =3
                            Left =240
                            Top =573
                            Width =2565
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="Text7"
                            Caption ="Appt/Call Date To:"
                        End
                    End
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =240
                    Top =936
                    Width =2565
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label24"
                    Caption ="Call Back Date From: "
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =87
                    Left =2820
                    Top =954
                    Width =1005
                    TabIndex =2
                    Name ="ctlCallBck1"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0099;0;_"
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =87
                    Left =2820
                    Top =1311
                    Width =1005
                    TabIndex =3
                    Name ="ctlCallBck2"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0099;0;_"
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =93
                            TextAlign =3
                            Left =240
                            Top =1269
                            Width =2565
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="Label27"
                            Caption ="Call Back Date to:"
                        End
                    End
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =240
                    Top =1632
                    Width =2565
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label28"
                    Caption ="Account Manager: "
                End
                Begin ComboBox
                    Visible = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    ColumnCount =2
                    ListWidth =2760
                    Left =2820
                    Top =1632
                    Width =1857
                    TabIndex =4
                    Name ="ctlQCDrep1"
                    RowSourceType ="Value List"
                    ColumnWidths ="0;1860"
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =3969
                    Top =375
                    Width =570
                    Height =225
                    TabIndex =5
                    BackColor =8454143
                    Name ="ctlTitleLog"
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =3969
                    Top =720
                    Width =570
                    Height =225
                    TabIndex =6
                    BackColor =8454143
                    Name ="ctlTitleRep"
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =3969
                    Top =1065
                    Width =570
                    Height =225
                    TabIndex =7
                    BackColor =8454143
                    Name ="ctlTitleCallBck"
                End
            End
        End
        Begin FormFooter
            Height =600
            BackColor =12632256
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =82
                    Left =3960
                    Top =60
                    Width =717
                    Height =478
                    Name ="PreviewButton"
                    Caption ="Print Preview&R"
                    StatusBarText ="Preview Report"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000017000000160000000100040000000000080100000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888889888888888888888888888884 ,
                        0x88888888888888888888888388888888888888888888888e8888000000000000 ,
                        0x8800888288880ffffffffff08000888d88880fffffff00007008888888880fff ,
                        0xfff078870788888588880fffff0788f77088888288880fffff08888780888884 ,
                        0x88880fffff08f8878088888888880fffff07ff877088888088880ffffff07887 ,
                        0x0888888088880fffffff00008888888088880ffffffffff08888888088880fff ,
                        0xffff00008888888088880fffffff08088888888188880fffffff008888888886 ,
                        0x8888000000000888888888808888888888888888888888808888888888888888 ,
                        0x8888888088888888888888888888888000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit


Private Sub Form_Load()
   Dim datFilter As Date
   Dim strSQL As String
   Dim rst As DAO.Recordset
   Dim dbs As DAO.Database
   Dim strYear As String
   Dim strMonth As String
   Dim strList As String
   Dim strGEOlist As String
   
'    Set dbs = CurrentDb()
'
'    strSQL = "SELECT DISTINCTROW tblAcctMgr.AcctMgrID, tblAcctMgr.AcctMgrName"
'    strSQL = strSQL & " FROM tblAcctMgr"
'    strSQL = strSQL & " ORDER BY tblAcctMgr.AcctMgrID;"
'    Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
'    strList = "All, All Account Managers;"
'    If rst.RecordCount > 0 Then
'      With rst
'       Do While Not rst.EOF
'        strList = strList & !AcctMgrID & "," & !AcctMgrName & ";"
'        Me.ctlQCDrep1.RowSource = strList
'        .MoveNext
'       Loop
'      End With
'    End If
'
'    rst.Close
'    Set dbs = Nothing
End Sub

Private Sub PreviewButton_Click()
 On Error GoTo PROC_ERR
 
    Me.Visible = False
    
    Dim strDocName As String
    Dim strWhere As String
    Dim StrLogDate1 As String
    Dim StrLogDate2 As String
    Dim strCallBck1 As String
    Dim strCallBck2 As String
    Dim strQCDrep1 As String
    Dim strQCDrep2 As String
    Dim strTitleLog As String
    Dim strTitleCallBck As String
    Dim strTitleRep As String
    Dim fCriteria As Boolean
    Dim strSubRptPhone As String
    Dim strSubRptAppt As String
    Dim strName As String
    Dim strQry
    strQry = "qrptActivityLog"
    
    ''Check to see if there is any criteria for Log Dates
    If Not IsNull(Me![ctlLogDate1]) And Not IsNull(Me![ctlLogDate2]) Then
        StrLogDate1 = Me![ctlLogDate1]
        StrLogDate2 = Me![ctlLogDate2]
        strWhere = strWhere & "[LogDateCallVisit] BETWEEN #" & Me![ctlLogDate1] & "# AND #" & Me![ctlLogDate2] & "#"
        strTitleLog = "Appt/Call Date Between " & Me![ctlLogDate1] & " and " & Me![ctlLogDate2] & ""
        fCriteria = True
    End If
    
      If Not IsNull(Me![ctlLogDate1]) And IsNull(Me![ctlLogDate2]) Then
        StrLogDate1 = Me![ctlLogDate1]
        strWhere = strWhere & " AND ([LogDateCallVisit]=" & "#" & Me![ctlLogDate1] & "#)"
        strTitleLog = "Appt/Call Date " & "" & Me![ctlLogDate1] & ")"
        fCriteria = True
       End If
    
    If Not IsNull(Me![ctlLogDate2]) And IsNull(Me![ctlLogDate1]) Then
        StrLogDate1 = Me![ctlLogDate2]
        strWhere = strWhere & " AND ([LogDateCallVisit]=" & "#" & Me![ctlLogDate2] & "#)"
        strTitleLog = "App/Call Date " & "" & Me![ctlLogDate2] & ")"
        fCriteria = True
    End If
    Me![ctlTitleLog] = strTitleLog
    
    '' Check to see if there is any criteria for Call Back Dates
    If Not IsNull(Me![ctlCallBck1]) And Not IsNull(Me![ctlCallBck2]) Then
        strCallBck1 = Me![ctlCallBck1]
        strCallBck2 = Me![ctlCallBck2]
        strWhere = strWhere & " AND ([LogCallBack] BETWEEN #" & Me![ctlCallBck1] & "# AND #" & Me![ctlCallBck2] & "#)"
        strTitleCallBck = "Call Back Date Between " & Me![ctlCallBck1] & " and " & Me![ctlCallBck2] & ""
        Me![ctlTitleCallBck] = strTitleCallBck
        fCriteria = True
    End If
    
    If Not IsNull(Me![ctlCallBck1]) And IsNull(Me![ctlCallBck2]) Then
        strCallBck1 = Me![ctlLogDate1]
        strWhere = strWhere & " AND ([LogCallBack]=" & "#" & Me![ctlCallBck1] & "#)"
        strTitleCallBck = "Call Back Date " & "" & Me![ctlCallBck1] & ""
        Me![ctlTitleCallBck] = strTitleCallBck
        fCriteria = True
    End If
    
    If Not IsNull(Me![ctlCallBck2]) And IsNull(Me![ctlCallBck1]) Then
        strCallBck2 = Me![ctlCallBck2]
        strWhere = strWhere & " AND ([LogCallBack]=" & "#" & Me![ctlCallBck1] & "#)"
        strTitleCallBck = " AND Call Back Date " & "" & Me![ctlCallBck1] & ""
        Me![ctlTitleCallBck] = strTitleCallBck
        fCriteria = True
    End If
    
    ''Check to see if there is any criteria for QCD Representatives
    If Not IsNull(Me![ctlQCDrep1]) Then
       If Me![ctlQCDrep1] = "All" Then
       ' Don't add anything
       strTitleRep = "All QCD Acct Mgrs "
       Me!ctlTitleRep = strTitleRep
         If fCriteria = True Then
            fCriteria = True
         Else
            fCriteria = False
         End If
       Else
        ' Process the selected Rep
        strQCDrep1 = Me![ctlQCDrep1]
        strWhere = strWhere & " AND ([LogAcctMgrID]= " & Me![ctlQCDrep1] & ")"
        strTitleRep = " QCD Acct Mgr " & Me![ctlQCDrep1] & ""
        Me!ctlTitleRep = strTitleRep
        fCriteria = True
       End If
    Else
      ' If null defaults to all
      strTitleRep = "All QCD Acct Mgrs "
      Me!ctlTitleRep = strTitleRep
      If fCriteria = True Then
         fCriteria = True
      Else
         fCriteria = False
      End If
    End If
    
    If fCriteria = True Then
   
   If Left(strWhere, 5) <> " AND " Then
        strWhere = " AND " & strWhere
   End If
    
   strSubRptPhone = "SELECT tblGrpLog.LogGrID, tblGrp.GRname, tblGrpLog.LogNotes, tblGrpLog.LogDate, "
   strSubRptPhone = strSubRptPhone & " tblGrpLog.LogTime, tblGrpLog.LogCallBack, tblGrpLog.LogAcctMgrID,"
   strSubRptPhone = strSubRptPhone & " tblGrpLog.LogPurpose, tblGrpLog.LogOutcome, tblGrpLog.LogFollowupAction,"
   strSubRptPhone = strSubRptPhone & " tblGrpLog.LogSize, tblGrpLog.LogDateCallVisit, tblGrpLog.LogPhoneLog, "
   strSubRptPhone = strSubRptPhone & " tblGrp.GRcancelled, tblGrpLog.LogApptCallTime, tblAcctMgr.AcctMgrName"
   strSubRptPhone = strSubRptPhone & " FROM (tblGrp LEFT JOIN tblGrpLog ON (tblGrp.GroupID = tblGrpLog.LogGrID) "
   strSubRptPhone = strSubRptPhone & " AND (tblGrp.GroupID = tblGrpLog.LogGrID)) LEFT JOIN tblAcctMgr"
   strSubRptPhone = strSubRptPhone & " ON tblGrpLog.LogAcctMgrID = tblAcctMgr.AcctMgrID"
   strSubRptPhone = strSubRptPhone & " WHERE (((tblGrpLog.LogPhoneLog)=Yes) "
   strSubRptPhone = strSubRptPhone & strWhere & ");"

   strSubRptAppt = "SELECT tblGrpLog.LogGrID, tblGrp.GRname, tblGrpLog.LogNotes, tblGrpLog.LogDate, "
   strSubRptAppt = strSubRptAppt & " tblGrpLog.LogTime, tblGrpLog.LogCallBack, tblGrpLog.LogAcctMgrID,"
   strSubRptAppt = strSubRptAppt & " tblGrpLog.LogPurpose, tblGrpLog.LogOutcome, tblGrpLog.LogFollowupAction,"
   strSubRptAppt = strSubRptAppt & " tblGrpLog.LogSize, tblGrpLog.LogDateCallVisit, tblGrpLog.LogPhoneLog, "
   strSubRptAppt = strSubRptAppt & " tblGrp.GRcancelled, tblGrpLog.LogApptCallTime, tblAcctMgr.AcctMgrName"
   strSubRptAppt = strSubRptAppt & " FROM (tblGrp LEFT JOIN tblGrpLog ON (tblGrp.GroupID = tblGrpLog.LogGrID) "
   strSubRptAppt = strSubRptAppt & " AND (tblGrp.GroupID = tblGrpLog.LogGrID)) LEFT JOIN tblAcctMgr"
   strSubRptAppt = strSubRptAppt & " ON tblGrpLog.LogAcctMgrID = tblAcctMgr.AcctMgrID"
   strSubRptAppt = strSubRptAppt & " WHERE (((tblGrpLog.LogPhoneLog)=No) "
   strSubRptAppt = strSubRptAppt & strWhere & ");"
   
   ' Set the sub reports record source here
   DoCmd.Echo False
      strName = "rsubGrpActivity_Phone"
      DoCmd.OpenReport strName, acViewDesign
      With Reports(strName)
          .RecordSource = strSubRptPhone
          .FilterOn = True
      End With
      DoCmd.Close acReport, strName, acSaveYes
      strName = "rsubGrpActivity_Appt"
      DoCmd.OpenReport strName, acViewDesign
      With Reports(strName)
          .RecordSource = strSubRptAppt
          .FilterOn = True
      End With
      DoCmd.Close acReport, strName, acSaveYes
   DoCmd.Echo True
   '' Strip off preceding " AND"
    If Left(strWhere, 5) = " AND " Then
        strWhere = Right(strWhere, Len(strWhere) - 5)
    End If
    
      '' Check to see if there are any records before printing report
      If DCount("*", strQry, strWhere) = 0 Then
          MsgBox "No records were found for this criteria." & vbCrLf & vbCrLf & "Please select new criteria!", vbInformation, "Please Try Again!"
          Forms![fdlgPrtActivityLog].Visible = True
          Exit Sub
      End If
      ' Open with filter
      DoCmd.OpenReport "rptGrpActivity_New", acViewPreview, , strWhere
    Else
         strSubRptPhone = "SELECT tblGrpLog.LogGrID, tblGrp.GRname, tblGrpLog.LogNotes, tblGrpLog.LogDate, "
         strSubRptPhone = strSubRptPhone & " tblGrpLog.LogTime, tblGrpLog.LogCallBack, tblGrpLog.LogAcctMgrID,"
         strSubRptPhone = strSubRptPhone & " tblGrpLog.LogPurpose, tblGrpLog.LogOutcome, tblGrpLog.LogFollowupAction,"
         strSubRptPhone = strSubRptPhone & " tblGrpLog.LogSize, tblGrpLog.LogDateCallVisit, tblGrpLog.LogPhoneLog, "
         strSubRptPhone = strSubRptPhone & " tblGrp.GRcancelled, tblGrpLog.LogApptCallTime, tblAcctMgr.AcctMgrName"
         strSubRptPhone = strSubRptPhone & " FROM (tblGrp LEFT JOIN tblGrpLog ON (tblGrp.GroupID = tblGrpLog.LogGrID) "
         strSubRptPhone = strSubRptPhone & " AND (tblGrp.GroupID = tblGrpLog.LogGrID)) LEFT JOIN tblAcctMgr"
         strSubRptPhone = strSubRptPhone & " ON tblGrpLog.LogAcctMgrID = tblAcctMgr.AcctMgrID"
         strSubRptPhone = strSubRptPhone & " WHERE (((tblGrpLog.LogPhoneLog)=Yes) "
         strSubRptPhone = strSubRptPhone & " AND ((tblGrp.GRcancelled)=No));"
         
         strSubRptAppt = "SELECT tblGrpLog.LogGrID, tblGrp.GRname, tblGrpLog.LogNotes, tblGrpLog.LogDate, "
         strSubRptAppt = strSubRptAppt & " tblGrpLog.LogTime, tblGrpLog.LogCallBack, tblGrpLog.LogAcctMgrID,"
         strSubRptAppt = strSubRptAppt & " tblGrpLog.LogPurpose, tblGrpLog.LogOutcome, tblGrpLog.LogFollowupAction,"
         strSubRptAppt = strSubRptAppt & " tblGrpLog.LogSize, tblGrpLog.LogDateCallVisit, tblGrpLog.LogPhoneLog, "
         strSubRptAppt = strSubRptAppt & " tblGrp.GRcancelled, tblGrpLog.LogApptCallTime, tblAcctMgr.AcctMgrName"
         strSubRptAppt = strSubRptAppt & " FROM (tblGrp LEFT JOIN tblGrpLog ON (tblGrp.GroupID = tblGrpLog.LogGrID) "
         strSubRptAppt = strSubRptAppt & " AND (tblGrp.GroupID = tblGrpLog.LogGrID)) LEFT JOIN tblAcctMgr"
         strSubRptAppt = strSubRptAppt & " ON tblGrpLog.LogAcctMgrID = tblAcctMgr.AcctMgrID"
         strSubRptAppt = strSubRptAppt & " WHERE (((tblGrpLog.LogPhoneLog)=No) "
         strSubRptAppt = strSubRptAppt & " AND ((tblGrp.GRcancelled)=No));"
         
         ' Set the sub reports record source here
         DoCmd.Echo False
         strName = "rsubGrpActivity_Phone"
         DoCmd.OpenReport strName, acViewDesign
         With Reports(strName)
             .RecordSource = strSubRptPhone
             .FilterOn = True
         End With
         DoCmd.Close acReport, strName, acSaveYes
         strName = "rsubGrpActivity_Appt"
         DoCmd.OpenReport strName, acViewDesign
         With Reports(strName)
             .RecordSource = strSubRptAppt
             .FilterOn = True
         End With
         DoCmd.Close acReport, strName, acSaveYes
         DoCmd.Echo True
      ' Open with no filter
      DoCmd.OpenReport "rptGrpActivity_New", acViewPreview
    End If
   
Exit Sub
    
PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub