Version =20
VersionRequired =20
Checksum =-340775760
Begin Form
    AllowFilters = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    AllowAdditions = NotDefault
    AllowEdits = NotDefault
    DefaultView =0
    ScrollBars =0
    RecordLocks =2
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =9360
    DatasheetFontHeight =10
    ItemSuffix =24
    Left =5385
    Top =960
    Right =14490
    Bottom =5460
    DatasheetGridlinesColor =12632256
    Filter ="[ItemNumber] = 0 AND [Argument] = 'Default' "
    RecSrcDt = Begin
        0xc3324a1fd3c6e140
    End
    GUID = Begin
        0x23955b96630caa4096e2e4ecbbed6b09
    End
    NameMap = Begin
        0x0acc0e5500000000c6a27bd840405d468c43b2783375400f00000000827c457e ,
        0x60b1e440000000000000000053007700690074006300680062006f0061007200 ,
        0x640020004900740065006d007300000000000000000000000000000000000000 ,
        0x000000000c000000030000000000000000000000000000000000
    End
    RecordSource ="Switchboard Items"
    Caption ="Switchboard"
    OnCurrent ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    MenuBar ="MainMenuMenuBar"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00fc0253ef800101000100ea0a6f08640001000f00b00402000100 ,
        0xb004030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200c000fc020000ac13d8c00000000000000000000000000000000000000000 ,
        0x0000000000000000050000000000070000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000c0000000534d544a ,
        0x000000001000b000530065006e006400200074006f0020004d00690063007200 ,
        0x6f0073006f006600740020004f006e0065004e006f0074006500200031003500 ,
        0x20004400720069007600650072000000524553444c4c00556e69726573444c4c ,
        0x00506170657253697a65004c4554544552004f7269656e746174696f6e00504f ,
        0x525452414954005265736f6c7574696f6e0044504936303000436f6c6f724d6f ,
        0x646500323462707000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08002c0041000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x006e756c3a00
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin Section
            Height =4770
            BackColor =-2147483633
            Name ="Detail"
            GUID = Begin
                0xf120a0947a6a814890026b9405a32ebd
            End
            Begin
                Begin Rectangle
                    SpecialEffect =0
                    BackStyle =1
                    OldBorderStyle =0
                    OverlapFlags =93
                    Left =2355
                    Width =378
                    Height =4770
                    BackColor =8421504
                    Name ="VerticalShadowBox"
                    GUID = Begin
                        0x097868cebfe2a04cb44b61855e691295
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3030
                    Top =1305
                    Width =259
                    Height =259
                    FontSize =10
                    ForeColor =0
                    Name ="Option1"
                    OnClick ="=HandleButtonClick(1)"
                    FontName ="System"
                    GUID = Begin
                        0xd5712d7ce99bdb4eaec53a6e6ffe63a6
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3390
                            Top =1305
                            Width =3990
                            Height =240
                            ForeColor =-2147483630
                            Name ="OptionLabel1"
                            OnClick ="=HandleButtonClick(1)"
                            GUID = Begin
                                0xee17a46f22ba6743903e464b4ec2892e
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3030
                    Top =1725
                    Width =259
                    Height =259
                    FontSize =10
                    TabIndex =1
                    ForeColor =0
                    Name ="Option2"
                    OnClick ="=HandleButtonClick(2)"
                    FontName ="System"
                    GUID = Begin
                        0x77adaf041292a942b19086ca4a5f4d3d
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3390
                            Top =1725
                            Width =3990
                            Height =240
                            ForeColor =-2147483630
                            Name ="OptionLabel2"
                            OnClick ="=HandleButtonClick(2)"
                            GUID = Begin
                                0x0b3e9ccdf4e1f24686ad4daa2f29d202
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3030
                    Top =2145
                    Width =259
                    Height =259
                    FontSize =10
                    TabIndex =2
                    ForeColor =0
                    Name ="Option3"
                    OnClick ="=HandleButtonClick(3)"
                    FontName ="System"
                    GUID = Begin
                        0x490c8a63ee148f4692bd7e0af2ff54b3
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3390
                            Top =2145
                            Width =3990
                            Height =240
                            ForeColor =-2147483630
                            Name ="OptionLabel3"
                            OnClick ="=HandleButtonClick(3)"
                            GUID = Begin
                                0x35fd0c431bcbe44eb62e5a591623f1f9
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3030
                    Top =2565
                    Width =259
                    Height =259
                    FontSize =10
                    TabIndex =3
                    ForeColor =0
                    Name ="Option4"
                    OnClick ="=HandleButtonClick(4)"
                    FontName ="System"
                    GUID = Begin
                        0xef2e026b3b2ddd458f80035ca716a934
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3390
                            Top =2565
                            Width =3990
                            Height =240
                            ForeColor =-2147483630
                            Name ="OptionLabel4"
                            OnClick ="=HandleButtonClick(4)"
                            GUID = Begin
                                0xa1d89d660a281347b8c254986d8109b5
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3030
                    Top =2985
                    Width =259
                    Height =259
                    FontSize =10
                    TabIndex =4
                    ForeColor =0
                    Name ="Option5"
                    OnClick ="=HandleButtonClick(5)"
                    FontName ="System"
                    GUID = Begin
                        0x1603fa6a2763e542800389490e0fdd58
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3390
                            Top =2985
                            Width =3990
                            Height =240
                            ForeColor =-2147483630
                            Name ="OptionLabel5"
                            OnClick ="=HandleButtonClick(5)"
                            GUID = Begin
                                0xcb3e4dfabb25854f8480942b812b0f10
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3030
                    Top =3405
                    Width =259
                    Height =259
                    FontSize =10
                    TabIndex =5
                    ForeColor =0
                    Name ="Option6"
                    OnClick ="=HandleButtonClick(6)"
                    FontName ="System"
                    GUID = Begin
                        0xa6b9992260506d448f3c4f5e5b4d1032
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3390
                            Top =3405
                            Width =3990
                            Height =240
                            ForeColor =-2147483630
                            Name ="OptionLabel6"
                            OnClick ="=HandleButtonClick(6)"
                            GUID = Begin
                                0x95ebe97b916e1544868245c22fb9627d
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3030
                    Top =3825
                    Width =259
                    Height =259
                    FontSize =10
                    TabIndex =6
                    ForeColor =0
                    Name ="Option7"
                    OnClick ="=HandleButtonClick(7)"
                    FontName ="System"
                    GUID = Begin
                        0x5113b83c9fddf8499036e00e5d05e69d
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3390
                            Top =3825
                            Width =3990
                            Height =240
                            ForeColor =-2147483630
                            Name ="OptionLabel7"
                            OnClick ="=HandleButtonClick(7)"
                            GUID = Begin
                                0x5f69bd2061087c46963d121a5237fb11
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3030
                    Top =4245
                    Width =259
                    Height =259
                    FontSize =10
                    TabIndex =7
                    ForeColor =0
                    Name ="Option8"
                    OnClick ="=HandleButtonClick(8)"
                    FontName ="System"
                    GUID = Begin
                        0xa46adafb6ca3ce4da73d3e4c1d8507eb
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3390
                            Top =4245
                            Width =3990
                            Height =240
                            ForeColor =-2147483630
                            Name ="OptionLabel8"
                            OnClick ="=HandleButtonClick(8)"
                            GUID = Begin
                                0xb27fc2c06987e14eb9a536406411266d
                            End
                        End
                    End
                End
                Begin Rectangle
                    SpecialEffect =0
                    BackStyle =1
                    OverlapFlags =223
                    Width =9330
                    Height =660
                    BackColor =8421376
                    BorderColor =8421376
                    Name ="HorizontalHeaderBox"
                    GUID = Begin
                        0x2377bb9ccd6e0943980b781bef2996ef
                    End
                End
                Begin Line
                    OverlapFlags =95
                    SpecialEffect =1
                    Left =2685
                    Top =1155
                    Width =4698
                    Name ="HorizontalDividingLine"
                    GUID = Begin
                        0xb909b66444c03244a381dba0fbc346aa
                    End
                End
                Begin Image
                    BackStyle =1
                    SizeMode =1
                    Width =2685
                    Height =4770
                    BackColor =8421376
                    Name ="Picture"
                    GUID = Begin
                        0x44bc59a70cf4c8448d78198f97bc1027
                    End
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =2
                    Left =2910
                    Top =120
                    Width =4365
                    Height =450
                    FontSize =18
                    ForeColor =65535
                    Name ="Label22"
                    Caption ="QCD of America (Dev)"
                    GUID = Begin
                        0x2c867e1229cba2468a083328eba7a6cc
                    End
                End
                Begin Rectangle
                    BackStyle =1
                    OverlapFlags =223
                    Left =300
                    Top =3360
                    Width =1980
                    Height =1320
                    BackColor =10040115
                    Name ="Box66"
                    GUID = Begin
                        0x8aaae35823094b4982f168e637e6e18f
                    End
                End
                Begin TextBox
                    OverlapFlags =215
                    Left =420
                    Top =4320
                    Width =1620
                    Height =300
                    FontSize =10
                    FontWeight =700
                    TabIndex =8
                    Name ="txtVersion"
                    GUID = Begin
                        0xba6e1c7545d35f47ac1a1e37782fe43d
                    End
                    Begin
                        Begin Label
                            OverlapFlags =223
                            Left =420
                            Top =4020
                            Width =1740
                            Height =300
                            FontSize =10
                            FontWeight =700
                            ForeColor =10092543
                            Name ="Label46"
                            Caption ="Current Version"
                            FontName ="Tahoma"
                            GUID = Begin
                                0x007404251abca24fa6b8c3b0d93d5928
                            End
                        End
                    End
                End
                Begin TextBox
                    SpecialEffect =0
                    OverlapFlags =215
                    BackStyle =0
                    Left =420
                    Top =3720
                    Width =1740
                    Height =300
                    FontSize =10
                    FontWeight =700
                    TabIndex =9
                    ForeColor =10092543
                    Name ="txtVersionFE"
                    GUID = Begin
                        0x5674ead64e34de42b4ff8195a627e2a4
                    End
                    Begin
                        Begin Label
                            OverlapFlags =223
                            Left =420
                            Top =3420
                            Width =1500
                            Height =300
                            FontSize =10
                            FontWeight =700
                            ForeColor =10092543
                            Name ="Label49"
                            Caption ="Front-End Ver."
                            FontName ="Tahoma"
                            GUID = Begin
                                0x41ffbb45d686af4881777f5f88fcbdac
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =840
                    Top =1125
                    Width =288
                    Height =288
                    TabIndex =10
                    Name ="btnQuit"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x8b517bd97db8e342a3725c8b4c085465
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Sub Form_Load()
    Call CheckVersion
End Sub

Private Sub Form_Open(Cancel As Integer)

    
    ' Minimize the database window and initialize the form.

    ' Move to the switchboard page that is marked as the default.
    Me.Filter = "[ItemNumber] = 0 AND [Argument] = 'Default' "
    Me.FilterOn = True
    
    Dim db As Database
    Set db = CurrentDb()
     
    Dim newtitle
     
    Set newtitle = db.CreateProperty("Apptitle", dbText, "QCD of America DEV")
    'db.Properties.Append newtitle
    db.Properties("AppTitle").value = "QCD of America DEV"
    Call Application.RefreshTitleBar
        
End Sub

Private Sub Form_Current()
' Update the caption and fill in the list of options.
    Call CheckVersion
    Me.Caption = Nz(Me![ItemText], "")
    FillOptions
    
End Sub

Private Sub FillOptions()
' Fill in the options for this switchboard page.

    ' The number of buttons on the form.
    Const conNumButtons = 8
    
    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset
    Dim strSQL As String
    Dim intOption As Integer
    
    ' Set the focus to the first button on the form,
    ' and then hide all of the buttons on the form
    ' but the first.  You can't hide the field with the focus.
    Me![Option1].SetFocus
    For intOption = 2 To conNumButtons
        Me("Option" & intOption).Visible = False
        Me("OptionLabel" & intOption).Visible = False
    Next intOption
    
    ' Open the table of Switchboard Items, and find
    ' the first item for this Switchboard Page.
    Set dbs = CurrentDb()
    strSQL = "SELECT * FROM [Switchboard Items]"
    strSQL = strSQL & " WHERE [ItemNumber] > 0 AND [SwitchboardID]=" & Me![SwitchboardID]
    strSQL = strSQL & " ORDER BY [ItemNumber];"
    Set rst = dbs.OpenRecordset(strSQL)
    
    ' If there are no options for this Switchboard Page,
    ' display a message.  Otherwise, fill the page with the items.
    If (rst.EOF) Then
        Me![OptionLabel1].Caption = "There are no items for this switchboard page"
    Else
        While (Not (rst.EOF))
            Me("Option" & rst![ItemNumber]).Visible = True
            Me("OptionLabel" & rst![ItemNumber]).Visible = True
            Me("OptionLabel" & rst![ItemNumber]).Caption = rst![ItemText]
            rst.MoveNext
        Wend
    End If

    ' Close the recordset and the database.
    rst.Close
    dbs.Close

End Sub

Private Function HandleButtonClick(intBtn As Integer)
' This function is called when a button is clicked.
' intBtn indicates which button was clicked.

    ' Constants for the commands that can be executed.
    Const conCmdGotoSwitchboard = 1
    Const conCmdOpenFormAdd = 2
    Const conCmdOpenFormBrowse = 3
    Const conCmdOpenReport = 4
    Const conCmdCustomizeSwitchboard = 5
    Const conCmdExitApplication = 6
    Const conCmdRunMacro = 7
    Const conCmdRunCode = 8
    Const conCmdOpenFormDatasheet = 9

    ' An error that is special cased.
    Const conErrDoCmdCancelled = 2501
    
    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset

On Error GoTo HandleButtonClick_Err

    ' Find the item in the Switchboard Items table
    ' that corresponds to the button that was clicked.
    Set dbs = CurrentDb()
    Set rst = dbs.OpenRecordset("Switchboard Items", dbOpenDynaset, dbSeeChanges)
    rst.FindFirst "[SwitchboardID]=" & Me![SwitchboardID] & " AND [ItemNumber]=" & intBtn
    
    ' If no item matches, report the error and exit the function.
    If (rst.NoMatch) Then
        MsgBox "There was an error reading the Switchboard Items table."
        rst.Close
        dbs.Close
        Exit Function
    End If
    
    Select Case rst![Command]
        
        ' Go to another switchboard.
        Case conCmdGotoSwitchboard
            Me.Filter = "[ItemNumber] = 0 AND [SwitchboardID]=" & rst![Argument]
            
        ' Open a form in Add mode.
        Case conCmdOpenFormAdd
            DoCmd.OpenForm rst![Argument], , , , acAdd

        ' Open a form.
        Case conCmdOpenFormBrowse
            DoCmd.OpenForm rst![Argument]

        ' Open a report.
        Case conCmdOpenReport
            DoCmd.OpenReport rst![Argument], acPreview

        ' Customize the Switchboard.
        Case conCmdCustomizeSwitchboard
            ' Handle the case where the Switchboard Manager
            ' is not installed (e.g. Minimal Install).
            On Error Resume Next
            Application.Run "WZMAIN80.sbm_Entry"
            If (Err <> 0) Then MsgBox "Command not available."
            On Error GoTo 0
            ' Update the form.
            Me.Filter = "[ItemNumber] = 0 AND [Argument] = 'Default' "
            Me.Caption = Nz(Me![ItemText], "")
            FillOptions

        ' Exit the application.
        Case conCmdExitApplication
            CloseCurrentDatabase

        ' Run a macro.
        Case conCmdRunMacro
            DoCmd.RunMacro rst![Argument]

        ' Run code.
        Case conCmdRunCode
            Application.Run rst![Argument]
            
        'Open form in datasheet mode
        Case conCmdOpenFormDatasheet
            DoCmd.OpenForm rst![Argument], acFormDS

        ' Any other command is unrecognized.
        Case Else
            MsgBox "Unknown option."
            
        
    
    End Select

    ' Close the recordset and the database.
    rst.Close
    dbs.Close
    
HandleButtonClick_Exit:
    Exit Function

HandleButtonClick_Err:
    ' If the action was cancelled by the user for
    ' some reason, don't display an error message.
    ' Instead, resume on the next line.
    If (Err = conErrDoCmdCancelled) Then
        Resume Next
    Else
        MsgBox "There was an error executing the command.", vbCritical
        Resume HandleButtonClick_Exit
    End If
    
End Function

Private Function CheckVersion() As Boolean
  
  Dim strSQL As String
  Dim rst As DAO.Recordset
  Dim dbs As DAO.Database
  Dim strVersion As String
  
  Set dbs = CurrentDb()
  
  strSQL = "SELECT tblVersion.Version FROM tblVersion;"

  'strSQL = "SELECT TOP 1 tblVersion.ID, tblVersion.Version FROM tblVersion ORDER BY tblVersion.ID DESC;"
  Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
  With rst
    strVersion = !Version
  End With

  Me.txtVersionFE = strVersion
  strSQL = "SELECT TOP 1 tblVersion_Control.Version FROM tblVersion_Control ORDER BY tblVersion_Control.ID DESC;"
  'strSQL = "SELECT tblVersion.Version FROM tblVersion;"
  Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
  With rst
    Me.txtVersion = !Version
    If !Version <> strVersion Then
      MsgBox "You need to update your frontend with the Network version! ", vbExclamation, "Version Check"
    End If
  End With

  rst.Close
  Set dbs = Nothing
  CheckVersion = True
End Function


Public Sub btnQuit_Click()
On Error GoTo Err_btnQuit_Click


    Application.Quit acQuitPrompt

Exit_btnQuit_Click:
    Exit Sub

Err_btnQuit_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_btnQuit_Click
    
End Sub