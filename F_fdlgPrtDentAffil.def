Version =20
VersionRequired =20
Checksum =-90190652
Begin Form
    Modal = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularFamily =96
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =5640
    DatasheetFontHeight =10
    ItemSuffix =23
    Left =-22692
    Top =1692
    Right =-15264
    Bottom =8592
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x90faff309abde240
    End
    Caption ="Dentist Affiliation Report"
    OnOpen ="[Event Procedure]"
    MenuBar ="Dialog"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010402059c00f40443ef800501000100ea0a6f08640001000f00c80002000100 ,
        0xc800030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe220000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000000000c40200000000000000000000000000000000 ,
        0x00000000000000000300000000000000300210005c4b03006843040000000000 ,
        0x000000000000000000000000000000000000000000000000449f6be605000000 ,
        0x04000000ff00ff00010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x3002000045424441000001000100000001000000010000000100000000000000 ,
        0x5300740061006e00640061007200640000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000001000000
    End
    PrtDevNames = Begin
        0x08001c0026000100000000000000000000000000000000000000000000000000 ,
        0x0000000000004d7920446f63756d656e74735c2a2e70646600
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin ListBox
            SpecialEffect =2
            FontName ="Tahoma"
        End
        Begin Section
            Height =4860
            BackColor =12632256
            Name ="Detail"
            GUID = Begin
                0x080db9ff67b15948ad04906cafaff22a
            End
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    Left =4500
                    Top =4020
                    Width =846
                    Height =486
                    Name ="cmdClose"
                    Caption ="Command0"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff000000c0c0c000ffff00000000ff00c0c0c00000ffff00 ,
                        0xffffff0000000000
                    End
                    ControlTipText ="Close Form"
                    GUID = Begin
                        0x8dd84339492bef4ca78a992c7513f666
                    End
                End
                Begin ListBox
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =180
                    Top =720
                    Width =936
                    Height =3120
                    TabIndex =1
                    Name ="lstGeo"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tmpGeo.GEO, tmpGeo.GeoDesc, tmpGeo.Moved FROM tmpGeo WHERE (((tmpGeo.Move"
                        "d)=No)) ORDER BY tmpGeo.GEO;"
                    AfterUpdate ="[Event Procedure]"
                    OnDblClick ="[Event Procedure]"
                    GUID = Begin
                        0x0ac1dcdd1e5ba64d92660206c24c6651
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =180
                            Top =480
                            Width =420
                            Height =240
                            Name ="Label2"
                            Caption ="GEO "
                            GUID = Begin
                                0xe7ac6919420d1b46af318cceca3e90d8
                            End
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    Top =4140
                    Width =1020
                    Height =180
                    TabIndex =2
                    BackColor =10092543
                    Name ="txtGeoSelected"
                    GUID = Begin
                        0x240235a7d979534491b36a8d28d631fe
                    End
                End
                Begin ListBox
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =1620
                    Top =720
                    Width =936
                    Height =3120
                    TabIndex =3
                    Name ="lstGeoSel"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tmpGeoSel.GEO, tmpGeoSel.GeoDesc FROM tmpGeoSel ORDER BY tmpGeoSel.GEO;"
                    OnDblClick ="[Event Procedure]"
                    GUID = Begin
                        0x89afdac0e1e97544af732af5da50e452
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =1620
                            Top =480
                            Width =900
                            Height =240
                            Name ="Label6"
                            Caption ="GEO Filter "
                            GUID = Begin
                                0x8393bfb1bd79ff419c79e3016d8beacf
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =1200
                    Top =1080
                    Width =360
                    TabIndex =4
                    Name ="cmdAdd"
                    Caption =">"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Move Selected GEO"
                    GUID = Begin
                        0xda0525c6e0a4fd469003caf8cd44f22c
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =1200
                    Top =2115
                    Width =360
                    TabIndex =5
                    Name ="cmdDelete"
                    Caption ="<"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Remove Selected GEO"
                    GUID = Begin
                        0x12f7e432e27e844fb2b3e4febfe82fab
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =1200
                    Top =1515
                    Width =360
                    TabIndex =6
                    Name ="cmdAddAll"
                    Caption =">>"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Move All GEO's"
                    GUID = Begin
                        0xeff0068fe3caa844bba0af7e00eb9c75
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =1200
                    Top =2535
                    Width =360
                    TabIndex =7
                    Name ="cmdDeleteAll"
                    Caption ="<<"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Remove All GEO's"
                    GUID = Begin
                        0x1429808e98886e4b9bd51047c715e6ff
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =82
                    TextFontFamily =2
                    Left =3480
                    Top =4020
                    Width =717
                    Height =478
                    FontSize =10
                    FontWeight =700
                    TabIndex =8
                    ForeColor =0
                    Name ="cmdPrint"
                    Caption ="Print Preview&R"
                    StatusBarText ="Preview Report"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000017000000160000000100040000000000080100000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888889888888888888888888888884 ,
                        0x88888888888888888888888388888888888888888888888e8888000000000000 ,
                        0x8800888288880ffffffffff08000888d88880fffffff00007008888888880fff ,
                        0xfff078870788888588880fffff0788f77088888288880fffff08888780888884 ,
                        0x88880fffff08f8878088888888880fffff07ff877088888088880ffffff07887 ,
                        0x0888888088880fffffff00008888888088880ffffffffff08888888088880fff ,
                        0xffff00008888888088880fffffff08088888888188880fffffff008888888886 ,
                        0x8888000000000888888888808888888888888888888888808888888888888888 ,
                        0x88888880888888888888888888888880
                    End
                    FontName ="System"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                    GUID = Begin
                        0x0b0a450047cc304c99dd0e88252aa800
                    End
                End
                Begin ListBox
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =2880
                    Top =720
                    Width =936
                    Height =3120
                    TabIndex =9
                    Name ="lstSpec"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tmpSpec.Spec, tmpSpec.SpecDesc, tmpSpec.Moved FROM tmpSpec WHERE (((tmpSp"
                        "ec.Moved)=No)) ORDER BY tmpSpec.Spec;"
                    AfterUpdate ="[Event Procedure]"
                    OnDblClick ="[Event Procedure]"
                    GUID = Begin
                        0xdf0cced5d2135a43be51682f1c793123
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =2880
                            Top =480
                            Width =720
                            Height =240
                            Name ="Label8"
                            Caption ="Specialty"
                            GUID = Begin
                                0x3128fb4346c2e8418162b1bf6bf8446c
                            End
                        End
                    End
                End
                Begin ListBox
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =4320
                    Top =720
                    Width =936
                    Height =3120
                    TabIndex =10
                    Name ="lstSpecSel"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tmpSpecSel.Spec, tmpSpecSel.SpecDesc FROM tmpSpecSel ORDER BY tmpSpecSel."
                        "Spec;"
                    GUID = Begin
                        0xd1f2620aa14cc841a7c21dc50954a80b
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =4320
                            Top =480
                            Width =960
                            Height =240
                            Name ="Label10"
                            Caption ="Spec Filter"
                            GUID = Begin
                                0xba31f980a4c11e4b8f00e91bb5452b7f
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =3900
                    Top =1080
                    Width =360
                    TabIndex =11
                    Name ="cmdAddSpec"
                    Caption =">"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Move Selected Spec"
                    GUID = Begin
                        0xca0b2b3b4b28cc4a94f0e74d99c9053d
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =3900
                    Top =2115
                    Width =360
                    TabIndex =12
                    Name ="cmdSpecDel"
                    Caption ="<"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Remove Selected Spec"
                    GUID = Begin
                        0x038c63398864634f8f9de5b8be4013d9
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =3900
                    Top =1515
                    Width =360
                    TabIndex =13
                    Name ="cmdAddSpecAll"
                    Caption =">>"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Move All Spec's"
                    GUID = Begin
                        0x8c7d28da38c07248954e7393ddaad356
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =3900
                    Top =2535
                    Width =360
                    TabIndex =14
                    Name ="cmdSpecDelAll"
                    Caption ="<<"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Remove All Spec's"
                    GUID = Begin
                        0x01be30cdfa13c241981858b31612777d
                    End
                End
                Begin Rectangle
                    OverlapFlags =223
                    Left =120
                    Top =420
                    Width =2520
                    Height =3480
                    Name ="Box15"
                    GUID = Begin
                        0x728832e45ddf954191452a063ab799cf
                    End
                End
                Begin Rectangle
                    OverlapFlags =223
                    Left =2820
                    Top =420
                    Width =2520
                    Height =3480
                    Name ="Box16"
                    GUID = Begin
                        0xd265e64feae0a44a8577c1fa6ed59dad
                    End
                End
                Begin Label
                    OverlapFlags =255
                    TextAlign =3
                    Left =240
                    Top =4020
                    Width =2022
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text40"
                    Caption ="Affiliation Date From: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xc1d7339e991fef40adfc9e0480d3e874
                    End
                End
                Begin Label
                    OverlapFlags =255
                    TextAlign =3
                    Left =240
                    Top =4260
                    Width =2022
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text41"
                    Caption ="To: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xcbf39d3c15623c44aa822b83530a9c90
                    End
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =1
                    OverlapFlags =127
                    Left =2262
                    Top =4020
                    Width =1008
                    TabIndex =15
                    Name ="AffilDATE1"
                    Format ="m/d/yyyy"
                    FontName ="MS Sans Serif"
                    InputMask ="99/99/0000;0;_"
                    GUID = Begin
                        0x64d7e685265d07499b42c145d528bc51
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =1
                    OverlapFlags =119
                    Left =2262
                    Top =4260
                    Width =1008
                    TabIndex =16
                    Name ="AffilDATE2"
                    Format ="m/d/yyyy"
                    FontName ="MS Sans Serif"
                    InputMask ="99/99/0000;0;_"
                    GUID = Begin
                        0xe20c02fa06648345aa5fded8664c4226
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =247
                    IMESentenceMode =3
                    Top =3960
                    Width =1020
                    Height =180
                    TabIndex =17
                    BackColor =10092543
                    Name ="txtSpecSelected"
                    GUID = Begin
                        0x8fb0f566a34ec045bc1c1c7254eaafc7
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =180
                    Top =60
                    Width =4320
                    Height =300
                    FontSize =10
                    FontWeight =700
                    Name ="Label18"
                    Caption ="Dentist Affiliation Report"
                    GUID = Begin
                        0x4cfcf366f4c207448737d3e5421038bb
                    End
                End
                Begin Label
                    OverlapFlags =93
                    Left =180
                    Top =4560
                    Width =5460
                    Height =240
                    ForeColor =128
                    Name ="Label19"
                    Caption ="Geo and Specialty Filters default to ALL records if none selected."
                    GUID = Begin
                        0xe2b1bc7d07b8804093bbf0d5bdb9686d
                    End
                End
                Begin Label
                    OverlapFlags =223
                    Left =600
                    Top =480
                    Width =180
                    Height =240
                    FontWeight =700
                    ForeColor =128
                    Name ="Label20"
                    Caption ="*"
                    GUID = Begin
                        0xbecb6ac92f2b0c4691ac3b03abfddb3c
                    End
                End
                Begin Label
                    OverlapFlags =223
                    Left =3600
                    Top =480
                    Width =180
                    Height =240
                    FontWeight =700
                    ForeColor =128
                    Name ="Label21"
                    Caption ="*"
                    GUID = Begin
                        0x0e744195d430ac4ba2921d072b62b8a8
                    End
                End
                Begin Label
                    OverlapFlags =215
                    Left =60
                    Top =4560
                    Width =180
                    Height =240
                    FontWeight =700
                    ForeColor =128
                    Name ="Label22"
                    Caption ="*"
                    GUID = Begin
                        0xe2375b16f06c794a872a24e8dbc3c999
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Dim strSQL As String
Dim dbs As DAO.Database
Dim rst As DAO.Recordset

Private Sub cmdAdd_Click()
    
    Dim frm As Form, ctl As Control
    
    Set frm = Forms!fdlgPrtDentAffil
    Set ctl = frm!lstGeo
    
    Set dbs = CurrentDb()
    
    On Error GoTo err_cmdAddOne_Click
       
    If (ctl = "") = False Then
        strSQL = "INSERT INTO tmpGeoSel ( GEO, GeoDesc ) " & _
            "SELECT GEO, GeoDesc " & _
            "FROM tmpGeo " & _
            "WHERE (((tmpGeo.GEO)='" & ctl & "'));"
        dbs.Execute strSQL, dbSeeChanges
        strSQL = "UPDATE tmpGeo SET tmpGeo.Moved = Yes " & _
            "WHERE (((tmpGeo.GEO)='" & ctl & "'));"
        dbs.Execute strSQL, dbSeeChanges
        Me.lstGeo.Requery
        Me.lstGeoSel.Requery
    End If
        
    Set dbs = Nothing
Exit_cmdAddOne_Click:
    Exit Sub
    
err_cmdAddOne_Click:
    MsgBox "The following error occured: " & Error$
    Resume Exit_cmdAddOne_Click
End Sub

Private Sub cmdAddAll_Click()
   
    Set dbs = CurrentDb()
    
    On Error GoTo err_cmdAddAll_Click
    
    strSQL = "INSERT INTO tmpGeoSel ( GEO, GeoDesc ) " & _
        "SELECT GEO, GeoDesc " & _
        "FROM tmpGeo WHERE  tmpGeo.Moved = No; "
    dbs.Execute strSQL, dbSeeChanges
    strSQL = "UPDATE tmpGeo SET tmpGeo.Moved = Yes; "
    dbs.Execute strSQL, dbSeeChanges
    Me.lstGeo.Requery
    Me.lstGeoSel.Requery
        
Exit_cmdAddAll_Click:
    Exit Sub
    
err_cmdAddAll_Click:
    MsgBox "The following error occured: " & Error$
    Resume Exit_cmdAddAll_Click
End Sub

Private Sub cmdAddSpec_Click()
    Dim frm As Form, ctl As Control
    
    Set frm = Forms!fdlgPrtDentAffil
    Set ctl = frm!lstSpec
    
    Set dbs = CurrentDb()
    
    On Error GoTo err_cmdAddSpec_Click
       
    If (ctl = "") = False Then
        strSQL = "INSERT INTO tmpSpecSel ( Spec, SpecDesc ) " & _
            "SELECT Spec, SpecDesc " & _
            "FROM tmpSpec " & _
            "WHERE (((tmpSpec.Spec)='" & ctl & "'));"
        dbs.Execute strSQL, dbSeeChanges
        strSQL = "UPDATE tmpSpec SET tmpSpec.Moved = Yes " & _
            "WHERE (((tmpSpec.Spec)='" & ctl & "'));"
        dbs.Execute strSQL, dbSeeChanges
        Me.lstSpec.Requery
        Me.lstSpecSel.Requery
    End If
        
    Set dbs = Nothing
Exit_cmdAddSpec_Click:
    Exit Sub
    
err_cmdAddSpec_Click:
    MsgBox "The following error occured: " & Error$
    Resume Exit_cmdAddSpec_Click
End Sub

Private Sub cmdAddSpecAll_Click()
   
    Set dbs = CurrentDb()
    
    On Error GoTo err_cmdAddAll_Click
    
    strSQL = "INSERT INTO tmpSpecSel ( Spec, SpecDesc ) " & _
        "SELECT Spec, SpecDesc " & _
        "FROM tmpSpec WHERE tmpSpec.Moved = No; "
    dbs.Execute strSQL, dbSeeChanges
    strSQL = "UPDATE tmpSpec SET tmpSpec.Moved = Yes; "
    dbs.Execute strSQL, dbSeeChanges
    Me.lstSpec.Requery
    Me.lstSpecSel.Requery
        
Exit_cmdAddAll_Click:
    Exit Sub
    
err_cmdAddAll_Click:
    MsgBox "The following error occured: " & Error$
    Resume Exit_cmdAddAll_Click
End Sub

Private Sub cmdClose_Click()
On Error GoTo Err_cmdClose_Click


    DoCmd.Close

Exit_cmdClose_Click:
    Exit Sub

Err_cmdClose_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_cmdClose_Click
    
End Sub


Private Sub cmdDelete_Click()
    Dim frm As Form, ctl As Control
    
    Set frm = Forms!fdlgPrtDentAffil
    Set ctl = frm!lstGeoSel
    
    Set dbs = CurrentDb()
    
    On Error GoTo err_cmdDelete_Click
    
    If (ctl = "") = False Then
        strSQL = "DELETE FROM tmpGeoSel Where  (((tmpGeoSel.GEO)='" & ctl & "'));"
        dbs.Execute strSQL, dbSeeChanges
        strSQL = "UPDATE tmpGeo SET tmpGeo.Moved = No " & _
            "WHERE (((tmpGeo.GEO)='" & ctl & "'));"
        dbs.Execute strSQL, dbSeeChanges
        Me.lstGeo.Requery
        Me.lstGeoSel.Requery
    End If
    
    Set dbs = Nothing
Exit_cmdDelete_Click:
    Exit Sub
    
err_cmdDelete_Click:
    MsgBox "The following error occured: " & Error$
    Resume Exit_cmdDelete_Click
End Sub

Private Sub cmdDeleteAll_Click()
    Dim frm As Form, ctl As Control
    
    Set dbs = CurrentDb()
    
    On Error GoTo err_cmdDeleteAll_Click
    

    strSQL = "DELETE FROM tmpGeoSel;"
    dbs.Execute strSQL, dbSeeChanges
    strSQL = "UPDATE tmpGeo SET tmpGeo.Moved = No; "
    dbs.Execute strSQL, dbSeeChanges
    Me.lstGeo.Requery
    Me.lstGeoSel.Requery

    
    Set dbs = Nothing
Exit_cmdDeleteAll_Click:
    Exit Sub
    
err_cmdDeleteAll_Click:
    MsgBox "The following error occured: " & Error$
    Resume Exit_cmdDeleteAll_Click

End Sub

Private Sub cmdPrint_Click()
On Error GoTo PROC_ERR
    
    Dim strSQL As String
    Dim strStDocName As String
    Dim strSQL2 As String
    Dim rst2 As DAO.Recordset
    Dim strGeo As String
    Dim strSpec As String
    Dim lngCnt As Long
    Dim strWhere As String
        
    If Me.AffilDATE1 = "" Or IsNull(Me.AffilDATE1) Then
        MsgBox "You must enter an Affiliation Date range!", vbCritical, "QCD Error"
        Me.AffilDATE1.SetFocus
        Exit Sub
    End If
    If Me.AffilDATE2 = "" Or IsNull(Me.AffilDATE2) Then
        MsgBox "You must enter an Affiliation Date range!", vbCritical, "QCD Error"
        Me.AffilDATE2.SetFocus
        Exit Sub
    End If
    
    strWhere = "tbldentist.DentAffilDate Between #" & Me.AffilDATE1 & "# AND #" & Me.AffilDATE2 & "# "
    
    Set dbs = CurrentDb()
    'Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
    'If rst.RecordCount > 0 Then
        strStDocName = "rptDentAffilGeo"
        
        If Me.txtGeoSelected = "" Or IsNull(Me.txtGeoSelected) Then
            ' No Filtering
        Else
            ' build the filter
            strSQL2 = "Select GEO from tmpGeoSel Order By Geo"
            Set rst2 = dbs.OpenRecordset(strSQL2, dbOpenSnapshot)
            If rst2.RecordCount > 0 Then
            lngCnt = 1
            rst2.MoveFirst
            Do While Not rst2.EOF
                If lngCnt = 1 Then
                    strGeo = "'" & rst2.Fields("GEO") & "'"
                Else
                    strGeo = strGeo & ",'" & rst2.Fields("GEO") & "'"
                End If
                lngCnt = lngCnt + 1
                rst2.MoveNext
            Loop
            rst2.Close
            End If
        End If
        
        If Me.txtSpecSelected = "" Or IsNull(Me.txtSpecSelected) Then
            ' No Filtering
        Else
            ' build the filter
            strSQL2 = "Select SPEC from tmpSpecSel Order By Spec"
            Set rst2 = dbs.OpenRecordset(strSQL2, dbOpenSnapshot)
            If rst2.RecordCount > 0 Then
            lngCnt = 1
            rst2.MoveFirst
            Do While Not rst2.EOF
                If lngCnt = 1 Then
                    strSpec = "'" & rst2.Fields("Spec") & "'"
                Else
                    strSpec = strSpec & ",'" & rst2.Fields("Spec") & "'"
                End If
                lngCnt = lngCnt + 1
                rst2.MoveNext
            Loop
            rst2.Close
            End If
        End If
        
        
        If Len(strGeo) > 0 Then
         If Len(strSpec) > 0 Then
            ' Filter Both
            strWhere = strWhere & " AND tbldentist.DentGeoID in (" & strGeo & ") AND tbldentist.DentSpecialty IN (" & strSpec & ")"
         Else
            ' Filter only Geo
            strWhere = strWhere & " AND tbldentist.DentGeoID in (" & strGeo & ") "
         End If
        Else
         If Len(strSpec) > 0 Then
            ' Filter Spec
            strWhere = strWhere & " AND tbldentist.DentSpecialty in (" & strSpec & ") "
         Else
            ' No Filter
         End If
        End If
        
        Dim fCheck As Boolean
        fCheck = GetRecCnt(strWhere)
        If fCheck = True Then
            Me.Visible = False
            DoCmd.OpenReport strStDocName, acViewPreview, , strWhere
            'DoCmd.OpenReport strStDocName, acPreview, , strWhere, acWindowNormal
        Else
            MsgBox "The criteria you have chosen has resulted in no records." & vbCrLf & vbCrLf & "Please make another criteria selection and try again!"
            DoCmd.Hourglass False
            Me.Visible = True
            Exit Sub
        End If

  Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
  
End Sub

Private Function GetRecCnt(strWhere) As Boolean

    strSQL = "SELECT Count(*) as Cnt " & _
         "FROM (tbldentist LEFT JOIN tbldentistspec ON tbldentist.DentSpecialty = tbldentistspec.SPECIALTYID) " & _
         "LEFT JOIN tblGeographical ON tbldentist.DentGeoID = tblGeographical.GEOid " & _
         "WHERE tbldentist.DentStatus ='A' AND " & _
         strWhere & ";"
    Set dbs = CurrentDb()
    Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
    If rst.RecordCount > 0 Then
        GetRecCnt = True
    Else
        GetRecCnt = False
    End If
    rst.Close
    Set dbs = Nothing

End Function


Private Sub cmdSpecDel_Click()
    Dim frm As Form, ctl As Control
    
    Set frm = Forms!fdlgPrtDentAffil
    Set ctl = frm!lstSpecSel
    
    Set dbs = CurrentDb()
    
    On Error GoTo err_cmdSpecDel_Click
    
    If (ctl = "") = False Then
        strSQL = "DELETE FROM tmpSpecSel Where  (((tmpSpecSel.Spec)='" & ctl & "'));"
        dbs.Execute strSQL, dbSeeChanges
        strSQL = "UPDATE tmpSpec SET tmpSpec.Moved = No " & _
            "WHERE (((tmpSpec.Spec)='" & ctl & "'));"
        dbs.Execute strSQL, dbSeeChanges
        Me.lstSpec.Requery
        Me.lstSpecSel.Requery
    End If
    
    Set dbs = Nothing
Exit_cmdSpecDel_Click:
    Exit Sub
    
err_cmdSpecDel_Click:
    MsgBox "The following error occured: " & Error$
    Resume Exit_cmdSpecDel_Click
End Sub

Private Sub cmdSpecDelAll_Click()
    
    Set dbs = CurrentDb()
    
    On Error GoTo err_cmdSpecDelAll_Click
    

    strSQL = "DELETE FROM tmpSpecSel;"
    dbs.Execute strSQL, dbSeeChanges
    strSQL = "UPDATE tmpSpec SET tmpSpec.Moved = No; "
    dbs.Execute strSQL, dbSeeChanges
    Me.lstSpec.Requery
    Me.lstSpecSel.Requery

    
    Set dbs = Nothing
Exit_cmdSpecDelAll_Click:
    Exit Sub
    
err_cmdSpecDelAll_Click:
    MsgBox "The following error occured: " & Error$
    Resume Exit_cmdSpecDelAll_Click
End Sub

Private Sub Form_Open(Cancel As Integer)
' Populate temp tables
    Set dbs = CurrentDb()
    
    DoCmd.SetWarnings False
    strSQL = "Delete FROM tmpGeo;"
    dbs.Execute strSQL, dbSeeChanges
    strSQL = "Delete FROM tmpGeoSel;"
    dbs.Execute strSQL, dbSeeChanges
    strSQL = "Delete FROM tmpSpec;"
    dbs.Execute strSQL, dbSeeChanges
    strSQL = "Delete FROM tmpSpecSel;"
    dbs.Execute strSQL, dbSeeChanges
    
    strSQL = "INSERT INTO tmpGeo ( GEO, GeoDesc ) " & _
             "SELECT tblGeographical.GEOid AS Geo_ID, tblGeographical.GEOdesc AS Geo_Description " & _
             "FROM tblGeographical ORDER BY tblGeographical.GEOid;"
    dbs.Execute strSQL, dbSeeChanges
    
    Me.lstGeo.Requery
    Me.lstGeoSel.Requery
    
    
    strSQL = "INSERT INTO tmpSpec ( Spec, SpecDesc ) " & _
             "SELECT tbldentistspec.SPECIALTYID AS Spec_ID, tbldentistspec.SPECIALITYdesc AS Speciality_Description " & _
             "FROM tbldentistspec ORDER BY tbldentistspec.SPECIALTYID;"
    dbs.Execute strSQL, dbSeeChanges
    
    Me.lstSpec.Requery
    Me.lstSpecSel.Requery
    
    DoCmd.SetWarnings True
    Set dbs = Nothing
End Sub

Private Sub lstGeo_AfterUpdate()
On Error GoTo PROC_ERR
    

    Dim frm As Form, ctl As Control
    
    Set frm = Forms!fdlgPrtDentAffil
    Set ctl = frm!lstGeo

    Me.txtGeoSelected = ctl

    Exit Sub
    
PROC_ERR:
    MsgBox "The following error occured: " & Error$
    Resume Next
End Sub

Private Sub lstGeo_DblClick(Cancel As Integer)
    Call cmdAdd_Click
End Sub

Private Sub lstGeoSel_DblClick(Cancel As Integer)
    Call cmdDelete_Click
End Sub

Private Sub lstSpec_AfterUpdate()
On Error GoTo PROC_ERR
    

    Dim frm As Form, ctl As Control
    
    Set frm = Forms!fdlgPrtDentAffil
    Set ctl = frm!lstSpec
    
    Me.txtSpecSelected = ctl
    
    Exit Sub
    
PROC_ERR:
    MsgBox "The following error occured: " & Error$
    Resume Next
End Sub

Private Sub lstSpec_DblClick(Cancel As Integer)
    Call cmdAddSpec_Click
End Sub