Version =20
VersionRequired =20
Checksum =1735822801
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =3480
    DatasheetFontHeight =10
    ItemSuffix =9
    Left =8490
    Top =1110
    Right =12480
    Bottom =5310
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xf4f15965d3a0e240
    End
    Caption ="All American Sync"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400049c00600353ef800101000100ea0a6f08640001000f00b00402000100 ,
        0xb004030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000044666178 ,
        0x0000000001000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x0800240028000100000000000000000000000000000000000000000000000000 ,
        0x00000000000000005348524641583a00
    End
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin Section
            Height =3720
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin Label
                    SpecialEffect =4
                    OldBorderStyle =1
                    BorderWidth =3
                    OverlapFlags =85
                    TextAlign =2
                    Left =180
                    Top =120
                    Width =3120
                    Height =360
                    FontSize =12
                    FontWeight =700
                    Name ="Label0"
                    Caption ="All American Sync"
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =600
                    Top =1560
                    Width =1620
                    Height =420
                    Name ="cmdProcess"
                    Caption ="Process Groups"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =600
                    Top =2100
                    Width =1620
                    Height =420
                    TabIndex =1
                    Name ="cmdPrint"
                    Caption ="Print Report"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =600
                    Top =2640
                    Width =1620
                    Height =420
                    TabIndex =2
                    Name ="cmdImport"
                    Caption ="Import New"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =2640
                    Top =3180
                    Width =726
                    Height =426
                    TabIndex =3
                    Name ="cmdClose"
                    Caption ="Command4"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff000000c0c0c000ffff00000000ff00c0c0c00000ffff00 ,
                        0xffffff0000000000
                    End
                    ControlTipText ="Close Form"
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =780
                    Top =720
                    Width =1980
                    Height =480
                    TabIndex =4
                    Name ="cmdViewChanges"
                    Caption ="View Changed Details"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x82fac25cca84a24aa4eed5ccde9579cd
                    End
                End
                Begin Rectangle
                    OverlapFlags =215
                    Left =420
                    Top =600
                    Width =2640
                    Name ="Box6"
                    GUID = Begin
                        0xa1e8de712a31cc4aae3745c2a0140c0b
                    End
                End
                Begin Rectangle
                    OverlapFlags =223
                    Left =420
                    Top =1440
                    Width =1980
                    Height =2220
                    Name ="Box7"
                    GUID = Begin
                        0x24d4e452bb94894283ea50f4dd6047ea
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =600
                    Top =3180
                    Width =1620
                    Height =420
                    TabIndex =5
                    Name ="cmdPrintCards"
                    Caption ="Print Cards"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xfd17dc958714914c85e8c69717632603
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Sub cmdImport_Click()
  ' Comments   :
  ' Parameters :
  ' Created    : 2/28/2004 1:05:53 PM Admin
  ' Modified   :
  '
  ' --------------------------------------------------------
  On Error GoTo HandleError
      
      Dim intResp As Integer
    
      Dim strGrp As String
      Dim lngImpS As Long
      Dim lngImpD As Long
      Dim lngCurS As Long
      Dim lngCurD As Long
      Dim lngDelASR As Long
      Dim strMsg As String
      Dim strGrpID As String
      Dim strSQL As String
      
      Dim db As DAO.Database
      Dim rst As DAO.Recordset
      
      Set db = CurrentDb()
      DoCmd.Hourglass True
      Call PopulateEDISubIDs
      
      ' get Import Subscriber count
      strSQL = "SELECT Count(tblEDI_App_Subscr.SUBssn) AS ImpSCnt FROM tblEDI_App_Subscr;"
      Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
      If rst.RecordCount > 0 Then
        lngImpS = rst.Fields("ImpSCnt")
        rst.Close
      Else
        lngImpS = 0
      End If
      ' get Import Dependent Count
      strSQL = "SELECT Count(tblEDI_App_Dep.DEPsubID) AS ImpDCnt FROM tblEDI_App_Dep;"
      Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
      If rst.RecordCount > 0 Then
        lngImpD = rst.Fields("ImpDCnt")
        rst.Close
      Else
        lngImpD = 0
      End If
          
    'strMsg = "Group: " & Me.cboGroups.Column(1) & vbCrLf & vbCrLf
    strMsg = strMsg & "QCD All American File:" & vbCrLf
    strMsg = strMsg & "Subscribers - " & CStr(lngImpS) & vbCrLf
    strMsg = strMsg & "Dependents - " & CStr(lngImpD) & vbCrLf & vbCrLf
    'strMsg = strMsg & "Current Counts: " & vbCrLf
    'strMsg = strMsg & "Subscribers - " & CStr(lngCurS) & vbCrLf
    'strMsg = strMsg & "Dependents - " & CStr(lngCurD) & vbCrLf & vbCrLf
    strMsg = strMsg & "Are you sure you want to perform this update? " & vbCrLf
    strMsg = strMsg & "This procedure cannot be undone!"
    DoCmd.Hourglass False
      
    intResp = MsgBox(strMsg, vbQuestion + vbYesNo + vbDefaultButton2, "QCD: Confirm Action")
    If intResp = vbYes Then
        DoCmd.Hourglass True
        DoCmd.SetWarnings False
        ' populate table for all AA groups
        db.Execute "DELETE tblAAGroups.* FROM tblAAGroups;", dbSeeChanges
        db.Execute "INSERT INTO tblAAGroups ( SUBgroupID )SELECT DISTINCT tblEDI_App_Subscr.SUBgroupID FROM tblEDI_App_Subscr;", dbSeeChanges
        ' delete subscribers first where the GroupID's match
        strSQL = "DELETE FROM tblSubscr WHERE SUBgroupID IN (Select SUBgroupID FROM tblAAGroups)"
        ExecuteSQL strSQL
        'delete subscribers second where the SSN's match
         strSQL = "DELETE FROM tblSubscr WHERE SUBssn IN (SELECT SUBssn FROM tblEDI_App_Subscr)"
        ExecuteSQL strSQL
        
        Set db = Nothing
      
        DoCmd.OpenQuery "qappEDI_Subscr_Final"
        DoCmd.OpenQuery "qappEDI_Dep_Final"
      
        'Update PlanID for All American Import
        ExecuteSQL ("UPDATE tblSubscr Set tblSubscr.PlanID = tlkpAllAmericanPlan.PlanID FROM tblSubscr " & _
                        "INNER JOIN tmpExportAllAmerican ON tblSubscr.SUBssn = tmpExportAllAmerican.EISSN " & _
                        "INNER JOIN tlkpAllAmericanPlan  ON tlkpAllAmericanPlan.PlanagerCode = tmpExportAllAmerican.EINMPLAN")
                         
        DoCmd.SetWarnings True
        DoCmd.Hourglass False
        MsgBox "Import File information imported.", vbExclamation, "QCD: Confirm"
      
    End If
    
ExitProc:
  Exit Sub

HandleError:
  MsgBox "Error: " & Err.DESCRIPTION & _
     " (" & Err.Number & ")", vbExclamation
  Resume ExitProc

End Sub

Private Sub cmdPrint_Click()
  ' Comments   : Prints a report of new subscribers
  ' Parameters : None
  ' Created    : 2/28/2004 1:31:11 PM Admin
  ' Modified   :
  '
  ' --------------------------------------------------------
  On Error GoTo HandleError
  
    DoCmd.SetWarnings False
    ExecuteSQL ("EXEC uspPrintAAreport")
    
'    'DoCmd.RunSQL "DELETE * FROM tmpEDI_rpt"
'    DoCmd.OpenQuery "qupdEDI_SubscriberNew"
'    DoCmd.OpenQuery "qrpt_EDI_NewSubsAA"
'    DoCmd.OpenQuery "qrpt_EDI_GrpSubsAA"
'    DoCmd.OpenQuery "qrpt_EDI_IndivSubs"
'    'Added for ASR Changes
'    'Check Name changes Change-A
'    DoCmd.OpenQuery "qrpt_EDI_ChangeSubsAA_NameChange"
'    'Check Address (Zip only) changes Change-B
'    DoCmd.OpenQuery "qrpt_EDI_ChangeSubsAA_AddressZip"
'    'Check for Coverage changes Change-C
'    'Check for Dependent changes Change-C
'    DoCmd.OpenQuery "qrpt_EDI_ChangeSubsAA_DepCnts"
'    'DoCmd.OpenQuery "qrpt_EDI_ChangeSubsAA_DepSSN"
'    DoCmd.OpenQuery "qrpt_EDI_ChangeSubsAA_DepName"
'    'Check for Plan changes Change-D
'    DoCmd.OpenQuery "qrpt_EDI_ChangeSubsAA_PlanChange"
'    ' Check For Deleted
'    DoCmd.OpenQuery "qrpt_EDI_DELETED"
      
    DoCmd.OpenReport "rptAA_NewSubscribers", acViewPreview
    DoCmd.SetWarnings True

ExitProc:
  Exit Sub

HandleError:
  MsgBox "Error: " & Err.DESCRIPTION & _
     " (" & Err.Number & ")", vbExclamation
  Resume ExitProc
End Sub


Private Sub cmdPrintCards_Click()
   
    On Error GoTo PROC_ERR
    
'    Dim db As DAO.Database
'    Dim strSQL As String
'    Set db = CurrentDb()
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    'update mail card status
    ExecuteSQL ("UPDATE tmpEDI_Rpt Set tmpEDI_Rpt.GRMailCard = tblGrp.GRMailCard " & _
                    "FROM tmpEDI_Rpt INNER JOIN tblGrp ON tmpEDI_Rpt.GroupID = tblGrp.GroupID;")

   ' DoCmd.OpenQuery "qrpt_EDI_MailCard"
    'strSQL = "UPDATE DISTINCT tblSubscr INNER JOIN " &
'             "tmpEDI_Rpt ON tblSubscr.SUBssn = tmpEDI_Rpt." & _
'             "SUBssn SET tblSubscr.SUBcardPRT = Yes, tblSubscr." & _
'             "SUBcardPRTdte = Date();"
        
    DoCmd.OpenReport "rptCardMemAA", acViewPreview
    
    ExecuteSQL ("UPDATE tblSubscr SET tblSubscr.SUBcardPRT = 1, tblSubscr.SUBcardPRTdte = GetDate() " & _
                   "FROM tblSubscr INNER JOIN tmpEDI_Rpt ON tblSubscr.SUBssn = tmpEDI_Rpt.SUBssn;")

'    db.Execute strSQL, dbSeeChanges
'    db.Close
'    Set db = Nothing

PROC_EXIT:

    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
    Exit Sub

PROC_ERR:
    MsgBox Err.DESCRIPTION
    Resume PROC_EXIT
    'TVCodeTools ErrorHandlerEnd

End Sub


Private Sub cmdProcess_Click()

    On Error GoTo PROC_ERR
    
    Dim db As DAO.Database
    Set db = CurrentDb()

    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    ExecuteSQL ("DELETE FROM ELGEXP_SQL")
    DoCmd.OpenQuery "qappELGEXP_to_SQL"

    ExecuteSQL ("EXEC uspAA_Process")

    ReDim aQueries(0) As Variant

    aQueries(0) = "qappAllAmerican_EDI_Dep"
    
    If RunQuery("", aQueries()) = True Then
    
        ExecuteSQL ("EXEC uspUpdateAAImport")
    End If

    DoCmd.SetWarnings True
    DoCmd.Hourglass False

    MsgBox "The import was completed successfully.", vbInformation, "QCD: All American Import"

PROC_EXIT:
    Exit Sub

PROC_ERR:
    MsgBox Err.DESCRIPTION
    Resume PROC_EXIT
    
End Sub

Private Sub cmdClose_Click()
On Error GoTo Err_cmdClose_Click


    DoCmd.Close

Exit_cmdClose_Click:
    Exit Sub

Err_cmdClose_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_cmdClose_Click
    
End Sub

Private Sub cmdViewChanges_Click()
    
    On Error GoTo PROC_ERR
    
    Dim db As DAO.Database
    
    Set db = CurrentDb()

    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    ' move data from linked Access to SQL Server
    ExecuteSQL ("DELETE FROM ELGEXP_SQL")
    DoCmd.OpenQuery "qappELGEXP_to_SQL"
    
    
    ExecuteSQL ("EXEC uspAA_VarianceReport")
    
'    ReDim aQueries(0 To 19) As Variant
'    'subscriber checks
'    'aQueries(0) = "qappAA_NEWSubscr"
'    'aQueries(1) = "qappAA_DELSubscr"
'    aQueries(0) = "qappAA_SubscrChangedSSN"  'different SSN
'    aQueries(1) = "qappAA_SubscrGrpdiff"     'different group
'    aQueries(2) = "qappAA_SubscrRatediff"    'different rate
'    aQueries(3) = "qappAA_SubscrPlandiff"    'different QCD plan
'    aQueries(4) = "qappAA_SubscrFNdiff"      'different first name
'    aQueries(5) = "qappAA_SubscrLNdiff"      'different last name
'    aQueries(6) = "qappAA_SubscrMNdiff"      'different middle name
'    aQueries(7) = "qappAA_SubscrDOBdiff"      'different date of birth
'    aQueries(8) = "qappAA_SubscrGENDdiff"    'different gender
'    'aQueries(7) = "qappAA_SubscrEFFDdiff"    'different group effective date
'
'    aQueries(9) = "qappAA_SubscrEXISTdiff"    'different preexisting date
'    aQueries(10) = "qappAA_SubscrAddr1diff"   'different address 1
'    aQueries(11) = "qappAA_SubscrAddr2diff"  'different address 2
'    aQueries(12) = "qappAA_SubscrPhHMdiff"   'different home phone
'    aQueries(13) = "qappAA_SubscrPhWKdiff"   'different work phone
'
'    ' Dependent Checks
'    aQueries(14) = "qappAA_CntOfDEPdiff"     'different count of dependents
'    aQueries(15) = "qappAA_DepFNdiff"        'different first name
'    aQueries(16) = "qappAA_DepLNdiff"        'different last name
'    aQueries(17) = "qappAA_DepMNdiff"        'different middle name
'    aQueries(18) = "qappAA_DepRELdiff"       'different relationship
'    aQueries(19) = "qappAA_DepGENDdiff"      'different gender
'
'    If RunQuery("", aQueries()) = True Then
'
'    End If
'
    DoCmd.OpenReport "rptAA_VarianceReport", acViewPreview
    
PROC_EXIT:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub

PROC_ERR:
    MsgBox Err.DESCRIPTION
    Resume PROC_EXIT
End Sub