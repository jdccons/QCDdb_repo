Version =20
VersionRequired =20
Checksum =1995160516
Begin Form
    AutoCenter = NotDefault
    ScrollBars =2
    Width =7920
    ItemSuffix =123
    Left =5715
    Top =5235
    Right =14100
    Bottom =6930
    RecSrcDt = Begin
        0x17debe34a9b9e440
    End
    GUID = Begin
        0x91e05118a353504982abb6fad91418c3
    End
    NameMap = Begin
        0x0acc0e55000000000e2e55e6c55a1347ae39d5e5edd122c300000000c09d3129 ,
        0x16bbe440d0df3b1078e2661a740062006c0044006500700065006e0064006500 ,
        0x6e007400000000000000fee654027351874097f7472c521bcc74070000000e2e ,
        0x55e6c55a1347ae39d5e5edd122c3440065007000430061006e00630065006c00 ,
        0x6c006500640000000000000002fae80f3877a148923304e9a6ddcb7907000000 ,
        0x0e2e55e6c55a1347ae39d5e5edd122c349004400000000000000097c8f35ccfd ,
        0xa84a847fdf6c5f5c4621070000000e2e55e6c55a1347ae39d5e5edd122c35300 ,
        0x7500620049004400000000000000122318ceb0e8674d95677cf613d748950700 ,
        0x00000e2e55e6c55a1347ae39d5e5edd122c34400650070005300750062004900 ,
        0x4400000000000000d9a7da10eb043a4d86ca1a6c9647de24070000000e2e55e6 ,
        0xc55a1347ae39d5e5edd122c3440065007000530053004e0000000000000021f9 ,
        0x64ee74e8654ea7bd446b368cf5d7070000000e2e55e6c55a1347ae39d5e5edd1 ,
        0x22c3450049004d004200520049004400000000000000d00010b43326c942a72e ,
        0x47b18ce36a6c070000000e2e55e6c55a1347ae39d5e5edd122c3440065007000 ,
        0x460069007200730074004e0061006d0065000000000000009d5968e404da4b46 ,
        0x9dcb841a1e4d2c15070000000e2e55e6c55a1347ae39d5e5edd122c344006500 ,
        0x70004d006900640064006c0065004e0061006d0065000000000000000fd7eab5 ,
        0x4fc9bd47b122b86f1e8f8195070000000e2e55e6c55a1347ae39d5e5edd122c3 ,
        0x4400650070004c006100730074004e0061006d0065000000000000000cd47323 ,
        0xd1c69944802aebc874ad6072070000000e2e55e6c55a1347ae39d5e5edd122c3 ,
        0x44006500700044004f0042000000000000005864b0f9a66ee547993ac47d6452 ,
        0xd05b070000000e2e55e6c55a1347ae39d5e5edd122c344006500700041006700 ,
        0x65000000000000005f77aba9636bfc40901e93e1ebe41467070000000e2e55e6 ,
        0xc55a1347ae39d5e5edd122c3440065007000520065006c006100740069006f00 ,
        0x6e0073006800690070000000000000001f5121f8a3ab474b9e1f73ae47a29f9a ,
        0x070000000e2e55e6c55a1347ae39d5e5edd122c3440065007000470065006e00 ,
        0x6400650072000000000000002a16d7ff3c4aca40a23315172cefaa3a07000000 ,
        0x0e2e55e6c55a1347ae39d5e5edd122c344006500700045006600660044006100 ,
        0x74006500000000000000f8799fc18beaf64cb31ff1e177d86b63070000000e2e ,
        0x55e6c55a1347ae39d5e5edd122c3500072006500650078006900730074006900 ,
        0x6e006700440061007400650000000000000019918ca3fb50a546a6ef6f244cd7 ,
        0xae71070000000e2e55e6c55a1347ae39d5e5edd122c344006100740065004300 ,
        0x72006500610074006500640000000000000008e17ab981b5c044ab7daafd9ae6 ,
        0x0cb7070000000e2e55e6c55a1347ae39d5e5edd122c344006100740065005500 ,
        0x70006400610074006500640000000000000060a7ab38fd17794097bd3be1d331 ,
        0xff42070000000e2e55e6c55a1347ae39d5e5edd122c344006100740065004400 ,
        0x65006c006500740065006400000000000000d5b93f12db84544f923695962e50 ,
        0x78cb070000000e2e55e6c55a1347ae39d5e5edd122c35400720061006e007300 ,
        0x61006300740069006f006e00540079007000650000000000000082ab50fc9625 ,
        0x0443bbec63bc585ca85e070000000e2e55e6c55a1347ae39d5e5edd122c34300 ,
        0x7200650061007400650044006100740065000000000000000de643f27aaca441 ,
        0x80b42d2326c579bd070000000e2e55e6c55a1347ae39d5e5edd122c34d006f00 ,
        0x64006900660079004400610074006500000000000000544116962ab37448a9dd ,
        0x7a81d285be6f070000000e2e55e6c55a1347ae39d5e5edd122c3550073006500 ,
        0x72003000310000000000000080a785adbdc4d744ac3cc2ef3d00d99b07000000 ,
        0x0e2e55e6c55a1347ae39d5e5edd122c355007300650072003000320000000000 ,
        0x0000cda1e1ae929f7e409393a39d55849d70070000000e2e55e6c55a1347ae39 ,
        0xd5e5edd122c355007300650072003000330000000000000022423d76e385174d ,
        0x91077568c10979c2070000000e2e55e6c55a1347ae39d5e5edd122c355007300 ,
        0x650072003000340000000000000095041243f44efe4f93e4f516cd0b16640700 ,
        0x00000e2e55e6c55a1347ae39d5e5edd122c35500730065007200300035000000 ,
        0x0000000021caeb9917cf25449aa1af50b3995f7c070000000e2e55e6c55a1347 ,
        0xae39d5e5edd122c35500730065007200300036000000000000003ffe9fbc33a8 ,
        0x354996ae55e505586e81070000000e2e55e6c55a1347ae39d5e5edd122c35500 ,
        0x73006500720030003700000000000000d03588fe2bd80247a77d3602578e8cb6 ,
        0x070000000e2e55e6c55a1347ae39d5e5edd122c3550073006500720030003800 ,
        0x000000000000dbf691d05563054badc362780c2a602f070000000e2e55e6c55a ,
        0x1347ae39d5e5edd122c3550073006500720030003900000000000000acd8f362 ,
        0xf764944495f3d7575fedd472070000000e2e55e6c55a1347ae39d5e5edd122c3 ,
        0x55007300650072004e0061006d006500000000000000b8ea4d8a033ef7499e73 ,
        0xaf24ed04fe03070000000e2e55e6c55a1347ae39d5e5edd122c3440061007400 ,
        0x65004d006f00640069006600690065006400000000000000048b35dd36da2e40 ,
        0x8c43c052f62572d7070000000e2e55e6c55a1347ae39d5e5edd122c347005500 ,
        0x49004400000000000000000000000000000000000000000000000c0000000300 ,
        0x00000000000000000000000000000000
    End
    RecordSource ="SELECT DISTINCTROW tblDependent.ID, tblDependent.SubID, tblDependent.DepSubID, t"
        "blDependent.DepSSN, tblDependent.EIMBRID, tblDependent.DepFirstName, tblDependen"
        "t.DepMiddleName, tblDependent.DepLastName, tblDependent.DepCancelled, tblDepende"
        "nt.DepDOB, tblDependent.DepAge, tblDependent.DepRelationship, tblDependent.DepGe"
        "nder, tblDependent.DepEffDate, tblDependent.PreexistingDate, tblDependent.DateCr"
        "eated, tblDependent.DateUpdated, tblDependent.DateDeleted, tblDependent.Transact"
        "ionType, tblDependent.CreateDate, tblDependent.ModifyDate, tblDependent.User01, "
        "tblDependent.User02, tblDependent.User03, tblDependent.User04, tblDependent.User"
        "05, tblDependent.User06, tblDependent.User07, tblDependent.User08, tblDependent."
        "User09, tblDependent.UserName, tblDependent.DateModified, tblDependent.GUID FROM"
        " tblDependent WHERE (((tblDependent.DepCancelled) In (1,2))) ORDER BY tblDepende"
        "nt.DepLastName, tblDependent.DepFirstName; "
    BeforeUpdate ="[Event Procedure]"
    PrtMip = Begin
        0x000000000000000000000000000000000000000033180000f000000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00cc0353ef800101000100ea0a6f08640001000f00b00402000100 ,
        0xb004030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x000010270000000000000000f800cc0300000000000000000000000000000000 ,
        0x00000000000000000200000000000000000010005c4b03006843040000000000 ,
        0x000000000000000000000000000000000000000000000000c7a88e3205000000 ,
        0x0300ff0001000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x01000000000000000000000000000000f8000000534d544a000000001000e800 ,
        0x5400500020005000530020004400720069007600650072002000410043003100 ,
        0x3400410036004200350043004600330032003400660032003900420039004100 ,
        0x3200410041003400340044003700320033004200450039003700000050616765 ,
        0x53697a650041340050616765526567696f6e0000496e707574536c6f74004465 ,
        0x6661756c74005265736f6c7574696f6e003735647069004475706c6578004e6f ,
        0x6e65000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000
    End
    PrtDevNames = Begin
        0x0800220048000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000545332303200
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin ComboBox
            SpecialEffect =2
        End
        Begin FormHeader
            Height =240
            BackColor =12632256
            Name ="FormHeader1"
            GUID = Begin
                0xea30a426f158b443869b0285987ca7fe
            End
            Begin
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =2
                    Left =30
                    Width =1260
                    Height =240
                    FontWeight =700
                    BackColor =-2147483633
                    Name ="Text108"
                    Caption ="Social Sec. # "
                    GUID = Begin
                        0xd7a1ba3f7b28bb4f98cb6624ca6e9739
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =85
                    TextAlign =2
                    Left =3120
                    Width =1020
                    Height =240
                    FontWeight =700
                    BackColor =-2147483633
                    Name ="Text109"
                    Caption ="First Name"
                    GUID = Begin
                        0xe82baba7135a854998187a363779edf9
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =215
                    TextAlign =2
                    Left =1245
                    Width =975
                    Height =240
                    FontWeight =700
                    BackColor =-2147483633
                    Name ="Text110"
                    Caption ="Last Name"
                    GUID = Begin
                        0xba593b081e3ee842bb2fc7112e5e4af7
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =85
                    TextAlign =2
                    Left =5160
                    Width =885
                    Height =240
                    FontWeight =700
                    BackColor =-2147483633
                    Name ="Text111"
                    Caption ="DOB"
                    GUID = Begin
                        0xadf5b1ff9399f14b87621ba3021ecb67
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =85
                    TextAlign =2
                    Left =4710
                    Width =435
                    Height =240
                    FontWeight =700
                    BackColor =-2147483633
                    Name ="Text115"
                    Caption ="MI"
                    GUID = Begin
                        0x6fd9a163e4a823478a09c248dabacdc3
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =85
                    TextAlign =1
                    Left =6192
                    Width =450
                    Height =240
                    FontWeight =700
                    BackColor =-2147483633
                    Name ="Label121"
                    Caption ="Gen"
                    GUID = Begin
                        0x1d50e2a4f7739944a8c478f52e6136f9
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =85
                    TextAlign =2
                    Left =6768
                    Width =1005
                    Height =240
                    FontWeight =700
                    BackColor =-2147483633
                    Name ="Label122"
                    Caption ="Relation"
                    GUID = Begin
                        0x394e92c69a73ac41af2cc25560f03ac9
                    End
                End
            End
        End
        Begin Section
            Height =240
            BackColor =12632256
            Name ="Detail0"
            GUID = Begin
                0x21e3efe2d1eb9c40a7b8f37f3d64cd98
            End
            Begin
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =85
                    TextAlign =1
                    Left =15
                    Width =1149
                    Name ="DEPssn"
                    ControlSource ="DEPssn"
                    InputMask ="000\\-00\\-0000;;_"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x64b8c779d4f9f6489171e68f8154f4ab
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =85
                    TextAlign =1
                    Left =3105
                    Width =1584
                    TabIndex =2
                    Name ="DEPfirstNAME"
                    ControlSource ="DEPfirstNAME"
                    GUID = Begin
                        0x126b5a7406c39949b99aea15237427cd
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =93
                    TextAlign =1
                    Left =1200
                    Width =1869
                    TabIndex =1
                    Name ="DEPlastNAME"
                    ControlSource ="DEPlastNAME"
                    GUID = Begin
                        0x136b706ddaab014e940ec094af01a09c
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =85
                    TextAlign =1
                    Left =5190
                    Width =984
                    TabIndex =4
                    Name ="DEPdob"
                    ControlSource ="DEPdob"
                    Format ="m/d/yyyy"
                    ValidationRule ="Is Not Null"
                    ValidationText ="You must populate the dependent DOB field."
                    BeforeUpdate ="[Event Procedure]"
                    InputMask ="99/99/0000;0;_"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x4fd637183bf6b848955cbc8a4846477e
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =247
                    TextAlign =1
                    Left =2223
                    Width =864
                    TabIndex =5
                    Name ="DEPsubID"
                    ControlSource ="DEPsubID"
                    GUID = Begin
                        0xfffd0f9770c52c42a91f75659600571e
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =85
                    TextAlign =1
                    Left =4725
                    Width =429
                    TabIndex =3
                    Name ="DEPmiddleNAME"
                    ControlSource ="DEPmiddleNAME"
                    GUID = Begin
                        0x340e3bc6aaa59a488593c6ccfaf07f73
                    End
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    ColumnCount =2
                    ListWidth =504
                    Left =6192
                    Width =813
                    TabIndex =6
                    GUID = Begin
                        0x345a7f9792574d48a79d68c426ced311
                    End
                    Name ="DEPgender"
                    ControlSource ="DEPgender"
                    RowSourceType ="Value List"
                    RowSource ="F;\"Female\";M;\"Male\""
                    ColumnWidths ="0;360"
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    ColumnCount =2
                    ListWidth =1080
                    Left =7020
                    Width =864
                    TabIndex =7
                    GUID = Begin
                        0x873df46da0e5f74d9db0887b9f0a5f78
                    End
                    Name ="DEPrelationship"
                    ControlSource ="DEPrelationship"
                    RowSourceType ="Value List"
                    RowSource ="S;\"Spouse\";C;\"Child\";O;\"Other\""
                    ColumnWidths ="0;1080"
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="FormFooter2"
            GUID = Begin
                0x879862bc9ecba84987a4e3e8b980cb23
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

' group types
Private Const conQCDOnlyGrp As Integer = 1
Private Const conAllAmGrp As Integer = 4
Private Const conIndivGrp As Integer = 9
'------------------------------
' subform for dependents
' processes dependents for group members
' in both AA and QCDOnly groups
'
' Required Data:
'   SubID
'   EIMBRID
'   DateCreated
'   DateUpdated
'   DateDeleted
'   TransactionType
'   UserName
'
'
'
'------------------------------
Private Sub DEPdob_BeforeUpdate(Cancel As Integer)
    If ValidateDateFormat(Me.DEPdob) = False Then
        MsgBox "Please correct the Date of Birth...it is not in the proper range." & vbCrLf & strMsg, vbCritical, "Validation Failed"
        Cancel = True
    End If
End Sub

Private Sub DEPdob_Click()

On Error GoTo ErrorHandler
    
    With Me!DEPdob
        .SetFocus
        .SelStart = 0
    End With

Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub

Private Sub DEPssn_Click()

    On Error GoTo ErrorHandler
    
    With Me!DEPssn
        .SetFocus
        .SelStart = 0
    End With

Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub
Private Sub Form_BeforeUpdate(Cancel As Integer)
        
On Error GoTo ErrorHandler


    ' populate default controls with data
        ' TransactionType
        ' DateCreated
        ' UserName
        ' DepCancelled
    If Me.NewRecord Then
        With Me
            .SubID = Forms![frmGrpSubscr]![SubID]
            .TransactionType = "ADDED"
            .DateCreated = Now
            .UserName = GetCurrentUserName
            .DepCancelled = 1
            .User01 = "Form_fsubGrpSubscrDep"
        End With
    Else
        With Me
            .SubID = Forms![frmGrpSubscr]![SubID]
            .TransactionType = "UPDATED"
            .DateUpdated = Now
            .UserName = GetCurrentUserName()
            .DepCancelled = 1
            .User01 = "Form_fsubGrpSubscrDep"
        End With
    End If
 
    'check to make sure the relationship for the dependent has been populated
    If IsNull(Forms!frmGrpSubscr!fsubGrpSubscrDep![DepRelationship]) = True Then
        MsgBox "You must populate the Relationship field."
        Cancel = True
        Forms!frmGrpSubscr!fsubGrpSubscrDep![DepRelationship].SetFocus
        GoTo Exit_Point
    End If
    
    'check to make sure the gender for the dependent has been populated
    If IsNull(Forms!frmGrpSubscr!fsubGrpSubscrDep![DepGender]) = True Then
        MsgBox "You must populate the Gender field."
        Cancel = True
        Forms!frmGrpSubscr![DepGender].SetFocus
        GoTo Exit_Point
    End If
            
Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    GoTo Exit_Point
        
End Sub

Private Sub Form_Load()

On Error GoTo ErrorHandler
    
    Dim intGroupType As Integer
    intGroupType = Nz(Forms![frmGrp]![optgrpGroupType], 0)
    If intGroupType = conAllAmGrp Then
        Call LockControls(Me, True)
    Else
        Call LockControls(Me, False)
    End If
    
Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    GoTo Exit_Point
        
End Sub