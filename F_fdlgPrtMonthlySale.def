Version =20
VersionRequired =20
Checksum =-59979918
Begin Form
    Modal = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    BorderStyle =1
    Width =6054
    ItemSuffix =21
    Left =4056
    Top =1440
    Right =8040
    Bottom =6228
    RecSrcDt = Begin
        0xa7cedeb3b2c4e140
    End
    Caption ="Print Monthly Sales Report"
    MenuBar ="Dialog"
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    Begin
        Begin CommandButton
            TextFontFamily =2
        End
        Begin FormHeader
            Height =0
            BackColor =12632256
            Name ="FormHeader1"
            GUID = Begin
                0x1d582abce26492478c1cef111e2467bd
            End
        End
        Begin Section
            Height =3821
            BackColor =12632256
            Name ="Detail0"
            GUID = Begin
                0x619cfd7976318d4489756343f6a66629
            End
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =82
                    Left =3030
                    Top =2865
                    Width =717
                    Height =403
                    TabIndex =4
                    Name ="PreviewButton"
                    Caption ="Print Preview&R"
                    StatusBarText ="Preview Report"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000017000000160000000100040000000000080100000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888889888888888888888888888884 ,
                        0x88888888888888888888888388888888888888888888888e8888000000000000 ,
                        0x8800888288880ffffffffff08000888d88880fffffff00007008888888880fff ,
                        0xfff078870788888588880fffff0788f77088888288880fffff08888780888884 ,
                        0x88880fffff08f8878088888888880fffff07ff877088888088880ffffff07887 ,
                        0x0888888088880fffffff00008888888088880ffffffffff08888888088880fff ,
                        0xffff00008888888088880fffffff08088888888188880fffffff008888888886 ,
                        0x8888000000000888888888808888888888888888888888808888888888888888 ,
                        0x8888888088888888888888888888888000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                    GUID = Begin
                        0xc452d95259db7c479d8c927a9d58caf6
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =3
                    Left =1017
                    Top =720
                    Width =2010
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text8"
                    Caption ="Invoice Month: "
                    GUID = Begin
                        0x8fe839d7267a934087b320d005bca506
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =87
                    Left =3033
                    Top =720
                    Width =438
                    FontSize =10
                    Name ="InvMonth"
                    GUID = Begin
                        0xaa8913e70d95e841a1f950d7e5ed419d
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =3
                    Left =1017
                    Top =1080
                    Width =2010
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text11"
                    Caption ="Invoice Year: "
                    GUID = Begin
                        0x120a13f6a30ec844b5a32f994d181d9e
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =95
                    Left =3033
                    Top =1080
                    Width =573
                    FontSize =10
                    TabIndex =1
                    Name ="InvYear"
                    GUID = Begin
                        0x87752285c4aa7840bc9529ee810000f0
                    End
                End
                Begin Label
                    OverlapFlags =87
                    TextAlign =1
                    Left =3615
                    Top =1080
                    Width =2400
                    Height =240
                    BackColor =12632256
                    Name ="Text19"
                    Caption ="Enter four-digit year (e.g., 1996)"
                    GUID = Begin
                        0x6d741b1c0c29614c94ffc7510021cd5c
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =3
                    Left =675
                    Top =1440
                    Width =2415
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text15"
                    Caption ="Geographical Count From:  "
                    GUID = Begin
                        0x6590ff2277e9c34ca038101a897cafc9
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =3
                    Left =729
                    Top =1800
                    Width =2295
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text20"
                    Caption =" To:  "
                    GUID = Begin
                        0x93a3395dd1b5a249908d8f1ccbf502eb
                    End
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    SpecialEffect =2
                    OverlapFlags =215
                    ColumnCount =2
                    ListWidth =3670
                    Left =3033
                    Top =1440
                    Width =1000
                    TabIndex =2
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"10\""
                    GUID = Begin
                        0x9f3aa1e92c4aa248a713aed88a297706
                    End
                    Name ="c-GEOfrom"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tblGeographical.GEOid AS Geo_ID, tblGeographical.GEOdesc AS Geo_Descripti"
                        "on FROM tblGeographical ORDER BY tblGeographical.GEOid;"
                    ColumnWidths ="915;2505"
                    EventProcPrefix ="c_GEOfrom"
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    SpecialEffect =2
                    OverlapFlags =87
                    ColumnCount =2
                    ListWidth =3670
                    Left =3033
                    Top =1800
                    Width =1000
                    TabIndex =3
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"10\""
                    GUID = Begin
                        0x44c3c3e211cf9c4a9b7fb621e9e315f9
                    End
                    Name ="c-GEOto"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tblGeographical.GEOid AS Geo_ID, tblGeographical.GEOdesc AS Geo_Descripti"
                        "on FROM tblGeographical ORDER BY tblGeographical.GEOid;"
                    ColumnWidths ="915;2505"
                    EventProcPrefix ="c_GEOto"
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="FormFooter2"
            GUID = Begin
                0x370f7b14a72bcc429cbee82cf9e111f2
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit

Private Sub PreviewButton_Click()

  On Error GoTo PROC_ERR
  
    Dim strWhere As String
    Dim strInvMonth As String
    Dim strInvYear As String
    Dim strData As String
    strData = "qrptMonthlySale"
    
    Me.Visible = False
    
    If IsNull([InvMonth]) Then
        Me.Visible = True
        MsgBox "You must enter an Invoice Month!"
    Exit Sub
    End If

    If IsNull([c-GEOfrom]) Or IsNull([c-GEOto]) Then
        Me.Visible = True
        MsgBox "You must enter a Geo ID!"
    Exit Sub
    End If


    If Not IsNull([InvMonth]) Then
    strInvMonth = Me![InvMonth]
    End If


    If IsNull([InvYear]) Then
        Me.Visible = True
        MsgBox "You must enter an Invoice Year!"
    Exit Sub
    End If

    If Not IsNull([InvYear]) Then
    strInvYear = Me![InvYear]
    End If


    strWhere = "[DOCmonth] = " & strInvMonth & " and [DocYear] = '" & strInvYear & "' "
    strWhere = strWhere & " AND [GRGeoID] BETWEEN '" & Me![c-GEOfrom] & "' AND '" & Me![c-GEOto] & "'"
  
  
    If DCount("*", strData, strWhere) = 0 Then
        MsgBox "The criteria you have chosen has resulted in no records." & vbCrLf & vbCrLf & "Please make another criteria selection and try again!"
        DoCmd.Hourglass False
        Me.Visible = True
    Exit Sub
    
    Else
     DoCmd.OpenReport "rptMonthlySale", A_PREVIEW, , strWhere
    End If
    


  Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub