Version =20
VersionRequired =20
Checksum =1207618120
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    DefaultView =0
    ScrollBars =0
    BorderStyle =1
    Width =10230
    ItemSuffix =122
    Left =2490
    Top =930
    Right =12720
    Bottom =6990
    RecSrcDt = Begin
        0x23d119fd4ca4e240
    End
    RecordSource ="qfrmInvGrp"
    Caption ="Invoice Entry - Group (Mixed Only)"
    AfterUpdate ="[Event Procedure]"
    MenuBar ="FormMenuBar"
    PrtMip = Begin
        0xd002000038040000d0020000d002000000000000a02900004029000001000000 ,
        0x010000006801000000000000a10700000100000000000000
    End
    PrtDevMode = Begin
        0x4f6b6964617461204f4c343030650045300e11000000ea0000005f019ee0821c ,
        0x0a030c0344004c0003670000010001004552004c0072010001002c0101000100 ,
        0x2c010200f001e85d01000000606024e022e000000c0001000000010064000200 ,
        0x000600000000000000006060806a0000000000000000ffff0000ffffffffffff ,
        0xffff000000000000ffff00000000ffff49434515001244455649434543415041 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x170008001e0001804f6b6964617461204f4c34303065004f4c34303065004c50 ,
        0x54313a0000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000
    End
    Begin
        Begin CommandButton
            TextFontFamily =2
        End
        Begin FormHeader
            Height =0
            BackColor =12632256
            Name ="FormHeader0"
        End
        Begin Section
            CanGrow = NotDefault
            Height =5400
            BackColor =12632256
            Name ="Detail Section"
            EventProcPrefix ="Detail_Section"
            Begin
                Begin ComboBox
                    SpecialEffect =2
                    OverlapFlags =93
                    ColumnCount =2
                    ListWidth =3925
                    Left =1470
                    Top =165
                    Width =1008
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"10\""
                    Name ="CUST KEY"
                    ControlSource ="CUST KEY"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT qryGrpCombo_Ins.GROUPid, qryGrpCombo_Ins.GRname FROM qryGrpCombo_Ins;"
                    ColumnWidths ="750;2925"
                    AfterUpdate ="[Event Procedure]"
                    EventProcPrefix ="CUST_KEY"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =180
                    Top =435
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text5"
                    Caption ="Group Name: "
                End
                Begin Label
                    OverlapFlags =95
                    TextAlign =3
                    Left =180
                    Top =675
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text6"
                    Caption =" Address: "
                End
                Begin Label
                    OverlapFlags =95
                    TextAlign =3
                    Left =180
                    Top =915
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text7"
                    Caption ="Address 2: "
                End
                Begin Label
                    OverlapFlags =95
                    TextAlign =3
                    Left =180
                    Top =1155
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text8"
                    Caption ="City: "
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =3
                    Left =780
                    Top =1365
                    Width =651
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text9"
                    Caption ="State: "
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =1920
                    Top =1380
                    Width =471
                    Height =225
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text10"
                    Caption ="Zip: "
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =95
                    Left =1470
                    Top =420
                    Width =2466
                    TabIndex =1
                    Name ="CUST NAME"
                    ControlSource ="CUST NAME"
                    EventProcPrefix ="CUST_NAME"
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =95
                    Left =1470
                    Top =660
                    Width =2463
                    TabIndex =2
                    Name ="ADDRESS 1"
                    ControlSource ="ADDRESS 1"
                    EventProcPrefix ="ADDRESS_1"
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =95
                    Left =1470
                    Top =900
                    Width =2463
                    TabIndex =3
                    Name ="ADDRESS 2"
                    ControlSource ="ADDRESS 2"
                    EventProcPrefix ="ADDRESS_2"
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =95
                    Left =1470
                    Top =1140
                    Width =1728
                    TabIndex =4
                    Name ="CITY"
                    ControlSource ="CITY"
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =95
                    Left =1470
                    Top =1380
                    Width =432
                    Height =225
                    TabIndex =5
                    Name ="STATE"
                    ControlSource ="STATE"
                End
                Begin TextBox
                    DecimalPlaces =0
                    SpecialEffect =2
                    OverlapFlags =95
                    Left =2385
                    Top =1395
                    Width =1008
                    Height =210
                    TabIndex =6
                    Name ="ZIP CODE"
                    ControlSource ="ZIP CODE"
                    InputMask ="00000\\-9999;;_"
                    EventProcPrefix ="ZIP_CODE"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =3
                    Left =165
                    Top =1635
                    Width =1281
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text65"
                    Caption ="Attn: "
                End
                Begin TextBox
                    DecimalPlaces =0
                    SpecialEffect =2
                    OverlapFlags =87
                    Left =1470
                    Top =1620
                    Width =2448
                    TabIndex =7
                    Name ="ATTENTION"
                    ControlSource ="ATTENTION"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =3
                    Left =5070
                    Top =120
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text67"
                    Caption ="Invoice No: "
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    SpecialEffect =2
                    OverlapFlags =93
                    Left =6480
                    Top =105
                    Width =1020
                    TabIndex =8
                    BackColor =12632256
                    Name ="TRANS NO"
                    ControlSource ="TRANS NO"
                    EventProcPrefix ="TRANS_NO"
                End
                Begin Label
                    OverlapFlags =95
                    TextAlign =3
                    Left =5070
                    Top =360
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text69"
                    Caption ="Invoice Date: "
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =95
                    TextAlign =1
                    Left =6480
                    Top =345
                    Width =1020
                    TabIndex =9
                    Name ="INV DATE"
                    ControlSource ="INV DATE"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0000;0;_"
                    EventProcPrefix ="INV_DATE"
                End
                Begin Label
                    OverlapFlags =95
                    TextAlign =3
                    Left =5070
                    Top =600
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text71"
                    Caption ="Comm Ovrd: "
                End
                Begin TextBox
                    DecimalPlaces =0
                    SpecialEffect =2
                    OverlapFlags =95
                    Left =6480
                    Top =585
                    Width =1020
                    TabIndex =10
                    Name ="COMM OVRD"
                    ControlSource ="COMM OVRD"
                    EventProcPrefix ="COMM_OVRD"
                End
                Begin Label
                    OverlapFlags =95
                    TextAlign =3
                    Left =5070
                    Top =840
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text73"
                    Caption ="Territory/GEO: "
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    DecimalPlaces =0
                    SpecialEffect =2
                    OverlapFlags =95
                    Left =6480
                    Top =825
                    Width =1020
                    TabIndex =11
                    BackColor =12632256
                    Name ="TERRITORY KEY"
                    ControlSource ="TERRITORY KEY"
                    EventProcPrefix ="TERRITORY_KEY"
                End
                Begin Subform
                    OverlapFlags =85
                    Left =1470
                    Top =1920
                    Width =6669
                    Height =3420
                    TabIndex =12
                    Name ="fsubInvGrp"
                    SourceObject ="Form.fsubInvGrp"
                    LinkChildFields ="DOCUMENT NO"
                    LinkMasterFields ="TRANS NO"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =4065
                    Top =300
                    Width =900
                    Height =705
                    FontSize =8
                    TabIndex =13
                    Name ="btnCreateInvoice"
                    Caption ="Create Single Invoice"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =3
                    Left =195
                    Top =165
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text102"
                    Caption ="Group Name: "
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =93
                    TextAlign =1
                    Left =7530
                    Top =1095
                    Width =1830
                    TabIndex =14
                    BackColor =12632256
                    Name ="AGENT1 NAME"
                    ControlSource ="=DLookUp(\"[AGENT_LUname]\",\"tblAgent\",\"[AGENTid] = Forms![frmInvGrp_Ins]![SA"
                        "LESP    KEY]\")"
                    EventProcPrefix ="AGENT1_NAME"
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =95
                    TextAlign =1
                    Left =7530
                    Top =1335
                    Width =1830
                    TabIndex =15
                    BackColor =12632256
                    Name ="AGENT2 NAME"
                    ControlSource ="=DLookUp(\"[AGENT_LUname]\",\"tblAgent\",\"[AGENTid] = Forms![frmInvGrp_Ins]![SP"
                        "ARE3]\")"
                    EventProcPrefix ="AGENT2_NAME"
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =93
                    TextAlign =1
                    Left =7515
                    Top =825
                    Width =2685
                    TabIndex =16
                    BackColor =12632256
                    Name ="TERRITORY NAME"
                    ControlSource ="=DLookUp(\"[GEODESC]\",\"tblGeographical\",\"[GEOid] = Forms![frmInvGrp_ins]![TE"
                        "RRITORY KEY]\")"
                    EventProcPrefix ="TERRITORY_NAME"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =4065
                    Top =1155
                    Width =900
                    Height =705
                    FontSize =8
                    TabIndex =17
                    Name ="Bulk Invoices"
                    Caption ="Create Batch Invoices"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    EventProcPrefix ="Bulk_Invoices"
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    SpecialEffect =2
                    OverlapFlags =85
                    Left =7575
                    Top =105
                    Width =1020
                    Height =216
                    TabIndex =18
                    BackColor =65535
                    Name ="txtSYSDOCID"
                    ControlSource ="SYSDOCID"
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    SpecialEffect =2
                    OverlapFlags =85
                    Left =7575
                    Top =390
                    Width =1020
                    Height =216
                    TabIndex =19
                    BackColor =65535
                    Name ="txtRecUserID"
                    ControlSource ="RecUserID"
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    SpecialEffect =2
                    OverlapFlags =85
                    Left =8730
                    Top =105
                    Width =1020
                    Height =216
                    TabIndex =20
                    BackColor =65535
                    Name ="txtRecTime"
                    ControlSource ="RecTime"
                    Format ="Long Time"
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    SpecialEffect =2
                    OverlapFlags =85
                    Left =8730
                    Top =390
                    Width =1020
                    Height =216
                    TabIndex =21
                    BackColor =65535
                    Name ="txtRecDate"
                    ControlSource ="RecDate"
                    Format ="Short Date"
                End
                Begin Subform
                    Locked = NotDefault
                    OverlapFlags =247
                    SpecialEffect =2
                    Left =5085
                    Top =1080
                    Width =4710
                    Height =795
                    TabIndex =22
                    Name ="sfrmAgentsAA"
                    SourceObject ="Form.sfrmAgentsAA"
                    LinkChildFields ="GROUPid"
                    LinkMasterFields ="CUST KEY"
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    SpecialEffect =2
                    OverlapFlags =119
                    Left =7575
                    Top =630
                    Width =1020
                    Height =216
                    TabIndex =23
                    BackColor =65535
                    Name ="CUST CLASS"
                    ControlSource ="CUST CLASS"
                    EventProcPrefix ="CUST_CLASS"
                End
            End
        End
        Begin FormFooter
            Height =675
            BackColor =12632256
            Name ="FormFooter1"
            Begin
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =93
                    Left =6540
                    Top =90
                    Width =1332
                    Name ="INVOICE TOTAL"
                    ControlSource ="=[fsubInvGrp].[Form]![SubTotal]"
                    Format ="$#,##0.00;($#,##0.00)"
                    EventProcPrefix ="INVOICE_TOTAL"
                End
                Begin Label
                    OverlapFlags =87
                    TextAlign =3
                    Left =5190
                    Top =90
                    Width =1335
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text92"
                    Caption ="Invoice Total: "
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =195
                    Top =30
                    Width =576
                    Height =471
                    TabIndex =1
                    Name ="Button160"
                    Caption ="Button160"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8800888888800888800000008800888888000888840000008800888880000888 ,
                        0x8004322688008888000008888040e26288008880000008888440366688008800 ,
                        0x000008888111a3338800888000000888899deaee8800888800000888888caaaa ,
                        0x8800888880000888811133228800888888000888811909108800888888800888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =765
                    Top =30
                    Width =576
                    Height =471
                    TabIndex =2
                    Name ="Button161"
                    Caption ="Button161"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8888888800888888800000008888888000888888840000008888880000888888 ,
                        0x8004322688888000008888888040e26288880000008888888440366688800000 ,
                        0x008888888111a3338888000000888888899deaee8888800000888888888caaaa ,
                        0x8888880000888888811133228888888000888888811909108888888800888888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =93
                    Left =2700
                    Top =45
                    Width =576
                    Height =471
                    TabIndex =3
                    Name ="Button162"
                    Caption ="Button162"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8888800888888888800000008888800088888888840000008888800008888888 ,
                        0x8004322688888000008888888040e26288888000000888888440366688888000 ,
                        0x000088888111a3338888800000088888899deaee8888800000888888888caaaa ,
                        0x8888800008888888811133228888800088888888811909108888800888888888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =93
                    Left =3270
                    Top =45
                    Width =576
                    Height =471
                    TabIndex =4
                    Name ="Button163"
                    Caption ="Button163"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x28000000110000000f0000000100040000000000b40000000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888888888888888888888880000000 ,
                        0x8800888888800888800000008800088888800888840000008800008888800888 ,
                        0x8004322688000008888008888040e26288000000888008888440366688000000 ,
                        0x088008888111a3338800000088800888899deaee8800000888800888888caaaa ,
                        0x8800008888800888811133228800088888800888811909108800888888800888 ,
                        0x8ff865f088888888888888888f8765f088888888888888888f0865f000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000000000000000000000000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =93
                    TextAlign =2
                    Left =1365
                    Top =165
                    Width =1320
                    Height =195
                    FontWeight =700
                    TabIndex =5
                    Name ="txtRecordNumber"
                End
                Begin Line
                    LineSlant = NotDefault
                    BorderWidth =1
                    OverlapFlags =85
                    Left =5220
                    Top =360
                    Width =2640
                    Height =15
                    Name ="Line97"
                End
                Begin Line
                    LineSlant = NotDefault
                    BorderWidth =1
                    OverlapFlags =85
                    Left =5220
                    Top =390
                    Width =2640
                    Height =15
                    Name ="Line98"
                End
                Begin CommandButton
                    OverlapFlags =247
                    TextFontFamily =34
                    Left =2580
                    Top =45
                    Width =1221
                    Height =576
                    FontSize =8
                    TabIndex =6
                    Name ="btnPostPlt"
                    Caption ="Post This\015\012Inv to Plt"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                End
                Begin CommandButton
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =3810
                    Top =45
                    Width =1221
                    Height =576
                    FontSize =8
                    TabIndex =7
                    Name ="btnPostAlltoPlat"
                    Caption ="Post All\015\012 Invs to  Plt"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons

Option Explicit

'Declare module level global variables

Dim mStrCustKey$

Private Sub AGENT1_AfterUpdate()

  On Error GoTo PROC_ERR
    Dim dbsDb As Database
    Dim rstRsAgents As DAO.Recordset
    Dim rstRsGroup As DAO.Recordset

    Dim strAgent1ID As String
    Dim varStrGroupID
    Dim strWhereAgent As String
    Dim strWhereGroup As String

    strAgent1ID = Me![AGENT1]
    varStrGroupID = Me![CUST KEY]

    strWhereAgent = "[AGENTid] = '" & strAgent1ID & "'"
    strWhereGroup = "[GroupID] = '" & varStrGroupID & "'"

    Set dbsDb = DBEngine(0)(0)
    Set rstRsAgents = dbsDb.OpenRecordset("tblAgent", dbOpenDynaset, dbSeeChanges)
    Set rstRsGroup = dbsDb.OpenRecordset("tblGrp", dbOpenDynaset, dbSeeChanges)

    rstRsAgents.FindFirst strWhereAgent

    rstRsGroup.FindFirst strWhereGroup
    Me![AGENT1 RATE] = rstRsGroup("GRagentRATE1")

    rstRsAgents.Close
    rstRsGroup.Close
    dbsDb.Close

    Me.Requery

  Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub

Private Sub AGENT2_AfterUpdate()
  On Error GoTo PROC_ERR
    Dim dbsDb As Database
    Dim rstRsAgents As DAO.Recordset
    Dim rstRsGroup As DAO.Recordset

    Dim strAgent2ID As String
    Dim varStrGroupID
    Dim strWhereAgent As String
    Dim strWhereGroup As String

    strAgent2ID = Me![AGENT2]
    varStrGroupID = Me![CUST KEY]

    strWhereAgent = "[AGENTid] = '" & strAgent2ID & "'"
    strWhereGroup = "[GroupID] = '" & varStrGroupID & "'"

    Set dbsDb = DBEngine(0)(0)
    Set rstRsAgents = dbsDb.OpenRecordset("tblAgent", dbOpenDynaset, dbSeeChanges)
    Set rstRsGroup = dbsDb.OpenRecordset("tblGrp", dbOpenDynaset, dbSeeChanges)

    rstRsAgents.FindFirst strWhereAgent

    rstRsGroup.FindFirst strWhereGroup
    Me![AGENT2 RATE] = rstRsGroup("GRagentRATE2")

    rstRsAgents.Close
    rstRsGroup.Close
    dbsDb.Close

    Me.Requery


  Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub


Private Sub btnCreateInvoice_Click()
'Purpose:  Populate subform with subscriber information
'Progammer:  Suzanne Johnsen
'Date Created:  9/21/99
'Date Updated:
'Updated By:

    On Error GoTo PROC_ERR
    
    DoCmd.SetWarnings False
    DoCmd.OpenQuery "qryPopInvGrpDet_Ins"
    Me.Refresh
    DoCmd.SetWarnings True
    
    Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub
Private Sub btnPostAlltoPlat_Click()
'Purpose:  Posts all mixed group invoices to Platinum
'Programmer:  Tim Cook
'Date Created:  1/31/02
'Updated by:  John Criswell
'Date Updated:  5/19/2005

  On Error GoTo PROC_ERR
          
        Dim db As DAO.Database
        Dim rs As DAO.Recordset
        Dim strSQL As String
                          
        DoCmd.Hourglass True
        DoCmd.SetWarnings False
       
        'check to see if any invoices being posted have already been posted before
        If AreAnyInvoicesInPlat() Then
            MsgBox "One or more of the invoices you are trying to post already exist in Platinum.  Please remove from Platinum and start over."""
            GoTo PROC_EXIT
        End If
        
        Set db = CurrentDb()
        
        ' Populate the Haney Export Table
        DoCmd.OpenQuery "qdelHaneyExport"
        DoCmd.OpenQuery "qappPost_Haney_All"
        
        ' Output the Haney File
        DoCmd.TransferSpreadsheet acExport, 8, "tblHaneyExport", "P:\QCDdb\Haney_Ex.XLS", True
               
        'invoices in tblInvHdr?
        strSQL = "SELECT DISTINCTROW tblInvHdr.[CUST KEY], tblInvHdr.[TRANS NO] FROM tblInvHdr;"
        
        ' Create snapshot-type recordset object.
        Set rs = db.OpenRecordset(strSQL, dbOpenSnapshot)
        If rs.RecordCount > 0 Then
           'insert header records into PfW
           DoCmd.OpenQuery "qappPostPltHdr_Ins_all"
                            
            'Check Platinum to insure data was transferred correctly
            If DidAllInvoicesPosttoPlat() Then
                'nothing
            Else
                MsgBox "At least one invoice did not post to Platinum."
                rs.Close
                db.Close
                Set db = Nothing
                GoTo PROC_EXIT
            End If
        Else
            MsgBox "No invoices posted to Platinum."
            rs.Close
            db.Close
            Set db = Nothing
            GoTo PROC_EXIT
        End If
        rs.Close
            
        'line items in tblInvLin?
        strSQL = "SELECT DISTINCTROW tblInvLin.[DOCUMENT NO] FROM tblInvHdr INNER JOIN tblInvLin ON tblInvHdr.[TRANS NO] = tblInvLin.[DOCUMENT NO];"
        
        ' Create snapshot-type Recordset object.
        Set rs = db.OpenRecordset(strSQL, dbOpenSnapshot)
        If rs.RecordCount > 0 Then
            'insert detail records into PFW
            DoCmd.OpenQuery "qappPostPltDet_Ins_all"
        Else
            MsgBox "No line items posted to Platinum"
        GoTo PROC_EXIT
        rs.Close
        db.Close
        Set db = Nothing
        End If
        
        rs.Close
        db.Close
        Set db = Nothing
                
        MsgBox "The Haney Export file has been created.  Please send P:\QCDdb\Haney_Ex.db file to The Haney Group for Processing.", vbInformation, "Output complete"
    
        'remove data from form
        DoCmd.OpenQuery "qdelDelInvHdr_all"
        Forms![frmInvGrp_Ins].Requery
       
PROC_EXIT:
  
  DoCmd.SetWarnings True
  DoCmd.Hourglass False
  Exit Sub

PROC_ERR:
  
  MsgBox "There was an error Creating the Haney Export file, or in posting to Platium." & vbCrLf & _
    vbCrLf & "The error number is: " & Err.Number & " and the system Error message is: " & Err.DESCRIPTION, vbCritical, "Export Error"
  
  Resume PROC_EXIT:
  
End Sub
Private Sub btnPostPlt_Click()
'Purpose:  Posts a single group invoice to Platinum
'Programmer:  Suzanne Johnsen
'Date Created:  9/21/99
'Updated by:  John Criswell
'Date Updated:  1/11/00

On Error GoTo PROC_ERR
        
        Dim dbs As DAO.Database
        Dim rst As DAO.Recordset
        Dim strName As String, strMessage As String, strPrompt As String
        Dim fInTrans As Boolean
        Dim strSQL As String, strSQL_up As String
        Dim strTranNo As String
        
        strTranNo = Format(Me![TRANS NO], "0000000")
        
        DoCmd.Hourglass True
        DoCmd.SetWarnings False
        
        Set dbs = CurrentDb()
        
        'Populate the Haney Export Table
        DoCmd.OpenQuery "qdelHaneyExport"
        DoCmd.OpenQuery "qappPost_Haney_Indiv"
        
        ' Output the Haney File
        DoCmd.TransferSpreadsheet acExport, 8, "tblHaneyExport", "P:\QCDdb\Haney_Ex.XLS", True
                
        strSQL = "SELECT DISTINCTROW tblInvHdr.[CUST KEY], CStr(Format([TRANS NO],'00000')) AS Trans_No "
        strSQL = strSQL & "FROM tblInvHdr WHERE (((CStr(Format([TRANS NO],'00000')))='" & strTranNo & "'));"

        ' Create table-type Recordset object.
        Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
        If rst.RecordCount > 0 Then
            ' This is the OLD query that appended to PfW
            DoCmd.OpenQuery "qappPostPltHdr_Ins"  'changed name of query to conform to LNC -- jdc 1/11/00
            rst.Close
            Set rst = Nothing
        End If
        
            'Check both Access and Platinum
            'to insure data was transferred correctly
            If DidThisInvoicePosttoPlat(strTranNo) Then
                'nothing
            Else
                MsgBox "This invoice " & strTranNo & " did not post to Platinum."
                GoTo PROC_EXIT
            End If
            
            strSQL = "SELECT DISTINCTROW ([ITEM KEY]) & '  ' & ([Description]) AS SSN "
            strSQL = strSQL & "FROM tblInvHdr LEFT JOIN tblInvLin ON tblInvHdr.[TRANS NO] = tblInvLin.[DOCUMENT NO] "
            strSQL = strSQL & "WHERE (((tblInvLin.[DOCUMENT NO])='" & strTranNo & "'));"
    
            ' Create table-type Recordset object.
            Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
            If rst.RecordCount > 0 Then
                DoCmd.OpenQuery "qappPostPltDet_Ins"  'changed name of query to conform to LNC -- jdc 1/11/00
                rst.Close
                Set rst = Nothing
            End If
                    
        MsgBox "The Haney Export file has been created.  Please send P:\QCDdb\\Haney_Ex.XLS file to The Haney Group for Processing.", vbInformation, "Output complete"
    
        'remove data from form
        DoCmd.OpenQuery "qdelDelInvHdr_Ins"
        Forms![frmInvGrp_Ins].Requery
        
        dbs.Close
        Set dbs = Nothing
        
        DoCmd.SetWarnings True
        DoCmd.Hourglass False
        
    Exit Sub
    
PROC_EXIT:

    Set dbs = Nothing
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub
    
PROC_ERR:
    MsgBox "There was an error Creating the Haney Export file, or in posting to Platium." & vbCrLf & _
    vbCrLf & "The error number is: " & Err.Number & " and the system Error message is: " & Err.DESCRIPTION, vbCritical, "Export Error"

  Resume PROC_EXIT
End Sub


Private Sub Bulk_Invoices_Click()
  On Error GoTo PROC_ERR
    Dim strDocName As String
    Dim strLinkCriteria As String

    strDocName = "frmInvGrpBulk_Ins"
    DoCmd.OpenForm strDocName, , , strLinkCriteria
  
  Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub



Private Sub Button160_Click()
On Error GoTo Err_Button160_Click


    DoCmd.GoToRecord , , A_FIRST

Exit_Button160_Click:
    Exit Sub

Err_Button160_Click:
    MsgBox Error$
    Resume Exit_Button160_Click


End Sub

Private Sub Button161_Click()
On Error GoTo Err_Button161_Click

    DoCmd.GoToRecord , , A_PREVIOUS

Exit_Button161_Click:
    Exit Sub

Err_Button161_Click:
    MsgBox Error$
    Resume Exit_Button161_Click

End Sub

Private Sub Button162_Click()
On Error GoTo Err_Button162_Click


    DoCmd.GoToRecord , , A_NEXT

Exit_Button162_Click:
    Exit Sub

Err_Button162_Click:
    MsgBox Error$
    Resume Exit_Button162_Click

End Sub

Private Sub Button163_Click()
On Error GoTo Err_Button163_Click


    DoCmd.GoToRecord , , A_LAST

Exit_Button163_Click:
    Exit Sub

Err_Button163_Click:
    MsgBox Error$
    Resume Exit_Button163_Click


End Sub

Private Sub Button99_Click()
On Error GoTo Err_Button99_Click


    Screen.PreviousControl.SetFocus
    DoCmd.FindNext

Exit_Button99_Click:
    Exit Sub

Err_Button99_Click:
    MsgBox Error$
    Resume Exit_Button99_Click

End Sub

Private Sub CUST_KEY_AfterUpdate()
'Purpose:  gets information for the form based on the customer key,
'          and appends data to tblInvHdr
'Programmer:  Suzanne Johnsen
'Date Created:  9/21/99
'Date Updated:  5/21/2005
'Updated by:  John Criswell

  On Error GoTo Err_CUST_KEY_AfterUpdate
  
    'Check to see if this is an existing record
    'or a new one.  It is an existing record
    'if the tran no control has a value in it.
    If Not IsNull(Me![TRANS NO]) Then
        MsgBox ("This is not a new record")
        Exit Sub
    End If

    Dim db As DAO.Database
    Dim rs As DAO.Recordset
    Dim strWhere As String
    Dim strCriterion As String
    Dim strTranNo As String
    Dim lngSysDocID As Long
    Dim varInvoiceDate As Variant
    Dim varRecTime As Variant
    Dim varRecDate As Variant
    Dim strRecUserID As String
    
    DoCmd.Hourglass True
    
    Set db = CurrentDb()
    
    'get current invoice date
    Set rs = db.OpenRecordset("tblConstants", dbOpenSnapshot)
    varInvoiceDate = rs("FieldDateValue")
    rs.Close

    'Get the next Platinum tran no from ARONE_R9
    strTranNo = GetCurrentTranNo()
    If strTranNo = "0" Then
        GoTo Exit_CUST_KEY_AfterUpdate
    Else
        Forms![frmInvGrp_Ins]![TRANS NO] = Mid(Year(varInvoiceDate), 4, 1) & Format(strTranNo, "000000")
    End If
    
    ' Get the next SysDocID from ARNEXTSY
    lngSysDocID = GetCurrentSysDocID()
       
    Forms![frmInvGrp_Ins]![SYSDOCID] = lngSysDocID
    Forms![frmInvGrp_Ins]![RecUserID] = "INVOICE"
    Forms![frmInvGrp_Ins]![RecDate] = date
    Forms![frmInvGrp_Ins]![RecTime] = Time()
        
    strCriterion = Forms![frmInvGrp_Ins]![CUST KEY]
    strWhere = "[GroupID] = '" & strCriterion & "' AND [Ins]=Yes"
   
    'pop controls
    Set rs = db.OpenRecordset("tblGrp", dbOpenSnapshot)
    rs.FindFirst strWhere
    With Forms![frmInvGrp_Ins]
        [CUST NAME] = rs("GRname")
        [ADDRESS 1] = rs("GRstreet1")
        [ADDRESS 2] = rs("GRstreet2")
        [CITY] = rs("GRcity")
        [STATE] = rs("GRstate")
        [ZIP CODE] = rs("GRzip")
        [ATTENTION] = rs("GRmainCONT")
        [TERRITORY KEY] = rs("GRPgeoID")
        [CUST CLASS] = rs("GRclassKEY")
        [INV DATE] = varInvoiceDate
    End With
    rs.Close
    db.Close
      
    SendKeys "+{ENTER}", True
    DoCmd.Hourglass False

Exit Sub

Exit_CUST_KEY_AfterUpdate:
    DoCmd.Hourglass False
    Exit Sub

Err_CUST_KEY_AfterUpdate:
  MsgBox "The following error occured: " & Error$
  GoTo Exit_CUST_KEY_AfterUpdate
End Sub
Private Sub Form_AfterUpdate()

On Error GoTo Err_Form_AfterUpdate

    Dim dbsDb As DAO.Database
    Dim rstRs As DAO.Recordset
    Set dbsDb = DBEngine(0)(0)
    Set rstRs = dbsDb.OpenRecordset("tblConstants", dbOpenDynaset, dbSeeChanges)
    rstRs.Edit
    rstRs("FieldDateValue") = Me![INV DATE]
    rstRs.Update
    rstRs.Close
    dbsDb.Close

Exit_Form_AfterUpdate:
    Exit Sub

Err_Form_AfterUpdate:
    MsgBox Error$
    Resume Exit_Form_AfterUpdate


End Sub