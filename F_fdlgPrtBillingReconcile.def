Version =20
VersionRequired =20
Checksum =518573542
Begin Form
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DefaultView =0
    AllowUpdating =1
    ScrollBars =0
    ViewsAllowed =1
    BorderStyle =1
    Width =4608
    ItemSuffix =22
    Left =5292
    Top =600
    Right =9900
    Bottom =4908
    RecSrcDt = Begin
        0x1220ba0952cfe140
    End
    RecordSource ="SELECT tblConstants.FieldDateValue FROM tblConstants;"
    Caption ="Print Billing Reconciliation Report"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    MenuBar ="Dialog"
    PrtMip = Begin
        0xa0050000a0050000a0050000a00500000000000000120000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x4850204c617365724a6574203500000000000000000000000000000000000000 ,
        0x0004010494004000037700060100010040067903000001000f01580201000100 ,
        0x5802040000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000009010000020000000000000000000000010040004d53554437034850 ,
        0x204c617365724a6574203500000000000000000000000000000000000000e401 ,
        0x000000000000250100000000040064000a0000000000000000000000
    End
    PrtDevNames = Begin
        0x080011001f00010077696e73706f6f6c004850204c617365724a65742035005c ,
        0x5c4e747365727665725c68706c6a350000000000000000000000000000000000 ,
        0x000000000000000000000000
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    Begin
        Begin CommandButton
            TextFontFamily =2
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
        End
        Begin TextBox
            AutoLabel = NotDefault
        End
        Begin Section
            Height =4320
            BackColor =12632256
            Name ="Detail0"
            OnClick ="[Event Procedure]"
            GUID = Begin
                0x0f5015d6c752f44a9a9d79f9e51788aa
            End
            Begin
                Begin Label
                    BackStyle =0
                    OverlapFlags =85
                    TextAlign =2
                    Left =240
                    Top =315
                    Width =4035
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text13"
                    Caption ="Date of Invoices:"
                    GUID = Begin
                        0xdb9a91292e25a646901a4b355dd1881f
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =85
                    TextAlign =2
                    Left =1551
                    Top =675
                    Height =285
                    FontSize =10
                    Name ="ctlInvdate"
                    ControlSource ="FieldDateValue"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0000;0;_"
                    GUID = Begin
                        0xeb094963aaea95468af000926c021c01
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =82
                    Left =1680
                    Top =3870
                    Width =717
                    Height =403
                    TabIndex =1
                    Name ="PreviewButton"
                    Caption ="Print Preview&R"
                    StatusBarText ="Preview Report"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000017000000160000000100040000000000080100000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888889888888888888888888888884 ,
                        0x88888888888888888888888388888888888888888888888e8888000000000000 ,
                        0x8800888288880ffffffffff08000888d88880fffffff00007008888888880fff ,
                        0xfff078870788888588880fffff0788f77088888288880fffff08888780888884 ,
                        0x88880fffff08f8878088888888880fffff07ff877088888088880ffffff07887 ,
                        0x0888888088880fffffff00008888888088880ffffffffff08888888088880fff ,
                        0xffff00008888888088880fffffff08088888888188880fffffff008888888886 ,
                        0x8888000000000888888888808888888888888888888888808888888888888888 ,
                        0x888888808888888888888888888888800000000000000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                    GUID = Begin
                        0xed0baeb665cce84f8efe70397909134c
                    End
                End
                Begin OptionGroup
                    SpecialEffect =1
                    OverlapFlags =85
                    Left =720
                    Top =1320
                    Width =2879
                    Height =2285
                    TabIndex =2
                    Name ="PrtReport"
                    DefaultValue ="1"
                    GUID = Begin
                        0xb9ea8ba20eed61419dd6a26eb3998e2b
                    End
                    Begin
                        Begin Label
                            BackStyle =0
                            OverlapFlags =215
                            Left =900
                            Top =1500
                            Width =1560
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="LblSortBy"
                            Caption ="Print Report:"
                            GUID = Begin
                                0xc55c1f388fc7114799f3ff653df2a4bc
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =1245
                            Top =1815
                            Width =285
                            Height =180
                            OptionValue =1
                            Name ="BtnNew"
                            GUID = Begin
                                0xf754faff5a31fc44beda82ef5112e006
                            End
                            Begin
                                Begin Label
                                    BackStyle =0
                                    OverlapFlags =87
                                    Left =1544
                                    Top =1815
                                    Width =1860
                                    Height =240
                                    BackColor =12632256
                                    Name ="LblNew Groups"
                                    Caption ="New Groups"
                                    EventProcPrefix ="LblNew_Groups"
                                    GUID = Begin
                                        0xcf2c8caed92f5349a9c386aef8af89d7
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =1245
                            Top =2081
                            Width =285
                            Height =180
                            OptionValue =2
                            Name ="BtnCancelled"
                            GUID = Begin
                                0x9236b648a174084d8671f6f2c040ad0e
                            End
                            Begin
                                Begin Label
                                    BackStyle =0
                                    OverlapFlags =87
                                    Left =1544
                                    Top =2081
                                    Width =1860
                                    Height =240
                                    BackColor =12632256
                                    Name ="LblCancelled"
                                    Caption ="Cancelled or Billing Hold"
                                    GUID = Begin
                                        0x6d0822dfb78e654280c17847bb29dc1e
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =1245
                            Top =2347
                            Width =1704
                            OptionValue =3
                            Name ="BtnZero"
                            GUID = Begin
                                0x42170cf3e5bd64419cb9d15da4449a0d
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =1544
                                    Top =2347
                                    Width =1860
                                    Height =240
                                    BackColor =12632256
                                    Name ="LblZero"
                                    Caption ="Zero Dollar Invoices"
                                    GUID = Begin
                                        0x2730af28fcc0574b9a3cbf4a0704b255
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =1245
                            Top =2613
                            Width =1704
                            OptionValue =4
                            Name ="BtnNoInv"
                            GUID = Begin
                                0xcad128fb9886144aa2c0a4cd2f40e2b6
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =1544
                                    Top =2613
                                    Width =1860
                                    Height =240
                                    BackColor =12632256
                                    Name ="LblNoInv"
                                    Caption ="No Invoices"
                                    GUID = Begin
                                        0x5686ed9e4d6df041b933c3e97a4c962c
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =95
                            Left =1245
                            Top =2880
                            Width =1704
                            OptionValue =6
                            Name ="Option20"
                            GUID = Begin
                                0xaf5fe27757e18342a54ab8d49b9b8800
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =255
                                    Left =1544
                                    Top =2880
                                    Width =1860
                                    Height =240
                                    BackColor =12632256
                                    Name ="Label21"
                                    Caption ="New Groups Employees"
                                    GUID = Begin
                                        0x50a8d65daf467f4fbe307d8e6b9d5025
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =119
                            Left =1245
                            Top =3120
                            Width =1704
                            OptionValue =5
                            Name ="BntAll"
                            GUID = Begin
                                0x4ece08a33ce57143a9aad1060e45a2ae
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =1544
                                    Top =3127
                                    Width =1860
                                    Height =240
                                    BackColor =12632256
                                    Name ="Label19"
                                    Caption ="Print all reports"
                                    GUID = Begin
                                        0x35467397e3892f468d20505f9f1e5520
                                    End
                                End
                            End
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit

Private Sub Form_Close()
On Error GoTo PROC_ERR

    Forms![fmnuReportBilling].Visible = True
    Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub

Private Sub Form_Open(intCancel As Integer)
On Error GoTo PROC_ERR

  Forms![fmnuReportBilling].Visible = False
  Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub

Private Sub PreviewButton_Click()

On Error GoTo PROC_ERR

    If (Me![PrtReport] = 1) Then
     Call PopTable
     DoCmd.OpenReport "rptBillingReconcile_NewGroups", acViewPreview
     Exit Sub
    End If
    
    If (Me![PrtReport] = 2) Then
     DoCmd.OpenReport "rptBillingReconcile_Cancelled", acViewPreview
     Exit Sub
    End If
    
    If (Me![PrtReport] = 3) Then
     DoCmd.OpenReport "rptBillingReconcile_ZeroInv", acViewPreview
     Exit Sub
    End If
    
    If (Me![PrtReport] = 4) Then
     DoCmd.OpenReport "rptBillingReconcile_NoInv", acViewPreview
     Exit Sub
    End If
    
    ' Send all reports to printer
    If (Me![PrtReport] = 5) Then
        Call PopTable
        Call PopEmplTable
        DoCmd.OpenReport "rptBillingReconcile_NewGroups", acViewNormal
        DoCmd.OpenReport "rptBillingReconcile_Cancelled", acViewNormal
        DoCmd.OpenReport "rptBillingReconcile_ZeroInv", acViewNormal
        DoCmd.OpenReport "rptBillingReconcile_Employees", acViewNormal
        DoCmd.OpenReport "rptBillingReconcile_NoInv", acViewNormal
    Exit Sub
    End If
    
    If (Me![PrtReport] = 6) Then
     Call PopEmplTable
    
     DoCmd.OpenReport "rptBillingReconcile_Employees", acViewPreview
     Exit Sub
    End If
         
PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub

Private Function PopTable()

    ' Populate the table
     DoCmd.SetWarnings False
     DoCmd.Hourglass True
     DoCmd.RunSQL "DELETE * FROM tmpBillingReconcile_rpt"
     DoCmd.OpenQuery "qrptBillingReconcile_NewGrp_Rpt"
     DoCmd.Hourglass False
     DoCmd.SetWarnings True

End Function

Private Function PopEmplTable()

    ' Populate the table
     DoCmd.SetWarnings False
     DoCmd.Hourglass True
     DoCmd.RunSQL "DELETE * FROM tmpBillingReconcile_rpt"
     DoCmd.OpenQuery "qrptBillingReconcile_Employees_Rpt"
     Call PopSubCnt
     Call PopDepCnt
     DoCmd.Hourglass False
     DoCmd.SetWarnings True

End Function

Private Sub PopDepCnt()

    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset
    Dim rst2 As DAO.Recordset
    Dim strSQL As String
    Dim strSQL2 As String
    Dim strGrpID As String
    
    Set dbs = CurrentDb()
        
    ' Get the groups in tmpBillingReconcile_rpt
    strSQL2 = "Select GroupID, DepCnt from tmpBillingReconcile_rpt order by GroupID"
    Set rst2 = dbs.OpenRecordset(strSQL2, dbOpenDynaset, dbSeeChanges)
    If rst2.RecordCount > 0 Then
    Do While Not rst2.EOF
        strGrpID = rst2.Fields("GroupID")
        rst2.Edit
        strSQL = "SELECT qselDepCnts.SUBgroupID, qselDepCnts.CountOfID " & _
                 "FROM qselDepCnts WHERE (((qselDepCnts.SUBgroupID)='" & strGrpID & "'));"
        Set rst = dbs.OpenRecordset(strSQL, dbOpenDynaset, dbSeeChanges)
        If rst.RecordCount > 0 Then
            
            rst2.Fields("DepCnt") = rst.Fields("CountOfID")
        Else
            rst2.Fields("DepCnt") = 0
        End If
        rst2.Update
        rst.Close
        rst2.MoveNext
    Loop
    End If
    
End Sub


Private Sub PopSubCnt()

    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset
    Dim rst2 As DAO.Recordset
    Dim strSQL As String
    Dim strSQL2 As String
    Dim strGrpID As String
    
    Set dbs = CurrentDb()
        
    ' Get the groups in tmpBillingReconcile_rpt
    strSQL2 = "Select GroupID, SubCnt from tmpBillingReconcile_rpt order by GroupID"
    Set rst2 = dbs.OpenRecordset(strSQL2, dbOpenDynaset, dbSeeChanges)
    If rst2.RecordCount > 0 Then
    Do While Not rst2.EOF
        strGrpID = rst2.Fields("GroupID")
        rst2.Edit
        strSQL = "SELECT qselSubCnts.SUBgroupID, qselSubCnts.CountOfSubID " & _
                 "FROM qselSubCnts WHERE (((qselSubCnts.SUBgroupID)='" & strGrpID & "'));"
        Set rst = dbs.OpenRecordset(strSQL, dbOpenDynaset, dbSeeChanges)
        If rst.RecordCount > 0 Then
            
            rst2.Fields("SubCnt") = rst.Fields("CountOfSubID")
        Else
            rst2.Fields("SubCnt") = 0
        End If
        rst2.Update
        rst.Close
        rst2.MoveNext
    Loop
    End If
    
End Sub