Version =20
VersionRequired =20
Checksum =481124030
Begin Form
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =3885
    DatasheetFontHeight =10
    ItemSuffix =11
    Left =6315
    Top =1635
    Right =12210
    Bottom =4230
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x8903859034dde140
    End
    GUID = Begin
        0x935ea0476251aa468ef738087c0682e6
    End
    NameMap = Begin
        0x0acc0e5500000000000000000000000000000000000000000c00000003000000 ,
        0x0000000000000000000000000000
    End
    Caption ="Agent Commissions"
    MenuBar ="Dialog"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00ec020367000601000100ea0a6f08640001000200580201000100 ,
        0x5802040001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200b000ec020000c1951cfb0000000000000000000000000000000000000000 ,
        0x0000000000000000060000000100000000000000020001000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000b0000000534d544a ,
        0x000000001000a00053006e006100670069007400200031003000200050007200 ,
        0x69006e007400650072000000496e70757442696e004d414e55414c0052455344 ,
        0x4c4c00556e69726573444c4c004f7269656e746174696f6e00504f5254524149 ,
        0x5400506170657253697a65004c4554544552005265736f6c7574696f6e004f70 ,
        0x74696f6e3300436f6c6f724d6f64650032346270700000000000000000000000 ,
        0x0000000000000000
    End
    PrtDevNames = Begin
        0x08001a0024000100000000000000000000000000000000000000000000000000 ,
        0x00000000433a5c50726f6772616d446174615c54656368536d6974685c536e61 ,
        0x6769742031305c5072696e746572506f727446696c6500
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    Begin
        Begin Label
            BackStyle =0
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin Section
            Height =2625
            BackColor =-2147483633
            Name ="Detail"
            GUID = Begin
                0x8b53c6d3bd1e3e43889bc2d6bf5154c2
            End
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OldBorderStyle =0
                    OverlapFlags =85
                    Left =2010
                    Top =495
                    Width =885
                    GUID = Begin
                        0x9ca1d3b33626f24da887f4f78b7262fd
                    End
                    Name ="cboCommissionMonth"
                    RowSourceType ="Value List"
                    RowSource ="01;02;03;04;05;06;07;08;09;10;11;12"
                    DefaultValue ="\"\""
                    ControlTipText ="Enter receipts month."
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =1110
                            Top =495
                            Width =825
                            Height =240
                            FontWeight =700
                            Name ="Label1"
                            Caption ="Month:  "
                            GUID = Begin
                                0xdb004acc70c2284da9757ce2d3b7e8a5
                            End
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OldBorderStyle =0
                    OverlapFlags =85
                    Left =2010
                    Top =855
                    Width =885
                    TabIndex =1
                    GUID = Begin
                        0x28ccfa1bd7a49f4daeecd68f02fb8c86
                    End
                    Name ="cboYear"
                    RowSourceType ="Value List"
                    RowSource ="\"2004\";\"2005\";\"2006\";\"2007\";\"2008\";\"2009\";\"2010\";\"2011\";\"2012\""
                        ";\"2013\";\"2014\";\"2015\""
                    DefaultValue ="\"\""
                    ControlTipText ="Enter receipts year."
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =1200
                            Top =855
                            Width =735
                            Height =240
                            FontWeight =700
                            Name ="Label6"
                            Caption ="Year:  "
                            GUID = Begin
                                0xac6497714182264dac0a02a63e35c75e
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =675
                    Top =1260
                    Width =2706
                    Height =576
                    TabIndex =2
                    Name ="cmdCreateTempRptTbl"
                    Caption ="Create Temporary\015\012Commission Report Table"
                    OnClick ="[Event Procedure]"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff000000c0c0c000ffff00000000ff00c0c0c00000ffff00 ,
                        0xffffff0000000000
                    End
                    ControlTipText ="Create Temporary Report Table"
                    GUID = Begin
                        0x11562ed22c397241abdad39a00c3ee67
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    Left =810
                    Top =2025
                    Width =2400
                    Height =300
                    TabIndex =3
                    Name ="txtProcessing"
                    GUID = Begin
                        0x321a69e3f24ea248bfb4c0c7fc0f2960
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


Private Sub cmdCommissionReport_Click()
    
    On Error GoTo Err_cmdCommissionReport_Click
    
    Dim strDocName As String
    Dim strMonth As String
    Dim strWhere As String
    Dim strYear As String
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    strMonth = Me![cboCommissionMonth]
    strYear = Me![cboYear]
    
    Select Case strMonth
        
        Case "Jan"
            strWhere = "[COMMcheckDATE] Between #" & "01/01/" & strYear & "# And #" & "01/31/" & strYear & "#"
        Case "Feb"
        If strYear = "2000" Or strYear = "2004" Then
            strWhere = "[COMMcheckDATE] Between #" & "02/01/" & strYear & "# And #" & "02/29/" & strYear & "#"
        Else
            strWhere = "[COMMcheckDATE] Between #" & "02/01/" & strYear & "# And #" & "02/28/" & strYear & "#"
        End If
        Case "Mar"
            strWhere = "[COMMcheckDATE] Between #" & "03/01/" & strYear & "# And #" & "03/31/" & strYear & "#"
        Case "Apr"
            strWhere = "[COMMcheckDATE] Between #" & "04/01/" & strYear & "# And #" & "04/30/" & strYear & "#"
        Case "May"
            strWhere = "[COMMcheckDATE] Between #" & "05/01/" & strYear & "# And #" & "05/31/" & strYear & "#"
        Case "Jun"
            strWhere = "[COMMcheckDATE] Between #" & "06/01/" & strYear & "# And #" & "06/30/" & strYear & "#"
        Case "Jul"
            strWhere = "[COMMcheckDATE] Between #" & "07/01/" & strYear & "# And #" & "07/31/" & strYear & "#"
        Case "Aug"
            strWhere = "[COMMcheckDATE] Between #" & "08/01/" & strYear & "# And #" & "08/31/" & strYear & "#"
        Case "Sep"
            strWhere = "[COMMcheckDATE] Between #" & "09/01/" & strYear & "# And #" & "09/30/" & strYear & "#"
        Case "Oct"
            strWhere = "[COMMcheckDATE] Between #" & "10/01/" & strYear & "# And #" & "10/31/" & strYear & "#"
        Case "Nov"
            strWhere = "[COMMcheckDATE] Between #" & "11/01/" & strYear & "# And #" & "11/30/" & strYear & "#"
        Case "Dec"
            strWhere = "[COMMcheckDATE] Between #" & "12/01/" & strYear & "# And #" & "12/31/" & strYear & "#"
    End Select
    
    strDocName = "rptCommission"
    DoCmd.OpenReport strDocName, acPreview, , strWhere
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
    Me.Visible = False
    Forms![fmnuSwitchboard].Visible = False
    
Exit_cmdCommissionReport_Click:
    Exit Sub
    
Err_cmdCommissionReport_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_cmdCommissionReport_Click
    
End Sub

Private Sub cmdCreateTempRptTbl_Click()
    '------------------------------------------------
    'Purpose:  Creates a temporary table that is used
    '          for the Internal Agent Commission Report
    '          and for the Commission Statements.  It
    '          pulls cash receipt data out of Platinum
    '          for each type of agent and puts the data
    '          into a temp table.
    '------------------------------------------------
    'Programmer:  John Criswell
    'Create Date:
    'Update Date:  3/18/2005
    'Updated by:  John Criswell
    
    On Error GoTo Err_cmdCreateTempRptTbl_Click
    
    Dim strMonth As String
    Dim strYear As String
    Dim strUserName As String
    Dim strInvoiceDate As String
    Dim dteMonthFirstDay As Date
    Dim dteMonthLastDay As Date
    
    strUserName = GetCurrentUserName()
    
    ' user visual communication
    With Me
        .txtProcessing.SetFocus
        .txtProcessing.BackColor = 16777088
        .txtProcessing = "Processing... please wait."
        .cboCommissionMonth.SetFocus
    End With
    
    strMonth = Me![cboCommissionMonth]
    strYear = Me![cboYear]
    strInvoiceDate = strYear & "-" & strMonth & "-" & "01"
    dteMonthFirstDay = MonthFirstDay(CInt(strMonth), CInt(strYear))
    dteMonthLastDay = MonthLastDay(CInt(strMonth), CInt(strYear))
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    '  pull new customer accounts into ARCUST_local
    ExecuteSQL "usp_ARCUST_local" & "' " & strUserName & "'"
    
    '  pull group customer payments from QuickBooks
    '  and put them into ARTRANH_local for the selected month
    '  and then sync the transactions
    ExecuteSQL "usp_CustomerPayments" & "' " & strInvoiceDate & "'"
    ExecuteSQL "usp_Synch_TxnID" & "' " & strInvoiceDate & "'"
    
    '  populate the commission temp table
    ExecuteSQL "usp_Commission" & "' " & dteMonthFirstDay & "', '" & dteMonthLastDay & "'"
    
    ' clear user visual communication
    With Me
        .txtProcessing.SetFocus
        .txtProcessing.BackColor = 16777215
        .txtProcessing = "Process Complete."
        .cboCommissionMonth.SetFocus
    End With
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
    Exit Sub
    
Exit_cmdCreateTempRptTbl_Click:
    Exit Sub
    
Err_cmdCreateTempRptTbl_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_cmdCreateTempRptTbl_Click
End Sub