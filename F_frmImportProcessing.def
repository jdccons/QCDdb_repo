Version =20
VersionRequired =20
Checksum =-2108826728
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =6345
    DatasheetFontHeight =10
    ItemSuffix =28
    Left =6885
    Top =1515
    Right =13485
    Bottom =7755
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xea0e144b8c92e240
    End
    GUID = Begin
        0xb736fc4d265ed94daa1fbc29b6b6d86b
    End
    NameMap = Begin
        0x0acc0e550000000012588117304b4340bb7d4df01fa3284900000000e5a1178d ,
        0xc9f1e4400000390218000000740062006c00470072007000000000000000f277 ,
        0x213b7271c04b98fee5e3363702090700000012588117304b4340bb7d4df01fa3 ,
        0x284947005200430061006e00630065006c006c00650064000000000000002f72 ,
        0xf789365bb048a559c9f373eb3e47000000008b8f9edceff1e44060955f0a78e2 ,
        0xdb5e74006c006b00700049006d0070006f007200740053007000650063000000 ,
        0x00000000a5df1aa5419a6345bbaf69db263773fa0700000012588117304b4340 ,
        0xbb7d4df01fa32849470072006f0075007000490044000000000000000c16e850 ,
        0xe1cd044faa01324b63c789770700000012588117304b4340bb7d4df01fa32849 ,
        0x470052004e0061006d006500000000000000282de72c561d0f49a0b8cd779c47 ,
        0xc2d8070000002f72f789365bb048a559c9f373eb3e4749006d0070006f007200 ,
        0x74005400790070006500000000000000f2eff6a47e929f489e36b5cea71c1dab ,
        0x070000002f72f789365bb048a559c9f373eb3e4749006d0070006f0072007400 ,
        0x4400650073006300000000000000224ee9fb1f5c4946aad756d69ff331aa0700 ,
        0x000012588117304b4340bb7d4df01fa32849470072006f007500700054007900 ,
        0x70006500000000000000171ab3fea8e4384e90a1585ffacd8130070000002f72 ,
        0xf789365bb048a559c9f373eb3e47470052004f00550050004900440000000000 ,
        0x0000000000000000000000000000000000000c00000003000000000000000000 ,
        0x0000000000000000
    End
    Caption ="Import Processing"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010403069c000c0303ff000001000100ea0a6f08640001000f00580202000100 ,
        0x5802020000004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200b0000c030000c1951cfb0000000000000000000000000000000000000000 ,
        0x0000000000000000060000000100000000000000020001000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000b0000000534d544a ,
        0x000000001000a00053006e00610067006900740020003100b0000000534d544a ,
        0x000000001000a00053006e006100670069007400200031003000200050007200 ,
        0x69006e007400650072000000496e70757442696e004d414e55414c0052455344 ,
        0x4c4c00556e69726573444c4c004f7269656e746174696f6e00504f5254524149 ,
        0x5400506170657253697a65004c4554544552005265736f6c7574696f6e004f70 ,
        0x74696f6e3300436f6c6f724d6f64650032346270700000000000000000000000 ,
        0x0000000000000000
    End
    PrtDevNames = Begin
        0x08001a0024000100000000000000000000000000000000000000000000000000 ,
        0x00000000433a5c50726f6772616d446174615c54656368536d6974685c536e61 ,
        0x6769742031305c5072696e746572506f727446696c6500
    End
    OnLoad ="[Event Procedure]"
    UnknownProp = {305 ,452 ,1 ,1 ,1 } Begin
        0x00
    End
    UnknownProp = {395 ,563 ,1 ,1 ,1 } Begin
        0x00
    End
    UnknownProp = {400 ,582 ,4 ,4 ,4 } Begin
        0xc0c0c000
    End
    UnknownProp = {419 ,678 ,11 ,0 ,5576 } Begin
        0x5c005c007700730032003000300033005c004800500034003200300030000000 ,
        0x01000002780f7d02200000001a071710000000005c3e1400a40708000c3f1400 ,
        0x01040006dc00ec1443ff800701000100ea0a6f08640001000f00580202000100 ,
        0x5802020000004c00650074007400650072000000000000001c3f1400c83e1400 ,
        0xabf6fa72503f14001c3f140003f6fa72f5f3fa720bf6fa72a407080010c5080a ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x020000000c010000ffffffff0000000000000000000000000000000044494e55 ,
        0x220030036c05800fbc9264af0000000000000000000000000000000000000000 ,
        0x0000000000000000200000000000000001000100000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000000000000 ,
        0x0000000000000200000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000030030000534d544a ,
        0x00000000100020034800500020004c0061007300650072004a00650074002000 ,
        0x34003200300030002000500043004c00200036000000496e70757442696e0046 ,
        0x4f524d534f5552434500524553444c4c00556e69726573444c4c005265736f6c ,
        0x7574696f6e0036303064706900466173745265730054727565004f7269656e74 ,
        0x6174696f6e00504f5254524149540048504f7269656e74526f74617465313830 ,
        0x0046616c7365004850537461706c696e674f70706f7365640046616c73650050 ,
        0x6170657253697a65004c4554544552004d6564696154797065004175746f0044 ,
        0x75706c6578004e4f4e45004850466f6e74496e7374616c6c6572005452554500 ,
        0x4850504a4c456e636f64696e670055544638004f757470757442696e00417574 ,
        0x6f00537461706c696e67004e6f6e6500537461706c696e67436d6443616c6c62 ,
        0x61636b00537461706c696e67436d64436200436f6c6c617465004f4646004a52 ,
        0x436f6e73747261696e7473004a524348445061727469616c004a524844496e73 ,
        0x74616c6c6564004a5248444f6666004a5248444e6f74496e7374616c6c656400 ,
        0x4a5248444f666600545441734269746d61707353657474696e670054544d6f64 ,
        0x654f75746c696e650052455443686f69636500547275650048504c706953656c ,
        0x656374696f6e004e6f6e6500485050434c36506173735468726f756768005472 ,
        0x7565004a52436d6443616c6c6261636b004a52004850436f6c6f724d6f646500 ,
        0x4d4f4e4f4348524f4d455f4d4f4445004850426f726e4f6e4461746500485042 ,
        0x4f440048504a6f6242794a6f624f76657272696465004a424a4f004850584d4c ,
        0x46696c6555736564004850584d4c46696c654e616d6500485050444c54797065 ,
        0x0050444c5f50434c36005072696e745175616c69747947726f75700050514772 ,
        0x6f75705f330045636f6e6f6d6f64650046616c73650048504a6f624163636f75 ,
        0x6e74696e670048504a4f42414343545f4a4f4241434e54000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000800f00004955504801001100000000000100000002000000 ,
        0x0100000000000000000000000300000000000000000000000100010064000100 ,
        0x000002000200000001000000020000004c006500740074006500720000000000 ,
        0x0000000000000000000000000000000000000000010000000600000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000020005b006e006f006e006500 ,
        0x5d00000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000020005b006e006f006e006500 ,
        0x5d00000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000041007200690061006c000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000340000005000000000000000 ,
        0x0100000000000000c0c0c00000000000c0c0c000040000000000000000000000 ,
        0x00000000010000000100000064000000000000000000803f0000000000000000 ,
        0x0000000000000000010000000000000000000000000000000201000008010000 ,
        0x000000000000000000000000010000000000000000000000000000004a004f00 ,
        0x48004e0043000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000003c00 ,
        0x4100750074006f006d0061007400690063003e00000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000000010000000100000001000000010000000100000001000000 ,
        0x0100000001000000000000000000000001000000000000000000000001000000 ,
        0x30000000010000000000000000000000010000000f0000000c01000000000000 ,
        0x0f0000000c010000000000000200000000000000000000000f0000000c010000 ,
        0x0f0000000c010000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x02000000ffffffff
    End
    UnknownProp = {420 ,679 ,11 ,0 ,158 } Begin
        0x04000e001f000100770069006e00730070006f006f006c00000000005c005c00 ,
        0x7700730032003000300033005c00480050003400320030003000000000004800 ,
        0x5000340032003000300000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000000000000000
    End
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
            UnknownProp = {324 ,11 ,2 ,1 ,1 } Begin
                0x00
            End
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin Section
            Height =6000
            BackColor =14127360
            Name ="Detail"
            GUID = Begin
                0x262b5faf6cc57f44860dd59511090df9
            End
            Begin
                Begin CommandButton
                    OverlapFlags =93
                    Left =5340
                    Top =5280
                    Width =432
                    Height =432
                    Name ="cmdClose"
                    Caption ="Command20"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad0000000000000000
                    End
                    FontName ="Tahoma"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Close Form"
                    GUID = Begin
                        0xc9f8505b9cd64842b42e7fc9586fb4f8
                    End
                    UnknownProp = {289 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {293 ,586 ,3 ,4 ,4 } Begin
                        0xdc140000
                    End
                    UnknownProp = {294 ,587 ,3 ,4 ,4 } Begin
                        0xa0140000
                    End
                    UnknownProp = {295 ,588 ,3 ,4 ,4 } Begin
                        0xb2170000
                    End
                    UnknownProp = {296 ,589 ,3 ,4 ,4 } Begin
                        0x86160000
                    End
                    UnknownProp = {356 ,700 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,699 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,701 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,702 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,736 ,1 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    SpecialEffect =4
                    OldBorderStyle =1
                    BorderWidth =3
                    OverlapFlags =85
                    TextAlign =2
                    Left =60
                    Top =60
                    Width =4260
                    Height =330
                    FontSize =10
                    FontWeight =700
                    ForeColor =16777215
                    Name ="Label1"
                    Caption ="Import File Processing"
                    GUID = Begin
                        0x92c6cb28d055f3439aa72d0ff71fbe94
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    ColumnCount =4
                    ListWidth =3600
                    Left =1200
                    Top =480
                    Width =3120
                    TabIndex =1
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"60\""
                    GUID = Begin
                        0xf7296502fcf36f47bbb8a7397f15faad
                    End
                    Name ="cboGroups"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tblGrp.GroupID, tblGrp.GRName, tlkpImportSpec.ImportType, tlkpImportSpec."
                        "ImportDesc, tblGrp.GroupType FROM tblGrp INNER JOIN tlkpImportSpec ON tblGrp.Gro"
                        "upID=tlkpImportSpec.GROUPID WHERE (((tblGrp.GRCancelled)=0)) ORDER BY tblGrp.GRN"
                        "ame;"
                    ColumnWidths ="0;3600;0;0"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Tahoma"
                    BaseInfo ="\"SELECT tblGrp.GroupID, tblGrp.GRName, tlkpImportSpec.ImportType, tlkpImportSpe"
                        "c.ImportDesc, tblGrp.GroupType FROM tblGrp INNER JOIN tlkpImportSpec ON tblGrp.G"
                        "roupID=tlkpImportSpec.GROUPID WHERE (((tblGrp.GRCancelled)=0)) ORDER BY tblGrp.G"
                        "RName;\";\"tblGrp\";\"tlkpImportSpec\";\"\""
                    UnknownProp = {306 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =120
                            Top =480
                            Width =1020
                            Height =240
                            ForeColor =16777215
                            Name ="Label4"
                            Caption ="Select Group"
                            FontName ="Tahoma"
                            GUID = Begin
                                0x5ffb4d029c28134e9ee284c2229525ef
                            End
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =4500
                    Top =60
                    Width =1140
                    TabIndex =2
                    BackColor =10092543
                    Name ="txtGrpID"
                    FontName ="Tahoma"
                    GUID = Begin
                        0xc4f3550c27403648b9304d95cbda1c0c
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =93
                    Left =4500
                    Top =360
                    Width =1140
                    TabIndex =3
                    BackColor =10092543
                    Name ="txtPlanID"
                    FontName ="Tahoma"
                    GUID = Begin
                        0xba82fca418d54d418a1b9e2869dd7ce1
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =120
                    Top =960
                    Width =1320
                    Height =420
                    TabIndex =4
                    Name ="cmdSubFileSelect"
                    Caption ="Select File"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    GUID = Begin
                        0xfee9545dcb4c6a4d8194877c8321073a
                    End
                    UnknownProp = {289 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {356 ,700 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,699 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,701 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,702 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,736 ,1 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin TextBox
                    OverlapFlags =95
                    Left =1500
                    Top =1140
                    Width =4680
                    TabIndex =5
                    Name ="txtMainFile"
                    FontName ="Tahoma"
                    GUID = Begin
                        0xe575fa3a3fe87845b0cd91b81a56e2b2
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    Begin
                        Begin Label
                            Visible = NotDefault
                            OverlapFlags =93
                            Left =1500
                            Top =900
                            Width =2640
                            Height =240
                            ForeColor =16777215
                            Name ="lblSubscriber"
                            Caption ="Subscriber File To Process: "
                            FontName ="Tahoma"
                            GUID = Begin
                                0x06bd3bd259ef2843a960714fb666ee25
                            End
                        End
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    OverlapFlags =95
                    Left =1500
                    Top =1620
                    Width =4680
                    TabIndex =6
                    Name ="txtDependentFile"
                    FontName ="Tahoma"
                    GUID = Begin
                        0x75b99437a760cb4f962451cdf1cee70a
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    Begin
                        Begin Label
                            OverlapFlags =95
                            Left =1500
                            Top =1380
                            Width =2640
                            Height =240
                            ForeColor =16777215
                            Name ="Label8"
                            Caption ="Dependent File To Process: "
                            FontName ="Tahoma"
                            GUID = Begin
                                0x73c735ec73a987478de9979322d1a0f6
                            End
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =93
                    Left =120
                    Top =1440
                    Width =1320
                    Height =420
                    TabIndex =7
                    Name ="cmdDepFileSelect"
                    Caption ="Select File"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    GUID = Begin
                        0x4dd8a33cead1784da1fed935b5ea5ad4
                    End
                    UnknownProp = {289 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {356 ,700 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,699 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,701 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,702 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,736 ,1 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Rectangle
                    OverlapFlags =255
                    Left =60
                    Top =840
                    Width =6240
                    Height =1140
                    Name ="Box4"
                    GUID = Begin
                        0xbb350ad1a089a1458ae4402fd7e74691
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    Left =2160
                    Top =2100
                    Width =3600
                    TabIndex =8
                    BackColor =16777164
                    Name ="txtGroup"
                    FontName ="Tahoma"
                    GUID = Begin
                        0x27af661e63d05f4d9e4a6a895d77cc4d
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =480
                            Top =2100
                            Width =1605
                            Height =240
                            FontWeight =700
                            ForeColor =16777215
                            Name ="Label12"
                            Caption ="EDI Group Name "
                            FontName ="Tahoma"
                            GUID = Begin
                                0x38095008050bde4a904be1efadecaa2e
                            End
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =5820
                    Top =60
                    Width =480
                    TabIndex =9
                    BackColor =10092543
                    Name ="txtImportSpec"
                    FontName ="Tahoma"
                    GUID = Begin
                        0x24ec32a27a28aa4a803f949d87d058e5
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                End
                Begin Label
                    OverlapFlags =255
                    Left =1500
                    Top =900
                    Width =2280
                    Height =240
                    ForeColor =16777215
                    Name ="lblHIPAAFile"
                    Caption ="HIPAA File To Process:"
                    FontName ="Tahoma"
                    GUID = Begin
                        0xcbe59d750a7f314d897135506c68768f
                    End
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =247
                    Left =1500
                    Top =900
                    Width =2280
                    Height =240
                    ForeColor =16777215
                    Name ="lblImportFile"
                    Caption ="Import File To Process:"
                    FontName ="Tahoma"
                    GUID = Begin
                        0x74fbae288e283049a58866cb28646599
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OverlapFlags =93
                    TextAlign =2
                    Left =2100
                    Top =2580
                    Width =4080
                    Height =300
                    FontSize =10
                    FontWeight =700
                    TabIndex =10
                    Name ="txtStatus"
                    GUID = Begin
                        0x93fcf48bf0e5e04e914c46f0374131e1
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =120
                    Top =2520
                    Width =1860
                    Height =420
                    TabIndex =11
                    Name ="cmdProcess"
                    Caption ="Process File"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    GUID = Begin
                        0x7f8efa38b2935c44bb960e314668c527
                    End
                    UnknownProp = {289 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {356 ,700 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,699 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,701 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,702 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,736 ,1 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =93
                    Left =4140
                    Top =3960
                    Width =1860
                    Height =420
                    TabIndex =12
                    Name ="cmdPrintException"
                    Caption ="Preview Exceptions"
                    GUID = Begin
                        0x4e4e3d1a99a6df41966f1ca3cbe1dc34
                    End
                    UnknownProp = {289 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {293 ,586 ,3 ,4 ,4 } Begin
                        0x2c100000
                    End
                    UnknownProp = {294 ,587 ,3 ,4 ,4 } Begin
                        0x780f0000
                    End
                    UnknownProp = {295 ,588 ,3 ,4 ,4 } Begin
                        0x70170000
                    End
                    UnknownProp = {296 ,589 ,3 ,4 ,4 } Begin
                        0x1c110000
                    End
                    UnknownProp = {356 ,700 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,699 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,701 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,702 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,736 ,1 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =120
                    Top =3960
                    Width =2460
                    Height =420
                    TabIndex =13
                    Name ="cmdPrintNewSubscr"
                    Caption ="Print New Subscribers List"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    GUID = Begin
                        0x750362ea2a61174fbc4b377c08168ecc
                    End
                    UnknownProp = {289 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {356 ,700 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,699 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,701 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,702 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,736 ,1 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =223
                    Left =3060
                    Top =3960
                    Width =1980
                    TabIndex =14
                    Name ="cmdViewResults"
                    Caption ="View Import Results"
                    GUID = Begin
                        0x55137c551abac44fae25b4420e3c1f8a
                    End
                    UnknownProp = {289 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {293 ,586 ,3 ,4 ,4 } Begin
                        0x78000000
                    End
                    UnknownProp = {294 ,587 ,3 ,4 ,4 } Begin
                        0x780f0000
                    End
                    UnknownProp = {295 ,588 ,3 ,4 ,4 } Begin
                        0x140a0000
                    End
                    UnknownProp = {296 ,589 ,3 ,4 ,4 } Begin
                        0x1c110000
                    End
                    UnknownProp = {356 ,700 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,699 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,701 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,702 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,736 ,1 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =420
                    Top =5340
                    Width =1800
                    TabIndex =15
                    ForeColor =0
                    Name ="cmdPrintCards"
                    Caption ="Print Cards"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x1bee7e09c960f8498357e7ee62f4b0fe
                    End
                    UnknownProp = {289 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {293 ,586 ,3 ,4 ,4 } Begin
                        0xf40b0000
                    End
                    UnknownProp = {294 ,587 ,3 ,4 ,4 } Begin
                        0x780f0000
                    End
                    UnknownProp = {295 ,588 ,3 ,4 ,4 } Begin
                        0xb0130000
                    End
                    UnknownProp = {296 ,589 ,3 ,4 ,4 } Begin
                        0xe0100000
                    End
                    UnknownProp = {356 ,700 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,699 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,701 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,702 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,736 ,1 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =180
                    Top =4620
                    Width =2460
                    Height =420
                    TabIndex =16
                    Name ="cmdAddToDB"
                    Caption ="Add Group to DB"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    GUID = Begin
                        0x1565ca69da630645a0f50976029477f7
                    End
                    UnknownProp = {289 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {293 ,586 ,3 ,4 ,4 } Begin
                        0xa4010000
                    End
                    UnknownProp = {294 ,587 ,3 ,4 ,4 } Begin
                        0xdc140000
                    End
                    UnknownProp = {295 ,588 ,3 ,4 ,4 } Begin
                        0xac080000
                    End
                    UnknownProp = {296 ,589 ,3 ,4 ,4 } Begin
                        0x44160000
                    End
                    UnknownProp = {356 ,700 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,699 ,4 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,701 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,702 ,4 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,736 ,1 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    OverlapFlags =93
                    TextAlign =2
                    Left =3000
                    Top =4680
                    Width =1980
                    TabIndex =17
                    Name ="txtCommit"
                    GUID = Begin
                        0x3bbc941b4d145c45a588b9db18a3cd30
                    End
                End
                Begin Rectangle
                    OverlapFlags =247
                    Left =60
                    Top =2460
                    Width =6240
                    Height =540
                    Name ="Box18"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x26f3df42cad9934d8789d07c160ed33c
                    End
                End
                Begin Rectangle
                    OverlapFlags =215
                    Left =60
                    Top =3840
                    Width =6240
                    Height =600
                    Name ="Box19"
                    GUID = Begin
                        0xa9aaaaa08778ff4aacdb2015aca7ccdd
                    End
                End
                Begin Rectangle
                    OverlapFlags =247
                    Left =60
                    Top =4500
                    Width =6240
                    Height =600
                    Name ="Box20"
                    GUID = Begin
                        0x5e2b04cc01a9fd458d8092796609625e
                    End
                End
                Begin CommandButton
                    OverlapFlags =247
                    Left =4410
                    Top =345
                    Width =432
                    Height =432
                    TabIndex =18
                    Name ="cmdAddGroup"
                    Caption ="Add"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x361ed00fc3228b4db4d2eb7ed17525f7
                    End
                    UnknownProp = {324 ,11 ,2 ,1 ,1 } Begin
                        0x00
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =5820
                    Top =420
                    Width =480
                    TabIndex =19
                    BackColor =10092543
                    Name ="txtGroupType"
                    FontName ="Tahoma"
                    GUID = Begin
                        0xe493a987cb7a234c92c7a416c977b0f3
                    End
                End
                Begin Rectangle
                    OverlapFlags =215
                    Left =60
                    Top =5220
                    Width =6240
                    Height =600
                    Name ="Box23"
                    GUID = Begin
                        0xe9b9ff7d73abe44c8f80e5ae64bd0ac9
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =180
                    Top =3240
                    Width =2280
                    Height =420
                    TabIndex =20
                    Name ="cmdCheckDependentsMissingParent"
                    Caption ="Check for Dependent Issue"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    GUID = Begin
                        0xfb451a9f90e1ee4c94fdf2d4c355ee48
                    End
                    UnknownProp = {324 ,11 ,2 ,1 ,1 } Begin
                        0x00
                    End
                End
                Begin Rectangle
                    OverlapFlags =223
                    Left =60
                    Top =3120
                    Width =6240
                    Height =600
                    Name ="Box25"
                    GUID = Begin
                        0xc11ff1d88f4c994aa11d9438b05eb64c
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =2580
                    Top =3240
                    Width =2460
                    Height =420
                    TabIndex =21
                    Name ="cmdViewDependentsMissingParent"
                    Caption ="View Dependent Issue Records"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    GUID = Begin
                        0x17dc95f1db5fba4fb5ca0feacde271ed
                    End
                    UnknownProp = {324 ,11 ,2 ,1 ,1 } Begin
                        0x00
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =5100
                    Top =3240
                    Width =1140
                    Height =420
                    TabIndex =22
                    Name ="cmdRemoveDepWithIssues"
                    Caption ="Remove"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x1d08a14eb60d384397a79b7e8e87d0b0
                    End
                    UnknownProp = {324 ,11 ,2 ,1 ,1 } Begin
                        0x00
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

' general variables
Dim mstrSQL As String
Dim mstrFileName As String

'  Error handling variables
Dim mintErrNum As Integer
Dim mstrErrDesc As String
Dim mstrErrSrc As String

' processing variables
Dim fCheck As Boolean
Dim fReformat As Boolean
Dim fDSSN As Boolean
Dim lngPlace As Long
Dim lngNext As Long

' Subscriber
Dim strSSN As String
Dim strLName As String
Dim strFname As String
Dim strMI As String
Dim strNameSuf As String
Dim strAddr As String
Dim strAddr2 As String
Dim strCity As String
Dim strState As String
Dim strZip As String
Dim strDOB As String
Dim strGen As String
Dim strEligStart As String
Dim strEligEnd As String

' Dependent
Dim strDSSN As String
Dim strDLName As String
Dim strDFName As String
Dim strDMI As String
Dim strDNameSuf As String
Dim strDAddr As String
Dim strDAddr2 As String
Dim strDCity As String
Dim strDState As String
Dim strDZip As String
Dim strDDOB As String
Dim strDGen As String
Dim strDEligStart As String
Dim strDEligEnd As String
Dim strIns As String

Dim strCovr As String
Dim intTier As Integer
Dim strTier As String
Dim intDepCnt As Integer
Dim strDepCode As String
Dim lngLineCntStart As Long
Dim lngLineCntEnd As Long
Dim lngLineTotal As Long
Dim lngTest As Long
Dim lngCnt As Long
Dim intProc As Integer
Dim fLast As Boolean
Dim intState As Integer

Const conEDI_Import As Integer = 1
Const conQCDStd_Import As Integer = 2
Const conAMSTR_Import As Integer = 3
Const conMRIC_Import As Integer = 4
Const conAA_Import As Integer = 5
Const conDISD_Import As Integer = 6

Private Function Run_sp_EDI(str_spName As String, strGroupID As String, intPlanID As Integer, strUserName As String) As Boolean

        '================================================================================
        ' Object:               Run_sp_EDI_Final
        ' Purpose:              This function runs stored procedures which refresh
        '                       data from groups using the HIPAA ANSI 834
        '                       file format
        '
        ' Stored Procedure
        ' Parameters:           str_spName - stored procedure name passed to function
        '                       GroupID nchar(5)
        '                       PlanID integer
        '                       UserName as nvarchar(20)
        '
        '
        ' Date Created:         4/3/2016
        ' Developer:            John Criswell
        '
        ' Change Log
        ' Date Modified     Developer       Purpose
        ' -------------------------------------------------------------------------------
        ' 2016-04-02      J Criswell        Created
        '
        ' VBA Procedure Parameters:
        ' -------------------------------------------------------------------------------
        ' Same as sp
        '
        ' Returns:
        ' -------------------------------------------------------------------------------
        ' Boolean - sp succeeded or failed
        '
        '=================================================================================


    On Error GoTo PROC_ERR
    
    If g_adoConnection.State = adStateOpen Then g_adoConnection.Close
    With g_adoConnection
         .ConnectionString = SetConnxn
         .Open
    End With
    With g_adoCommand
          .ActiveConnection = g_adoConnection
          .CommandType = adCmdStoredProc
          .CommandText = str_spName
          
          Set g_adoParm = .CreateParameter("@ReturnParm", adInteger, adParamReturnValue) 'Return parm
          .Parameters.Append g_adoParm
          
          Set g_adoParm = .CreateParameter("@GroupID", adChar, adParamInput, 5)
          .Parameters.Append g_adoParm
          .Parameters("@GroupID").Value = strGroupID
          
          Set g_adoParm = .CreateParameter("@PlanID", adInteger, adParamInput)
          .Parameters.Append g_adoParm
          .Parameters("@PlanID").Value = intPlanID
          
          Set g_adoParm = .CreateParameter("@UserName", adVarChar, adParamInput, 20)
          .Parameters.Append g_adoParm
          .Parameters("@UserName").Value = strUserName
          
          .Execute
          
          g_iRtnVal = .Parameters.Item("@ReturnParm")
    End With
    
    g_adoConnection.Close
  
    Set g_adoCommand = Nothing
    Set g_adoConnection = Nothing
    Set g_adoParm = Nothing
    
    Run_sp_EDI = g_iRtnVal
    
PROC_EXIT:
    Exit Function
    
PROC_ERR:
    Run_sp_EDI = False
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.Run_sp_EDI", , True)
    GoTo PROC_EXIT

End Function

Private Function Run_sp_KeyValues(strSQL As String, strUserName As String, strGroupID As String) As Integer

    On Error GoTo PROC_ERR
    
    If g_adoConnection.State = adStateOpen Then g_adoConnection.Close
    With g_adoConnection
         .ConnectionString = SetConnxn
         .Open
    End With
    With g_adoCommand
          .ActiveConnection = g_adoConnection
          .CommandType = adCmdStoredProc
          .Parameters.Refresh
          .CommandText = strSQL
          
          Set g_adoParm = .CreateParameter("@ReturnParm", adInteger, adParamReturnValue) 'Return parm
          .Parameters.Append g_adoParm
          
          Set g_adoParm = .CreateParameter("@UserName", adVarChar, adParamInput, 20)
          .Parameters.Append g_adoParm
          .Parameters("@UserName").Value = strUserName
          
          Set g_adoParm = .CreateParameter("@GroupID", adVarChar, adParamInput, 20)
          .Parameters.Append g_adoParm
          .Parameters("@GroupID").Value = strGroupID
          
          .Execute
          
          g_iRtnVal = .Parameters.Item("@ReturnParm")
    End With
    
    g_adoConnection.Close
  
    Set g_adoCommand = Nothing
    Set g_adoConnection = Nothing
    Set g_adoParm = Nothing
    
    Run_sp_KeyValues = g_iRtnVal
    
PROC_EXIT:
    Exit Function
    
PROC_ERR:
    Run_sp_KeyValues = False
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.Run_sp_KeyValues", , True)
    GoTo PROC_EXIT

End Function

Private Sub cboGroups_AfterUpdate()
  ' Comments   : Enable/disable controls based on group selection
  ' Parameters : None
  ' Created    : 2/28/2004 1:00:20 PM Admin
  ' Modified   :
  '
  ' --------------------------------------------------------
  
  On Error GoTo HandleError
    
    With Me
        .txtGrpID = .cboGroups.Column(0)
        .txtGroup = .cboGroups.Column(1)
        .txtImportSpec = .cboGroups.Column(2)
        .txtGroupType = .cboGroups.Column(4)
        If .txtGroupType = 1 Then
                .txtPlanID = 5
        Else
                .txtPlanID = 0
        End If
'        -- 0 = Community First
'        -- 1 = QCD Only
'        -- 2 = cancelled
'        -- 3 = cancelled
'        -- 4 = All American
'        -- 9 = Individual 1 year
        
        If .cboGroups.Column(2) = conQCDStd_Import Then     ' std QCD non-HIPAA; plan 16 (DANVI)
            .lblHIPAAFile.Visible = False
            .lblSubscriber.Visible = True
            .lblImportFile.Visible = False
            .cmdDepFileSelect.Enabled = True
            .txtDependentFile.Enabled = True
        ElseIf .cboGroups.Column(2) = conEDI_Import Then ' HIPAA ANSI 834; plan 1 (ALDNE & NSISD)
            .lblHIPAAFile.Visible = True
            .lblSubscriber.Visible = False
            .lblImportFile.Visible = False
            .cmdDepFileSelect.Enabled = False
            .txtDependentFile.Enabled = False
        ElseIf .cboGroups.Column(2) = conAMSTR_Import Then ' non-std client defined; plan 16 (AMSTR)
            .lblHIPAAFile.Visible = False
            .lblSubscriber.Visible = False
            .lblImportFile.Visible = True
            .cmdDepFileSelect.Enabled = False
            .txtDependentFile.Enabled = False
        ElseIf .cboGroups.Column(2) = conMRIC_Import Then ' non-std client defined; plan 1 (DISD)
            .lblHIPAAFile.Visible = False
            .lblSubscriber.Visible = False
            .lblImportFile.Visible = True
            .cmdDepFileSelect.Enabled = False
            .txtDependentFile.Enabled = False
        ElseIf .cboGroups.Column(2) = conAA_Import Then ' All American
            .lblHIPAAFile.Visible = False
            .lblSubscriber.Visible = False
            .lblImportFile.Visible = True
            .cmdDepFileSelect.Enabled = False
            .txtDependentFile.Enabled = False
        ElseIf .cboGroups.Column(2) = conDISD_Import Then     ' std QCD non-HIPAA; plan 16 (DANVI)
            .lblHIPAAFile.Visible = False
            .lblSubscriber.Visible = True
            .lblImportFile.Visible = False
            .cmdDepFileSelect.Enabled = True
            .txtDependentFile.Enabled = True
        End If
        
    End With
    
ExitProc:
  Exit Sub

HandleError:
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_frmImportProcessing.cboGroups_AfterUpdate"
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.cboGroups_AfterUpdate", , True)
    Resume ExitProc
  
End Sub

Private Sub cmdAddToDB_Click()
  ' Comments   :  Deletes and inserts QCDOnly and
  '               Individual subscribers and their
  '               dependents into tblSubscr and
  '               tblDependent
  ' Parameters :
  ' Created    : 2/28/2004 1:05:53 PM JCriswell
  ' Modified   :
  '
  ' --------------------------------------------------------
  On Error GoTo HandleError
      
      Dim intResp As Integer
    
      Dim strGrp As String
      Dim intPlanID As Integer
      Dim lngImpS As Long
      Dim lngImpD As Long
      Dim lngCurS As Long
      Dim lngCurD As Long
      Dim lngDelASR As Long
      Dim strMsg As String
      Dim strGrpID As String
      Dim strSQL As String
      Dim proc_name As String
      Dim strUserName As String
            
      Dim db As DAO.Database
      Dim rst As DAO.Recordset
      
      Set db = CurrentDb()
      
      gintProcessStatus = 0
      
      'check the state of processing
      If intState > 1 Then
        gintProcessStatus = 1
      Else
        MsgBox "You must process the text files before you can add the data to the database."
        gintProcessStatus = 0
        GoTo ExitProc
      End If
      
      With Me
        strGrpID = .[txtGrpID]
        intPlanID = .[txtPlanID]
      End With
      
           
      ' the next code block gathers statistics
      ' on how many subscrbers and dependents are
      ' in the database versus the number of
      ' subscribers and dependents in the import file
      ' this data will be displayed in a message box
      
      ' get Import Subscriber count
      strSQL = "SELECT Count(tblEDI_App_Subscr.SUBssn) AS ImpSCnt FROM tblEDI_App_Subscr;"
      Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
      If rst.RecordCount > 0 Then
        lngImpS = rst.Fields("ImpSCnt")
        rst.Close
      Else
        lngImpS = 0
      End If
      ' get Import Dependent Count
      strSQL = "SELECT Count(tblEDI_App_Dep.DEPsubID) AS ImpDCnt FROM tblEDI_App_Dep;"
      Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
      If rst.RecordCount > 0 Then
        lngImpD = rst.Fields("ImpDCnt")
        rst.Close
      Else
        lngImpD = 0
      End If
      
      ' get Current Subscriber count
      strSQL = "SELECT Count(tblSubscr.SUBssn) AS CurSCnt, tblSubscr.SUBgroupID FROM tblSubscr GROUP BY tblSubscr.SUBgroupID " & _
               "HAVING (((tblSubscr.SUBgroupID)='" & [Forms]![frmImportProcessing].[txtGrpID] & "'));"
      Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
      If rst.RecordCount > 0 Then
        lngCurS = rst.Fields("CurSCnt")
        rst.Close
      Else
        lngCurS = 0
      End If
      ' get Current Dependent Count
      strSQL = "SELECT Count(tblDependent.DEPsubID) AS CurDCnt FROM tblSubscr INNER JOIN tblDependent ON tblSubscr.SUBssn = tblDependent.DEPsubID " & _
               "WHERE (((tblSubscr.SUBgroupID)='" & [Forms]![frmImportProcessing].[txtGrpID] & "'));"
      Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
      If rst.RecordCount > 0 Then
        lngCurD = rst.Fields("CurDCnt")
        rst.Close
      Else
        lngCurD = 0
      End If
      
      ' near obsolute code - only for AMSTR
      Select Case Me.txtImportSpec
        Case conEDI_Import
        Case conQCDStd_Import
        Case conAMSTR_Import
          strSQL = "SELECT Count(tblSubscr.SUBssn) AS DelCNT, tblImportFile_ASR_Employees.TRANSACTION_TYPE " & _
                 "FROM tblSubscr INNER JOIN tblImportFile_ASR_Employees ON tblSubscr.SUBssn = tblImportFile_ASR_Employees.SSN " & _
                 "GROUP BY tblImportFile_ASR_Employees.TRANSACTION_TYPE HAVING (((tblImportFile_ASR_Employees.TRANSACTION_TYPE)='T'));"
          Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
          If rst.RecordCount > 0 Then
            lngDelASR = rst.Fields("DelCNT")
            rst.Close
          Else
            lngDelASR = 0
          End If
        Case Is = conMRIC_Import
      End Select
          
      strMsg = "Group: " & Me.cboGroups.Column(1) & vbCrLf & vbCrLf
        
      ' identify the group for the subscriber
      ' and dependent count message
      Select Case Me.txtImportSpec
        Case conEDI_Import
          strMsg = strMsg & "HIPAA File:" & vbCrLf
        Case conQCDStd_Import
          strMsg = strMsg & "QCD Standard Import File:" & vbCrLf
        Case conAMSTR_Import
          strMsg = strMsg & "QCD ASR Import File:" & vbCrLf
        Case conMRIC_Import
          strMsg = strMsg & "QCD Non Standard Import File:" & vbCrLf
        Case conAA_Import
          strMsg = strMsg & "QCD All American File:" & vbCrLf
        Case conDISD_Import
          strMsg = strMsg & "QCD Non Standard Import File:" & vbCrLf
      End Select
      
      strMsg = strMsg & "Subscribers - " & CStr(lngImpS) & vbCrLf
      
      ' near obsolete code (only for AMSTR)
      Select Case Me.txtImportSpec
        Case conEDI_Import
        Case conQCDStd_Import
        Case conAMSTR_Import
          strMsg = strMsg & "Subscriber Deletes (T) - " & CStr(lngDelASR) & vbCrLf
        Case conMRIC_Import
        Case conAA_Import
        Case conDISD_Import
      End Select
      
      strMsg = strMsg & "Dependents - " & CStr(lngImpD) & vbCrLf & vbCrLf
      strMsg = strMsg & "Current Counts: " & vbCrLf
      strMsg = strMsg & "Subscribers - " & CStr(lngCurS) & vbCrLf
      strMsg = strMsg & "Dependents - " & CStr(lngCurD) & vbCrLf & vbCrLf
      strMsg = strMsg & "Are you sure you want to perform this update? " & vbCrLf
      strMsg = strMsg & "This procedure cannot be undone!"
      ' end of message code block
      gintProcessStatus = 1
      
      '   *****  start the commit to database   *****
      intResp = MsgBox(strMsg, vbQuestion + vbYesNo + vbDefaultButton2, "QCD: Confirm Action")
      If intResp = vbYes Then
            DoCmd.Hourglass True
            DoCmd.SetWarnings False
            
            'delete existing subscribers in tblSubscr before import
            Select Case Me.txtImportSpec
                Case conEDI_Import
                    'ExecuteSQL "usp_DelEDISubscr " & strGrpID
                Case conQCDStd_Import
                    'ExecuteSQL "usp_DelEDISubscr " & strGrpID
                Case conAMSTR_Import
'                    db.Execute ("DELETE tblSubscr.*, " & _
'                    "tblImportFile_ASR_Employees.TRANSACTION_TYPE " & _
'                    "FROM tblSubscr " & _
'                    "INNER JOIN tblImportFile_ASR_Employees " & _
'                    "ON tblSubscr.SUBssn = tblImportFile_ASR_Employees.SSN " & _
'                    "WHERE (((tblImportFile_ASR_Employees.TRANSACTION_TYPE)='T'));"), dbSeeChanges
                Case conMRIC_Import
                    'nothing
                Case Else
                    ' All Others -
                    '              flag the subscriber records to be deleted and then delete them;
                    '              the dependents will go too because cascade delete will get rid of them
                    db.Execute ("UPDATE tblSubscr " & _
                                "INNER JOIN tblEDI_App_Subscr " & _
                                "ON tblSubscr.SUBssn = tblEDI_App_Subscr.SUBssn " & _
                                "SET tblSubscr.Flag = Null;"), dbSeeChanges
                    db.Execute ("UPDATE tblSubscr " & _
                                "INNER JOIN tblEDI_App_Subscr " & _
                                "ON tblSubscr.SUBssn = tblEDI_App_Subscr.SUBssn " & _
                                "SET tblSubscr.Flag = True;"), dbSeeChanges
                    db.Execute ("DELETE tblSubscr.* FROM tblSubscr WHERE (((tblSubscr.Flag)=True));"), dbSeeChanges
                    '              delete the remaining subscribers who were
                    '              not in the new import file;
                    '              cascade delete will get the dependents
                    db.Execute ("DELETE tblSubscr.* FROM tblSubscr WHERE ((tblSubscr.SUBgroupID) = '" & strGrpID & "');"), dbSeeChanges
            End Select
            
            Set db = Nothing
            gintProcessStatus = 1
                    
            ' get current user name
            strUserName = GetCurrentUserName()
                    
            ' populate tblSubscr and tblDependent
            proc_name = "usp_EDI_App_Final"
            With Me
                If Run_sp_EDI(proc_name, strGrpID, intPlanID, strUserName) Then
                    gintProcessStatus = 1
                Else
                    gintProcessStatus = 0
                    GoTo HandleError
                End If
            End With
            
            ' populate SubClassKeys on tblSubscr
            proc_name = "usp_SubClassKey"
            With Me
                If Run_sp_KeyValues(proc_name, strUserName, strGrpID) Then
                    gintProcessStatus = 1
                Else
                    gintProcessStatus = 0
                    GoTo HandleError
                End If
            End With
            
            ' populate EIMBRID on tblSubscr
            proc_name = "usp_EIMBRID_Sub"
            With Me
                If Run_sp_KeyValues(proc_name, strUserName, strGrpID) Then
                    gintProcessStatus = 1
                Else
                    gintProcessStatus = 0
                    GoTo HandleError
                End If
            End With
            
            ' populate EIMBRID on tblDependent
            proc_name = "usp_EIMBRID_Dep"
            With Me
                If Run_sp_KeyValues(proc_name, strUserName, strGrpID) Then
                    gintProcessStatus = 1
                Else
                    gintProcessStatus = 0
                    GoTo HandleError
                End If
            End With
            
          If gintProcessStatus = 1 Then
            MsgBox "The Add Group to Database process succeeded.", vbOKOnly, "QCD: Import customer files."
          Else
            GoTo HandleError
          End If
    
          DoCmd.SetWarnings True
          DoCmd.Hourglass False
          
          With Me
            .cboGroups = ""
            .txtMainFile = ""
            .txtDependentFile = ""
            .txtGroup = ""
            .txtStatus = ""
          End With
          
          intState = 3
      End If
    
ExitProc:
    gintProcessStatus = 0
    With Me
        .cboGroups = ""
        .txtMainFile = ""
        .txtDependentFile = ""
        .txtGroup = ""
        .txtStatus = ""
    End With
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub

HandleError:
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_frmImportProcessing.cmdAddToDB_Click"
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.cmdAddToDB_Click", , True)
    Resume ExitProc
End Sub

Private Sub cmdCheckDependentsMissingParent_Click()

    Dim lngParCnt As Long
    Dim strSQL As String
    Dim db As DAO.Database
    Dim rst As DAO.Recordset
      
    Set db = CurrentDb()
      
    ' Check for Dependents Missing Parent Records
    strSQL = "SELECT Count(*) as ParCnt FROM tblEDI_App_Dep WHERE DepSubID NOT IN (select SubSSN FROM tblEDI_App_Subscr)"
    Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
    If rst.RecordCount > 0 Then
      lngParCnt = rst.Fields("ParCnt")
      rst.Close
    End If
    Set db = Nothing
    
    If lngParCnt > 0 Then
        MsgBox "There are Dependent Records on the Table that are missing Subscriber Records.  Please View the issues before processing.", vbCritical, "Dependent Issues"
    Else
        MsgBox "No issues found", vbInformation, "No Issues"
    End If
    
End Sub

Private Sub cmdDepFileSelect_Click()

    On Error GoTo Err_cmdDepFileSelect_Click

    Dim strFileName As String
    Dim strFile As String

    strFile = GetOpenFile_TSB("C:\My Documents", "Select Dependent Import File")
  
    If Not IsNull(strFile) Then
        Me.txtDependentFile = strFile
        strFileName = strFile
        intProc = 1
    End If

Exit_cmdDepFileSelect_Click:

    Me.cmdDepFileSelect.SetFocus
    Exit Sub

Err_cmdDepFileSelect_Click:
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_frmImportProcessing.cmdDepFileSelect_Click"
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.Form_frmImportProcessing.cmdDepFileSelect_Click", , True)
    Resume Exit_cmdDepFileSelect_Click

End Sub


Private Sub cmdPrintCards_Click()

    On Error GoTo Err_cmdPrintCards_Click
    
    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset
    Dim strResponse As String
    Dim strDocName As String
    Dim strGroupID As String
    Dim strSQL As String
    Dim intSubsWithMissingEffDates As Integer
    Dim intGroupType As Integer
    Dim strUserName As String

    Set dbs = CurrentDb()

    strUserName = GetCurrentUserName()
    strGroupID = Me.txtGrpID                 'Forms![frmGrp]![ctlGROUPid]
    intGroupType = Me.txtGroupType           'Forms![frmGrp]![optgrpGroupType]

    'figure out what type of group it is and print the appropriate card
    Select Case intGroupType
        Case 1
            strDocName = "rptCardMemGrp"
        Case 2
            strDocName = ""
        Case 3
            strDocName = ""
        Case 4
            strDocName = "rptCardMemAA"
    End Select

    'count how many subscribers have no effective dates
    'for purposes of warning the user that there are
    'subscribers with no effective dates; the effective
    'date gets printed on the card
    strSQL = "SELECT tblSubscr.SubSSN, tblSubscr.SubGroupID, " & _
             "tblSubscr.SubEffDate " & _
             "FROM tblSubscr " & _
             "WHERE (((tblSubscr.SubGroupID)='" & strGroupID & "') " & _
             "AND ((tblSubscr.SubEffDate) Is Null));"

    Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
    If rst.RecordCount > 0 Then
        rst.MoveLast
        intSubsWithMissingEffDates = rst.RecordCount
    Else
        intSubsWithMissingEffDates = 0
    End If

    'warn the user about the subscribers with missing effective dates
    If rst.RecordCount > 0 Then
        strResponse = MsgBox("The effective date on the membership cards are printed " & vbCrLf & _
            "from the group subscribers' effective dates. " & vbCrLf & vbCrLf & _
            "There are " & intSubsWithMissingEffDates & " subscribers in this group who do not have effective " & vbCrLf & _
            "dates.  You must enter effective dates for these " & intSubsWithMissingEffDates & vbCrLf & _
            "subscribers before printing membership cards for this group.", vbCritical, "Missing Subscriber Effective Dates")
        GoTo Exit_cmdPrintCards_Click
    End If
    

    'print those cards not previously printed for the group being processed
    strSQL = "SELECT tblSubscr.SubSSN, tblSubscr.SubGroupID, " & _
             "tblSubscr.SubStatus, tblSubscr.SubEffDate, " & _
             "tblSubscr.SubCardPrt, tblSubscr.SubCardPrtDte " & _
             "FROM tblSubscr " & _
             "WHERE (((tblSubscr.SubGroupID)='" & strGroupID & "') " & _
             "AND (tblSubscr.SubStatus)='GRSUB') AND ((tblSubscr.SubCardPrt)=0) " & _
             "ORDER BY tblSubscr.SubGroupID;"

        'don't do anything if no one in the database needs to have a card printed
        Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
        If rst.RecordCount > 0 Then

            'print not previously printed cards
            ExecuteSQL "DELETE FROM tmpEDI_rpt"
            strSQL = "INSERT INTO tmpEDI_Rpt ( SUBssn , SUBfirstNAME , " & _
                        "SUBlastNAME , SUBStreet , SUBcity , SUBstate , " & _
                        "SUBzip , GroupID ) " & _
                        "SELECT tblSubscr.SubSSN , tblSubscr.SubFirstName ," & _
                        " tblSubscr.SubLastName , [SubStreet1] + ' ' + " & _
                        "[SubStreet2] AS Street , tblSubscr.SubCity , " & _
                        "tblSubscr.SubState , tblSubscr.SubZip , tblSubscr.SubGroupID " & _
                        "FROM tblSubscr " & _
                        "WHERE (((tblSubscr.SubStatus)='GRSUB') AND ((tblSubscr.SubCardPrt)=0) " & _
                        "AND ((tblSubscr.SubGroupID)='" & strGroupID & "'));"
                        
            ExecuteSQL strSQL

            'run the report that prints the card
            DoCmd.OpenReport strDocName, acViewNormal, , "[GroupID] = '" & strGroupID & "' And [SubCardPrt] Is Null" & " Or [SubCardPrt] = 0"
            DoCmd.SetWarnings False
                 
            
            'update the subscriber table indicated that the card was
            'printed, the date it was printed, and who printed it
            strSQL = "UPDATE tblSubscr " & _
                        "SET SubCardPrt = 1, SubCardPrtDte = CONVERT(varchar(10), GetDate(), 101), " & _
                        "UserName = '" & strUserName & "', " & _
                        "ModifyDate = CONVERT(varchar(10), GetDate(), 101), " & _
                        "DateUpdated = CONVERT(varchar(10), GetDate(), 101) " & _
                        "WHERE SubStatus = 'GRSUB' AND SubCardPrt = 0 AND SubGroupID = '" & strGroupID & "'"
                        
            
            ExecuteSQL strSQL
            DoCmd.SetWarnings True
            MsgBox "Cards sent to the printer!", vbExclamation, "Cards Printed"
            
            'clean up tmpEDI_rpt
            ExecuteSQL "TRUNCATE TABLE tmpEDI_rpt"
            
        Else

            MsgBox "No subscribers to be printed!", vbExclamation, "No subscribers."

        End If
  

    rst.Close
    Set rst = Nothing
    dbs.Close
    Set dbs = Nothing

Exit_cmdPrintCards_Click:
    Exit Sub

Err_cmdPrintCards_Click:
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_frmImportProcessing.cmdPrintCards_Click"
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.Form_frmImportProcessing.cmdPrintCards_Click", , True)
    Resume Exit_cmdPrintCards_Click
End Sub



Private Sub cmdPrintNewSubscr_Click()
  ' Comments   : Prints a report of new subscribers
  ' Parameters : None
  ' Created    : 2/28/2004 1:31:11 PM Admin
  ' Modified   :
  '
  ' --------------------------------------------------------
  On Error GoTo HandleError
  
    DoCmd.SetWarnings False
    ExecuteSQL ("DELETE FROM tmpEDI_rpt")

    ExecuteSQL ("UPDATE tblEDI_App_Subscr SET tblEDI_App_Subscr.SUBcardPRT = 0, " & _
                   "tblEDI_App_Subscr.DateCreated = GetDate() " & _
                   "FROM tblEDI_App_Subscr " & _
                   "LEFT JOIN tblSubscr ON tblEDI_App_Subscr.SUBssn = tblSubscr.SUBssn " & _
                   "WHERE (((tblSubscr.SUBssn) Is Null))")
    DoCmd.OpenQuery "qrpt_EDI_NewSubs"
    DoCmd.OpenQuery "qrpt_EDI_GrpSubs"
    DoCmd.OpenQuery "qrpt_EDI_IndivSubs"
    'Added for ASR Changes
    DoCmd.OpenQuery "qrpt_EDI_ChangeSubs"
    
    DoCmd.OpenReport "rptEDI_NewSubscribers", acViewPreview
    DoCmd.SetWarnings True

ExitProc:
  Exit Sub

HandleError:
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_frmImportProcessing.cmdPrintNewSubscr_Click"
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.Form_frmImportProcessing.cmdPrintNewSubscr_Click", , True)
    Resume ExitProc
       
End Sub

Private Sub cmdProcess_Click()
  ' Comments   :
  ' Parameters :
  ' Created    : 2/28/2004 1:34:00 PM Admin
  ' Modified   :
  '
  ' --------------------------------------------------------
  On Error GoTo HandleError

    Dim fCheck As Boolean
    Dim strImport As String
    strImport = Nz(Me.txtImportSpec, "")
            
    Select Case strImport
        Case Is = conEDI_Import
            fCheck = ProcessEDISpec
        Case Is = conQCDStd_Import
            fCheck = ProcessQCDStandardSpec
'        Case Is = conMRIC_Import
'            fCheck = ProcessMRICSpec
'        Case Is = conDISD_Import
'            fCheck = ProcessDISDSpec
    End Select

    If fCheck = True Then
        Me.txtStatus = "File processing complete"
        intState = 2
    Else
        Me.txtStatus = "Import Errors!  Call support!"
        intState = 0
    End If

ExitProc:
  Exit Sub

HandleError:
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_frmImportProcessing.cmdProcess_Click"
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.Form_frmImportProcessing.cmdProcess_Click", , True)
    Resume ExitProc

End Sub
Private Sub cmdSubFileSelect_Click()

    On Error GoTo Err_cmdSubFileSelect_Click

    Dim strFileName As String
    Dim strFile As String

    strFile = GetOpenFile_TSB("C:\My Documents", "Select Import File")
  
    If Not IsNull(strFile) Then
        Me.txtMainFile = strFile
        strFileName = strFile
        mstrFileName = strFile
        intProc = 1
    End If
    
    intState = 1

Exit_cmdSubFileSelect_Click:
    Me.cmdSubFileSelect.SetFocus
    Exit Sub

Err_cmdSubFileSelect_Click:
    MsgBox Err.Description
    Resume Exit_cmdSubFileSelect_Click
    
End Sub
Private Function ProcessQCDStandardSpec() As Boolean
    
    On Error GoTo Err_ProcessQCDStandardSpec_Click
    
    Dim fRetVal As Boolean
    Dim strSQL As String
    Dim strFilter As String
    Dim lngFlags As Long
    Dim varFileName As Variant
    Dim varOpenfile As Variant
    Dim varFilter As Variant
    Dim varDialogTitle As Variant
    Dim strFileName As String
    Dim strDir As String
    Dim strSpec As String
    Dim strTableName As String
    Dim aQueries() As Variant
    
    'move data from text files to standard temp tables
    strSpec = "QCDStandardSubscriber"
    strTableName = "QCDStandardSubscriber"
    strDir = GetCurrentPath_TSB()
    strFileName = Me.txtMainFile

    'clean out temp tables
    strSQL = "DELETE FROM " & strTableName
    ExecuteSQL (strSQL)
    
    varFileName = Me.txtMainFile
    DoCmd.TransferText acImportDelim, strSpec, strTableName, strFileName, 0
    
    strSpec = "QCDStandardDependent"
    strTableName = "QCDStandardDependent"
    strDir = GetCurrentPath_TSB()
    strFileName = Me.txtDependentFile
    
    'clean out temp tables
    strSQL = "DELETE FROM " & strTableName
    ExecuteSQL (strSQL)
    
    varFileName = Me.txtDependentFile
    DoCmd.TransferText acImportDelim, strSpec, strTableName, strFileName, 0

    ' process the data
    mstrSQL = "usp_import_standard"
    Call GetOutPutParm(mstrSQL)
    If g_sRtnVal = "Procedure Succeeded" Then
        MsgBox "standard import succeeded", vbInformation, "QCD: standard import"
        gintProcessStatus = 1
        ProcessQCDStandardSpec = True
    Else
        MsgBox "standard import failed; call support", vbInformation, "QCD: standard import"
        gintProcessStatus = 0
        ProcessQCDStandardSpec = False
    End If
    
Exit_ProcessQCDStandardSpec_Click:
    Exit Function
    
Err_ProcessQCDStandardSpec_Click:
    ProcessQCDStandardSpec = False
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_frmImportProcessing.ProcessQCDStandardSpec"
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.Form_frmImportProcessing.ProcessQCDStandardSpec", , True)
    Resume Exit_ProcessQCDStandardSpec_Click
    
End Function
Private Function ProcessAMSTR() As Boolean

    On Error GoTo Err_ProcessAMSTR_Click

    Dim strFileName As String
    Dim strFile As String
    Dim intProc As Integer
    Dim TextLine As String
    Dim strPath As String
    Dim strSpec As String
    Dim strTableName As String
    Dim strPlan As String

    If Me.txtMainFile = "" Or IsNull(Me.txtMainFile) = True Then
        MsgBox "Please select the file to process to continue.", vbExclamation, "QCD: Import Error"
        Exit Function
    End If

    strFile = Me.txtMainFile  ''GetOpenFile_TSB("C:\My Documents", "Select import file")
    strPath = GetPathPart_TSB(strFile)
    
    If Not IsNull(strFile) Then
        If FileExists_TSB(strPath & "Employees.txt") Then
            Kill strPath & "Employees.txt"
        End If
        
        If FileExists_TSB(strPath & "Dependents.txt") Then
            Kill strPath & "Dependents.txt"
        End If
    End If
    
    If Not IsNull(strFile) Then
        'Me.txtFileToProcess = strFile
        strFileName = strFile
        intProc = 1
    End If
    
    Open strFileName For Input As #1                    ' Open file for input.
    Open strPath & "Employees.txt" For Output As #2     ' Open file for output.
    Open strPath & "Dependents.txt" For Output As #3    ' Open file for output.
    Do While Not EOF(1)                                 ' Loop until end of file.
        Line Input #1, TextLine                         ' Read line into variable.
        strPlan = Mid(TextLine, 11, 3)
        If strPlan = "QCD" Then                         'it's an employee
            Print #2, TextLine                          'write the text string to a temporary text file
        Else                                            'it's a dependent
            Print #3, TextLine                          'write the text string to another temporary text file
        End If
    Loop
    
    Close #3                                            ' Close file.
    Close #2                                            ' Close file.
    Close #1                                            ' Close file.
        
    If FileExists_TSB(strFileName) = True Then
        ReDim aQueries(0 To 1) As Variant
        aQueries(0) = "qdelImportTemp_ASRE"
        aQueries(1) = "qdelImportTemp_ASRD"
        If RunQuery("", aQueries()) = True Then
            strSpec = "ImportGroupSpec_ASRE"
            strTableName = "tblImportFile_ASR_Employees"
            strFileName = strPath & "Employees.txt"
            DoCmd.TransferText acImportDelim, strSpec, strTableName, strFileName, 0
            Kill strPath & "Employees.txt"
            
            strSpec = "ImportGroupSpec_ASRD"
            strTableName = "tblImportFile_ASR_Dependents"
            strFileName = strPath & "Dependents.txt"
            DoCmd.TransferText acImportDelim, strSpec, strTableName, strFileName, 0
            Kill strPath & "Dependents.txt"
            
            DoCmd.Hourglass True
            DoCmd.SetWarnings False
            DoCmd.RunSQL "DELETE * FROM tblEDI_App_Subscr"
            DoCmd.RunSQL "DELETE * FROM tblEDI_App_Dep"
            ReDim aQueries(0 To 3) As Variant
            aQueries(0) = "qappASR_EDI_Subscr"
            aQueries(1) = "qappASR_EDI_Deps"
            aQueries(2) = "qupdEDISubRates"
            aQueries(3) = "qupdEDI_SubscriberOther"
            
            If RunQuery("", aQueries()) = True Then
                         
            End If
            DoCmd.SetWarnings True
            DoCmd.Hourglass False
        
        Else
            GoTo Err_ProcessAMSTR_Click
        End If
        
    End If
   
    ProcessAMSTR = True
   
Exit_ProcessAMSTR_Click:
    Exit Function

Err_ProcessAMSTR_Click:
    ProcessAMSTR = False
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_frmImportProcessing.ProcessAMSTR"
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.ProcessAMSTR", , True)
    Resume Exit_ProcessAMSTR_Click


End Function

Private Function ProcessMRICSpec()

    On Error GoTo Err_ProcessMRICSpec_Click

    Dim strFileName As String
    Dim strFile As String
    Dim intProc As Integer
    Dim TextLine As String
    Dim strPath As String
    Dim strSpec As String
    Dim strTableName As String
    Dim strPlan As String

    If Me.txtMainFile = "" Or IsNull(Me.txtMainFile) = True Then
        MsgBox "Please select the file to process to continue.", vbExclamation, "QCD: Import Error"
        Exit Function
    End If

    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    strFile = Me.txtMainFile  ''GetOpenFile_TSB("C:\My Documents", "Select import file")
    strPath = GetPathPart_TSB(strFile)
    
    If Not IsNull(strFile) Then
        If FileExists_TSB(strPath & "Employees.txt") Then
            Kill strPath & "Employees.txt"
        End If
        
        If FileExists_TSB(strPath & "Dependents.txt") Then
            Kill strPath & "Dependents.txt"
        End If
    End If
    
    If Not IsNull(strFile) Then
        'Me.txtFileToProcess = strFile
        strFileName = strFile
        intProc = 1
    End If
    
    Open strFileName For Input As #1                    ' Open file for input.
    Open strPath & "Employees.txt" For Output As #2     ' Open file for output.
    Open strPath & "Dependents.txt" For Output As #3    ' Open file for output.
    Do While Not EOF(1)                                 ' Loop until end of file.
        Line Input #1, TextLine                         ' Read line into variable.
        strPlan = Mid(TextLine, 11, 8)
        If strPlan = "Employee" Then                         'it's an employee
            Print #2, TextLine                          'write the text string to a temporary text file
        Else                                            'it's a dependent
            Print #3, TextLine                          'write the text string to another temporary text file
        End If
    Loop
    
    Close #3                                            ' Close file.
    Close #2                                            ' Close file.
    Close #1                                            ' Close file.
        
    If FileExists_TSB(strFileName) = True Then
        ReDim aQueries(0 To 1) As Variant
        aQueries(0) = "qdelImportTemp_MRIC_Sub"
        aQueries(1) = "qdelImportTemp_MRIC_Dep"
        If RunQuery("", aQueries()) = True Then
            strSpec = "ImportGroupSpec_MRIC_Emp"
            strTableName = "tblImportFile_MRIC_Employees"
            strFileName = strPath & "Employees.txt"
            DoCmd.TransferText acImportDelim, strSpec, strTableName, strFileName, 0
            Kill strPath & "Employees.txt"
            
            strSpec = "ImportGroupSpec_MRIC_Dep"
            strTableName = "tblImportFile_MRIC_Dependents"
            strFileName = strPath & "Dependents.txt"
            DoCmd.TransferText acImportDelim, strSpec, strTableName, strFileName, 0
            Kill strPath & "Dependents.txt"
            
            ' Move to Staging and add additional information
            DoCmd.RunSQL "DELETE * FROM tblEDI_App_Subscr"
            DoCmd.RunSQL "DELETE * FROM tblEDI_App_Dep"
            ReDim aQueries(0 To 1) As Variant
            aQueries(0) = "qappMRIC_EDI_Subscr"
            aQueries(1) = "qappMRIC_EDI_Deps"
            If RunQuery("", aQueries()) = True Then
                DoCmd.RunSQL "Update tblEDI_App_Subscr Set SUBgroupID ='" & Me.txtGrpID & "'"
            End If
            
            ReDim aQueries(0 To 2) As Variant
            aQueries(0) = "qupdEDISubPlan_MRIC"  ' removed PLAN ID update
            aQueries(1) = "qupdEDI_RateID"       ' update the RateID's
            aQueries(2) = "qupdEDI_SubscriberOther"
            If RunQuery("", aQueries()) = True Then
            
            End If
                
        Else
            GoTo Err_ProcessMRICSpec_Click
        End If
        
    End If
   
    ProcessMRICSpec = True
   
Exit_ProcessMRICSpec_Click:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Function

Err_ProcessMRICSpec_Click:
    ProcessMRICSpec = False
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_frmImportProcessing.ProcessMRICSpec"
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.ProcessMRICSpec", , True)
    Resume Exit_ProcessMRICSpec_Click

End Function

Private Function ProcessDISDSpec()

    On Error GoTo Err_ProcessDISDSpec_Click

    Dim fRetVal As Boolean
    Dim strSQL As String
    Dim strFilter As String
    Dim lngFlags As Long
    Dim varFileName As Variant
    Dim varOpenfile As Variant
    Dim varFilter As Variant
    Dim varDialogTitle As Variant
    Dim strFileName As String
    Dim strDir As String
    Dim strSpec As String
    Dim strTableName As String
    Dim aQueries() As Variant
  
    If Me.txtMainFile = "" Or IsNull(Me.txtMainFile) = True Then
        MsgBox "Please select the Employee file to process to continue.", vbExclamation, "QCD: Import Error"
        Exit Function
    End If
    If Me.txtDependentFile = "" Or IsNull(Me.txtDependentFile) = True Then
        MsgBox "Please select the Dependent file to process to continue.", vbExclamation, "QCD: Import Error"
        Exit Function
    End If
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    'process subscribers
    strSpec = "QCDStandardSubscriber_MRIC"
    strTableName = "QCD_Subscriber_DISD"
    strDir = GetCurrentPath_TSB()
    strFileName = Me.txtMainFile

    varFileName = Me.txtMainFile
  
    If Not IsNull(varFileName) Then
        strFileName = varFileName
        ReDim aQueries(0) As Variant
        aQueries(0) = "qdelImportTemp_DISD_Sub"
        If RunQuery("", aQueries()) = True Then
            DoCmd.TransferText acImportFixed, strSpec, strTableName, strFileName, 0 'move data from text file to QCDStandardSubscriber
            Call ConvertDISDSubRates            'changes the SubRates field to match QCD cover codes
            ExecuteSQL ("TRUNCATE TABLE tblEDI_App_Subscr")
            ReDim aQueries(0 To 1) As Variant
            aQueries(0) = "qappSubscriber_DISD" 'move data from QCDStandardsubscriber to tblEDI_App_Subscr
            aQueries(1) = "qupdEDI_RateID"      'update the RateID's
            
            If RunQuery("", aQueries()) = True Then
               ExecuteSQL ("UPDATE tblEDI_App_Subscr SET tblEDI_App_Subscr.DateUpdated = GetDate() " & _
                               "FROM tblEDI_App_Subscr INNER JOIN tblGrp ON tblGrp.GroupID = tblEDI_App_Subscr.SUBgroupID")
               ExecuteSQL ("UPDATE tblEDI_App_Subscr " & _
                                "SET tblEDI_App_Subscr.SubID = tblSubscr.SubID, " & _
                                "tblEDI_App_Subscr.SUBcardPRT = tblSubscr.SUBcardPRT, " & _
                                "tblEDI_App_Subscr.SUBcardPRTdte = tblSubscr.SUBcardPRTdte, " & _
                                "tblEDI_App_Subscr.SUBnotes = tblSubscr.SUBnotes, " & _
                                "tblEDI_App_Subscr.DateCreated = tblSubscr.DateCreated " & _
                                "FROM tblEDI_App_Subscr " & _
                                "INNER JOIN tblSubscr ON tblEDI_App_Subscr.SUBssn = tblSubscr.SUBssn")
            Else
                GoTo Err_ProcessDISDSpec_Click
            End If
        Else
            GoTo Err_ProcessDISDSpec_Click
        End If
    End If
    
    'process dependents
    strSpec = "QCDStandardDependent_MRIC"
    strTableName = "QCD_Dependents_DISD"
    strDir = GetCurrentPath_TSB()
    strFileName = Me.txtDependentFile

    varFileName = Me.txtDependentFile
  
    If Not IsNull(varFileName) Then
        strFileName = varFileName
        ExecuteSQL ("TRUNCATE TABLE QCD_Dependents_DISD")
            DoCmd.TransferText acImportFixed, strSpec, strTableName, strFileName, 0
            ExecuteSQL ("TRUNCATE TABLE tblEDI_App_Dep")
            ReDim aQueries(0) As Variant
            aQueries(0) = "qappDependent_DISD"
            If RunQuery("", aQueries()) = True Then
            Else
                GoTo Err_ProcessDISDSpec_Click
            End If
    End If

    ProcessDISDSpec = True
       
Exit_ProcessDISDSpec_Click:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Function

Err_ProcessDISDSpec_Click:
    ProcessDISDSpec = False
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_frmImportProcessing.ProcessDISDSpec"
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.ProcessDISDSpec", , True)
    Resume Exit_ProcessDISDSpec_Click

End Function
Private Function ProcessEDISpec() As Boolean

    On Error GoTo HandleError
    
    Dim RetVal As Variant
    Dim Connxn As String
    Dim ProcessEDI As String
    Dim EDIFile As String
    Dim GroupID As String
    Dim PlanID As Integer
    Dim strUserName As String
    Dim WshShell As Object
    
    ' open progress form
    DoCmd.OpenForm "frmProcessing"
    DoEvents
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    ' load variables
      With Me
            GroupID = .txtGrpID
            PlanID = .txtPlanID
            strUserName = GetCurrentUserName()
      End With
    
    'run command line program to preprocess EDI file
    EDIFile = """" & Me.txtMainFile & """"
    Connxn = """" & SetNETConnxn() & """"
    ProcessEDI = "F:\EDI\QCDProcessEDI.exe" & " " & Connxn & " " & EDIFile & " False"
    Set WshShell = CreateObject("WScript.Shell")
    RetVal = WshShell.Run(ProcessEDI, 0, True) ' Run the Console App and wait for it to complete processing
    ' run stored procedure
    If RetVal = 0 Then
        If Run_sp_EDI("usp_EDI_ExportData", GroupID, PlanID, strUserName) Then
            MsgBox "The file processing succeeded.", vbInformation, "EDI Import:  Process succeeded"
            ProcessEDISpec = True
        Else
            GoTo HandleError
        End If
    Else
        GoTo HandleError
    End If

ExitProc:
    DoCmd.Close acForm, "frmProcessing"
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Application.Echo True
    DoEvents
    Exit Function

HandleError:
    ProcessEDISpec = False
    Call LogError(Err.Number, Err.Description, "Form_frmImportProcessing.ProcessEDISpec", , True)
    MsgBox "Error number:  " & Err.Number & vbCrLf & _
        "Description:  " & Err.Description & vbCrLf & _
        "Error source: Form_frmImportProcessing.ProcessEDISpec", vbCritical, "Import Process: Import Error"
   Resume ExitProc

End Function

Private Function GetDepCnt(strSSN As String) As String
    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset
    Dim strSQL As String
    Set dbs = CurrentDb()
    
    strSQL = "Select Count(*) AS Cnt FROM tblEDI_Dep_Import Where [Primary SSN] ='" & strSSN & "' AND [Dependent Code] <> '01';"
    Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
    If rst.RecordCount > 0 Then
        GetDepCnt = "0" & rst.Fields("Cnt") + 2
    End If
    
End Function
Private Function GetSubTierCode(strSSN As String) As String
    
    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset
    Dim strSQL As String
    
    Set dbs = CurrentDb()
    strSQL = "SELECT tblEDI_Subscr_Import.[Primary SSN], tblEDI_Subscr_Import.[Tier Code] " & _
             "FROM tblEDI_Subscr_Import " & _
             "WHERE (((tblEDI_Subscr_Import.[Primary SSN])='" & strSSN & "'));"
    Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
    If rst.RecordCount > 0 Then
        rst.MoveFirst
        GetSubTierCode = rst.Fields("Tier Code")
        rst.Close
    Else
        GetSubTierCode = "NOIMPORT"
    End If
    
    Set dbs = Nothing
    
End Function
Private Sub ConvertDISDSubRates()

    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset
    Dim strSQL As String
    Dim strSubRate As String
    Dim strCoverCode As String

    Set dbs = CurrentDb()
    strSQL = "SELECT QCD_Subscriber_DISD.SubSSN, " & _
             "QCD_Subscriber_DISD.SubRate " & _
             "FROM QCD_Subscriber_DISD;"
    Set rst = dbs.OpenRecordset(strSQL)
    Do While Not rst.EOF
        
        strSubRate = rst.Fields("SubRate")
        Select Case strSubRate
            Case "E"
                strCoverCode = "I"
            Case "S"
                strCoverCode = "O"
            Case "C"
                strCoverCode = "C"
            Case "F"
                strCoverCode = "F"
            Case Else
                strCoverCode = "N"
        End Select
        
        rst.Edit
        rst.Fields("SubRate") = strCoverCode
        rst.Update
        rst.MoveNext
    Loop

    rst.Close
    Set rst = Nothing
    dbs.Close
    Set dbs = Nothing


End Sub

Private Sub cmdViewDependentsMissingParent_Click()

    DoCmd.OpenQuery "qsel_ViewDependentRecordsIssues", acViewNormal

End Sub

Private Sub Form_Load()
    
    With Me
        .txtMainFile = ""
        .txtDependentFile = ""
    End With
    
    intState = 0
    
End Sub
Private Sub cmdClose_Click()
On Error GoTo Err_cmdClose_Click


    DoCmd.Close

Exit_cmdClose_Click:
    Exit Sub

Err_cmdClose_Click:
    MsgBox Err.Description
    Resume Exit_cmdClose_Click
    
End Sub
Private Sub cmdAddGroup_Click()
On Error GoTo Err_cmdAddGroup_Click

    Dim stDocName As String
    Dim stLinkCriteria As String

    stDocName = "fdlgManageImportGroups"
    DoCmd.OpenForm stDocName, , , stLinkCriteria

Exit_cmdAddGroup_Click:
    Exit Sub

Err_cmdAddGroup_Click:
    MsgBox Err.Description
    Resume Exit_cmdAddGroup_Click
    
End Sub
Private Sub cmdRemoveDepWithIssues_Click()

    DoCmd.SetWarnings False
    DoCmd.OpenQuery "qdel_DependentRecordIssues"
    DoCmd.SetWarnings True
    
    MsgBox "The records were removed.", vbInformation, "Complete"
        
End Sub