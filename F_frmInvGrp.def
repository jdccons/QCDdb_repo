Version =20
VersionRequired =20
Checksum =394615109
Begin Form
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    Width =9420
    ItemSuffix =129
    Left =585
    Top =600
    Right =10005
    Bottom =6345
    RecSrcDt = Begin
        0x26f762421076e440
    End
    GUID = Begin
        0x98f8f4f9ac820641b4ef89f97eb30820
    End
    NameMap = Begin
        0x0acc0e5500000000f0913de709be63418753d8ebd94a1a65000000007bf60d7a ,
        0xd4b1e44000000000000000007100660072006d0049006e007600470072007000 ,
        0x0000000000003b552f51a15a3246901a7c14ffe6393801000000dba7e3d921bc ,
        0xe440ffffff3f00000000660073007500620049006e0076004700720070000000 ,
        0x000000001d611e90a9a1af46a49d7ca2491bf328000000005841f918b8b1e440 ,
        0x000000005c02005e71007200790049006e0076004c0069006e00000000000000 ,
        0x75258fb9db7e0c4fa61a78345264af39070000001d611e90a9a1af46a49d7ca2 ,
        0x491bf328430055005300540020004b00450059000000000000005dd9f7d07c2b ,
        0x7f4ab6b08c0d2792203407000000f0913de709be63418753d8ebd94a1a654300 ,
        0x55005300540020004b00450059000000000000001ae03749916bf24a8566a4a3 ,
        0x61f6b6ea07000000f0913de709be63418753d8ebd94a1a654300550053005400 ,
        0x20004e0041004d004500000000000000f19941449feb154c9ea34e9dee4db911 ,
        0x07000000f0913de709be63418753d8ebd94a1a65410044004400520045005300 ,
        0x53002000310000000000000096debd002e7c69449e6722d189f8bc1507000000 ,
        0xf0913de709be63418753d8ebd94a1a6541004400440052004500530053002000 ,
        0x3200000000000000e879be30f51a0f4c87ab1a0f411ed30f07000000f0913de7 ,
        0x09be63418753d8ebd94a1a654300490054005900000000000000938685b85aa9 ,
        0x444294d7da346896cea907000000f0913de709be63418753d8ebd94a1a655300 ,
        0x54004100540045000000000000007868deb34adb70498202f09f8f6a66d30700 ,
        0x0000f0913de709be63418753d8ebd94a1a655a0049005000200043004f004400 ,
        0x45000000000000009af3d990e5640e498a5cbd67b50667df07000000f0913de7 ,
        0x09be63418753d8ebd94a1a6541005400540045004e00540049004f004e000000 ,
        0x000000003f2318d8f5fcd349b83c7dee94214c0d07000000f0913de709be6341 ,
        0x8753d8ebd94a1a655400520041004e00530020004e004f000000000000000895 ,
        0x42ae657c154fb99fb25840d8a3e707000000f0913de709be63418753d8ebd94a ,
        0x1a6549004e005600200044004100540045000000000000006720789d2e6cbb44 ,
        0x941eb83e934d14bc07000000f0913de709be63418753d8ebd94a1a6543004f00 ,
        0x4d004d0020004f005600520044000000000000001342eb778ea8fc4fb098cf7d ,
        0x3b0bf86807000000f0913de709be63418753d8ebd94a1a655400450052005200 ,
        0x490054004f005200590020004b0045005900000000000000a58a4c9ca30e2d4a ,
        0xa2023b909e7a6e2307000000f0913de709be63418753d8ebd94a1a6553005900 ,
        0x530044004f00430049004400000000000000aa334a372d6e364bb97b19edeea3 ,
        0xab8d07000000f0913de709be63418753d8ebd94a1a6552006500630055007300 ,
        0x650072004900440000000000000037e602b889c67845ae1661dd709d360b0700 ,
        0x0000f0913de709be63418753d8ebd94a1a65520065006300540069006d006500 ,
        0x0000000000007e03c38934016e4b905e9fca781742e407000000f0913de709be ,
        0x63418753d8ebd94a1a6552006500630044006100740065000000000000002b33 ,
        0x5bbe88bb1344955af87c8f51614b07000000f0913de709be63418753d8ebd94a ,
        0x1a654300550053005400200043004c00410053005300000000000000438da926 ,
        0x8fd2ef4eac658e3f4b975ac401000000c0a0ad82d4b1e44020004b0045005900 ,
        0x7300660072006d004100670065006e0074007300410041000000000000003096 ,
        0xeee65d6eb64681e15dff331869bb00000000efe76380d4b1e4400dd872752800 ,
        0x0000710072007900470072007000410067007400000000000000e6f050c3c812 ,
        0x35429572882d3592049b070000003096eee65d6eb64681e15dff331869bb4700 ,
        0x52004f0055005000690064000000000000001db0ac608f078b438637843b8638 ,
        0x62c70600000098f8f4f9ac820641b4ef89f97eb3082066007300750062004900 ,
        0x6e00760047007200700000000000000000000000000000000000000000000000 ,
        0x0c000000030000000000000000000000000000000000
    End
    RecordSource ="qfrmInvGrp"
    Caption ="Invoice Entry - QCD Only"
    OnCurrent ="[Event Procedure]"
    MenuBar ="InvoiceQCD"
    PrtMip = Begin
        0xd002000038040000d0020000d002000000000000a02900004029000001000000 ,
        0x010000006801000000000000a10700000100000000000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00fc020367000001000100ea0a6f086400010001002c0101000100 ,
        0x2c01020001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200c000fc020000ac13d8c00000000000000000000000000000000000000000 ,
        0x0000000000000000050000000000070000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000c0000000534d544a ,
        0x000000001000b000530065006e006400200074006f0020004d00690063007200 ,
        0x6f0073006f006600740020004f006e0065004e006f0074006500200031003500 ,
        0x20004400720069007600650072000000524553444c4c00556e69726573444c4c ,
        0x00506170657253697a65004c4554544552004f7269656e746174696f6e00504f ,
        0x525452414954005265736f6c7574696f6e0044504936303000436f6c6f724d6f ,
        0x646500323462707000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08002c0041000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x006e756c3a00
    End
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin FormHeader
            Height =450
            BackColor =12632256
            Name ="FormHeader0"
            GUID = Begin
                0x81ff2aa7740dad45aecf462dda315c4c
            End
            Begin
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =1440
                    Top =120
                    Width =1020
                    Name ="INPUT_DATE"
                    Format ="m/d/yyyy"
                    AfterUpdate ="[Event Procedure]"
                    InputMask ="99/99/0000;0;_"
                    OnLostFocus ="[Event Procedure]"
                    GUID = Begin
                        0x7b98c450f6f10b4eac97c5387b4eb101
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =3
                            Left =135
                            Top =120
                            Width =1245
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="Label124"
                            Caption ="Input Date: "
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0xc48810d7ffb5804bb39370c04efcffd0
                            End
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =2550
                    Top =135
                    Width =4815
                    Height =255
                    Name ="Label126"
                    Caption ="Enter an invoice date and click File>Create Invoices"
                    GUID = Begin
                        0xbdd23a4b7f28d748bfe0a519c8f18e0b
                    End
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =4560
            BackColor =12632256
            Name ="Detail Section"
            EventProcPrefix ="Detail_Section"
            GUID = Begin
                0x8467ff9e715ca643a15ba0e433543be4
            End
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =120
                    Top =615
                    Width =1251
                    Height =300
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text5"
                    Caption ="Group Name: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xb9d511bfc5f1794bb5aeea44a8dfa1e7
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =215
                    TextAlign =3
                    Left =126
                    Top =891
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text6"
                    Caption =" Address: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xe7bcb1a9b10bb2479fd261d2c5462636
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =126
                    Top =1148
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text7"
                    Caption ="Address 2: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x1e744314737c0c4e89bed3ee41e45cd7
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =135
                    Top =1455
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text8"
                    Caption ="City: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x5e55f92e3ed9544dad85c509964fc75c
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1455
                    Top =631
                    Width =2466
                    TabIndex =2
                    BackColor =12632256
                    Name ="CUST NAME"
                    ControlSource ="CUST NAME"
                    EventProcPrefix ="CUST_NAME"
                    GUID = Begin
                        0xb9658d2c2767c04aa4eed456aa56b6d6
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1455
                    Top =907
                    Width =2463
                    TabIndex =3
                    BackColor =12632256
                    Name ="ADDRESS 1"
                    ControlSource ="ADDRESS 1"
                    EventProcPrefix ="ADDRESS_1"
                    GUID = Begin
                        0x72548744bcdaf0429fb669d965b37a97
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1455
                    Top =1183
                    Width =2463
                    TabIndex =4
                    BackColor =12632256
                    Name ="ADDRESS 2"
                    ControlSource ="ADDRESS 2"
                    EventProcPrefix ="ADDRESS_2"
                    GUID = Begin
                        0xcabdf69c02476349a9524b5be05fe3d6
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1455
                    Top =1455
                    Width =1728
                    TabIndex =5
                    BackColor =12632256
                    Name ="CITY"
                    ControlSource ="CITY"
                    GUID = Begin
                        0xef11a3f19a730f4e9cde2d0042c412cb
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1470
                    Top =1744
                    Width =357
                    Height =225
                    TabIndex =6
                    BackColor =12632256
                    Name ="STATE"
                    ControlSource ="STATE"
                    GUID = Begin
                        0xdcf7850c7323c64f927ac9ed55cbbe49
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =3
                            Left =780
                            Top =1740
                            Width =651
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="Text9"
                            Caption ="State: "
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0x33c23cf32afb13459ccffdb62b0293d9
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =2565
                    Top =1725
                    Width =1008
                    Height =210
                    TabIndex =7
                    BackColor =12632256
                    Name ="ZIP CODE"
                    ControlSource ="ZIP CODE"
                    InputMask ="00000\\-9999;;_"
                    EventProcPrefix ="ZIP_CODE"
                    GUID = Begin
                        0xcf1718ed23ee9a45a3640b4b79e5f37f
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =3
                            Left =1965
                            Top =1725
                            Width =576
                            Height =225
                            FontWeight =700
                            BackColor =12632256
                            Name ="Text10"
                            Caption ="Zip: "
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0xfe1378af550b574f9d5dfb6c8d62a530
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1470
                    Top =2040
                    Width =2448
                    TabIndex =8
                    BackColor =12632256
                    Name ="ATTENTION"
                    ControlSource ="ATTENTION"
                    GUID = Begin
                        0xbc65456dfcbe11459788f3b61d77f0aa
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =3
                            Left =165
                            Top =2053
                            Width =1251
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="Text65"
                            Caption ="Attn: "
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0x9e22379fa0c88e4bb264b6f743a95a16
                            End
                        End
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =4155
                    Top =120
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text67"
                    Caption ="Invoice No: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x4116388083d39249a51eb1bb7e8b589a
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =5565
                    Top =105
                    Width =1020
                    TabIndex =9
                    BackColor =12632256
                    Name ="TRANS NO"
                    ControlSource ="TRANS NO"
                    EventProcPrefix ="TRANS_NO"
                    GUID = Begin
                        0xcd2a79a74d7a68468b35558d3bb0ca9a
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =15
                    Top =60
                    Width =1365
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text69"
                    Caption ="Invoice Date: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x80a6df5cd099cc498b3f8e7338fbc052
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =1455
                    Top =79
                    Width =1020
                    BackColor =12632256
                    Name ="INV DATE"
                    ControlSource ="INV DATE"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0000;0;_"
                    EventProcPrefix ="INV_DATE"
                    GUID = Begin
                        0xfd1f3e139ab4824392b9ebfea5f1d9e0
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8295
                    Top =2310
                    Width =1020
                    TabIndex =10
                    BackColor =8454143
                    Name ="COMM OVRD"
                    ControlSource ="COMM OVRD"
                    EventProcPrefix ="COMM_OVRD"
                    GUID = Begin
                        0x3d1c8fdd9839894285e795b9e554c9e4
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =4155
                    Top =435
                    Width =1350
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text73"
                    Caption ="Territory/GEO: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xe878e6c730527041aa49ba1ce8722535
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =5565
                    Top =420
                    Width =1020
                    TabIndex =11
                    BackColor =12632256
                    Name ="TERRITORY KEY"
                    ControlSource ="TERRITORY KEY"
                    EventProcPrefix ="TERRITORY_KEY"
                    GUID = Begin
                        0xf97306446604b3468684f7134931907a
                    End
                End
                Begin Subform
                    OverlapFlags =85
                    Left =1455
                    Top =2370
                    Width =6669
                    Height =1920
                    TabIndex =12
                    Name ="fsubInvGrp"
                    SourceObject ="Form.fsubInvGrp"
                    LinkChildFields ="CUST KEY"
                    LinkMasterFields ="CUST KEY"
                    GUID = Begin
                        0x1db0ac608f078b438637843b863862c7
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =150
                    Top =315
                    Width =1251
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text102"
                    Caption ="Plt Cust Key: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x4ff084e6a10ff64fa3b9aa419cef1696
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    TextAlign =1
                    Left =6675
                    Top =435
                    Width =2685
                    TabIndex =13
                    BackColor =12632256
                    Name ="TERRITORY NAME"
                    ControlSource ="=DLookUp(\"[GEODESC]\",\"tblGeographical\",\"[GEOid] = Forms![frmInvGrp]![TERRIT"
                        "ORY KEY]\")"
                    EventProcPrefix ="TERRITORY_NAME"
                    GUID = Begin
                        0x0a28422007271b4abd12a6c8fe1f564d
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3240
                    Top =105
                    Width =288
                    Height =288
                    FontSize =8
                    TabIndex =14
                    Name ="Bulk Invoices"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    EventProcPrefix ="Bulk_Invoices"
                    GUID = Begin
                        0x83b5bba6ef4517428ed6d26f4b0610ff
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8325
                    Top =2625
                    Width =1020
                    Height =216
                    TabIndex =15
                    BackColor =65535
                    Name ="txtSYSDOCID"
                    ControlSource ="SYSDOCID"
                    GUID = Begin
                        0x8cac14882699d241a637175604d79806
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8325
                    Top =2910
                    Width =1020
                    Height =216
                    TabIndex =16
                    BackColor =65535
                    Name ="txtRecUserID"
                    ControlSource ="RecUserID"
                    GUID = Begin
                        0xe03e2ed3569f2f42b531aa808248222a
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8355
                    Top =3450
                    Width =1020
                    Height =216
                    TabIndex =17
                    BackColor =65535
                    Name ="txtRecTime"
                    ControlSource ="RecTime"
                    Format ="Long Time"
                    GUID = Begin
                        0xd9ec3e025fcd514b8472ff4579c2d6c9
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8355
                    Top =3735
                    Width =1020
                    Height =216
                    TabIndex =18
                    BackColor =65535
                    Name ="txtRecDate"
                    ControlSource ="RecDate"
                    Format ="Short Date"
                    GUID = Begin
                        0xd09217088fac584eac724ca57d2c32d0
                    End
                End
                Begin Subform
                    Locked = NotDefault
                    OverlapFlags =85
                    SpecialEffect =2
                    Left =4155
                    Top =975
                    Width =4875
                    Height =1215
                    TabIndex =19
                    Name ="sfrmAgentsAA"
                    SourceObject ="Form.sfrmAgentsAA"
                    LinkChildFields ="GROUPid"
                    LinkMasterFields ="CUST KEY"
                    GUID = Begin
                        0x8f2e6ed492f700468f2f9cda1d6f7cf1
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =8325
                    Top =3165
                    Width =1020
                    Height =216
                    TabIndex =20
                    BackColor =65535
                    Name ="CUST CLASS"
                    ControlSource ="CUST CLASS"
                    EventProcPrefix ="CUST_CLASS"
                    GUID = Begin
                        0x898aa1d2a88c5846ab5582a27c441c74
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =4155
                    Top =705
                    Width =870
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label123"
                    Caption ="Agents: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x96d53c86f37e1b4da00d672535290f73
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =1455
                    Top =355
                    Width =1008
                    TabIndex =1
                    BackColor =12632256
                    Name ="CUST KEY"
                    ControlSource ="CUST KEY"
                    EventProcPrefix ="CUST_KEY"
                    GUID = Begin
                        0x0f4f4da328a4f54f95c16dc8f2fa906a
                    End
                End
            End
        End
        Begin FormFooter
            Height =750
            BackColor =12632256
            Name ="FormFooter1"
            GUID = Begin
                0x2f03ff77ba5c4741a37dea2c64f4b550
            End
            Begin
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =93
                    Left =6540
                    Top =90
                    Width =1332
                    BackColor =12632256
                    Name ="INVOICE TOTAL"
                    ControlSource ="=fsubInvGrp.Form!SubTotal"
                    Format ="$#,##0.00;($#,##0.00)"
                    EventProcPrefix ="INVOICE_TOTAL"
                    GUID = Begin
                        0x7fbce8f0171a024c9655888adbffbaf4
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =87
                    TextAlign =3
                    Left =5190
                    Top =90
                    Width =1335
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text92"
                    Caption ="Invoice Total: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xbd3dca27f04fe241821ad7c989fda154
                    End
                End
                Begin Line
                    LineSlant = NotDefault
                    BorderWidth =1
                    OverlapFlags =85
                    Left =5220
                    Top =360
                    Width =2640
                    Height =15
                    Name ="Line97"
                    GUID = Begin
                        0x249b1179b79a6c4dbe82204c174aa88c
                    End
                End
                Begin Line
                    LineSlant = NotDefault
                    BorderWidth =1
                    OverlapFlags =85
                    Left =5220
                    Top =390
                    Width =2640
                    Height =15
                    Name ="Line98"
                    GUID = Begin
                        0x03735b15a4a0b04999a8d1ab7235c7cb
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3693
                    Width =288
                    Height =288
                    FontSize =8
                    TabIndex =1
                    Name ="btnPostAlltoPlat"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x4ea83f3a8bbda1479c999e2446aabc5d
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =3399
                    Width =288
                    Height =288
                    TabIndex =2
                    Name ="btnPrintInvoices"
                    GUID = Begin
                        0xd562f22cda60b44b8bd9ece75badc737
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =3105
                    Width =288
                    Height =288
                    TabIndex =3
                    Name ="btnPrtInvQCDRate"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xf59e9a85ce3e334c874891ad8936793d
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit

'Declare module level global variables
Dim mstrCustKey As String
Dim mstrTranNo As String
Dim mlngSysDocId As Long
Dim mdteInvoiceDate As Date
Function Export_Invoice_Data(dteInvoiceDate As Date) As Integer

    Dim strSQL As String
    strSQL = "usp_QCDOnlyInvoice_csv"
    If g_adoConnection.STATE = adStateOpen Then g_adoConnection.Close
    With g_adoConnection
         .ConnectionString = SetConnxn
         .Open
    End With
    With g_adoCommand
          .ActiveConnection = g_adoConnection
          .CommandType = adCmdStoredProc
          .CommandText = strSQL
          Set g_adoParm = .CreateParameter("@ReturnParm", adInteger, adParamReturnValue) 'Return parm
          .Parameters.Append g_adoParm
          Set g_adoParm = .CreateParameter("@InvoiceDate", adDate, adParamInput)
          .Parameters.Append g_adoParm
          .Parameters("@InvoiceDate").Value = dteInvoiceDate
          .Execute
          g_iRtnVal = .Parameters.Item("@ReturnParm")
    End With
    
    g_adoConnection.Close
  
    Set g_adoCommand = Nothing
    Set g_adoConnection = Nothing
    Set g_adoParm = Nothing
    
    Export_Invoice_Data = g_iRtnVal
  
End Function
' post QCD Only Invoices to QuickBookks
Public Sub btnPostAlltoPlat_Click()
'Purpose:  Posts all group invoices to Platinum
'Programmer:  Suzanne Johnsen
'Date Created:  9/21/99

'Updated by:  John Criswell
'Date Updated:  1/14/00
'Reason:  Overall code clean-up

'Updated by:  John Criswell
'Date Updated:  9/14/2014
'Reason:  changed processing code to stored procedures

'Updated by:  John Criswell
'Date Updated:  7/26/2015
'Reason:  added stored procedure to create csv file for QuickBooks

  On Error GoTo PROC_ERR
  
    Dim dteInvoiceDate As Date
    Dim strGroupType As String
    Dim strInput As String
    
    strGroupType = "QCD Only"
    strInput = InputBox("Enter an invoice date.")
     
    Do While Not IsDate(strInput)
         strInput = InputBox("The date you entered is not a valid date." & vbCrLf & "Please re-enter a valid invoice date")
    Loop
    
    dteInvoiceDate = CDate(strInput)
    
   'check to see if any invoices being posted were posted before
    If AreAnyInvoicesInPlat(dteInvoiceDate, strGroupType) Then
       MsgBox "One or more of the invoices you are trying to post already exist in the QB transaction table.  Please remove these transactions and start over."
       GoTo PROC_EXIT
    Else
      'Nothing
    End If
     
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
       
   ' process invoices in pre condition
   ' and insert them into ARTRANH_local (post)
    ExecuteSQL "usp_InvoicePostGroup" & " '" & dteInvoiceDate & "', " & "'" & strGroupType & "'"
   
   ' Check ARTRANH_local
   ' to insure data was transferred correctly
    If DidAllInvoicesPosttoPlat() Then
        MsgBox "All invoices posted to QuickBooks holding table."
    Else
        MsgBox "At least one invoice did not post to QuickBooks holding table."
        GoTo PROC_EXIT
    End If
    
     ' create csv file for importing into QuickBooks
    If Export_Invoice_Data(dteInvoiceDate) = 1 Then
        MsgBox "invoice data export succeeded."
    Else
        MsgBox "invoice data export failed."
    End If
       
    ' remove data from form
    DoCmd.OpenQuery "qdelDelInvHdr_all"
    Forms![frmInvGrp].Requery
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False

  Exit Sub
  
PROC_EXIT:
  DoCmd.SetWarnings True
  DoCmd.Hourglass False
  Exit Sub

PROC_ERR:
  
  MsgBox "There was an error processing QCD Only invoices." & vbCrLf & _
    vbCrLf & "The error number is: " & Err.Number & " and the system Error message is: " & Err.DESCRIPTION, vbCritical, "Export Error"
  
  Resume PROC_EXIT:
End Sub
Public Sub Bulk_Invoices_Click()
  
  On Error GoTo PROC_ERR
  
    Dim strSQL As String
    Dim strGroupType As String
    Dim dteInvoiceDate As Date
    Dim strUserName As String
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    
    
    If IsNull(Me.INPUT_DATE) Or Me.INPUT_DATE = "" Then
        MsgBox "Input date required."
        Me.INPUT_DATE.SetFocus
    Else
        dteInvoiceDate = Me.INPUT_DATE
        
        ' save the date entered in INPUT_DATE
        Call SaveInvoiceDate(dteInvoiceDate)
        
        ' run stored procedure to populate
        ' temporary invoice tables
        strGroupType = "QCD Only"
        strUserName = GetCurrentUserName()
        strSQL = "usp_InvoicePreGroup '" & dteInvoiceDate & "', " & "'" & strGroupType & "', " & "'" & strUserName & "'"
        ExecuteSQL strSQL
    End If
    
    Forms![frmInvGrp].Requery
    Me.Refresh
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
  
  Exit Sub
  
PROC_EXIT:
  DoCmd.SetWarnings True
  DoCmd.Hourglass False
  Exit Sub
    
PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
End Sub
Private Sub Form_Current()

    With Forms![frmInvGrp]
        INPUT_DATE = GetInvoiceDate()
    End With
    
End Sub

Private Sub Form_Load()
    Forms![frmInvGrp].[INPUT_DATE].SetFocus
End Sub
Private Sub INPUT_DATE_AfterUpdate()

    On Error GoTo PROC_ERR

    Dim dteInputDate As Date
    
    If IsNull(Forms!frmInvGrp.[INPUT_DATE]) Then
        MsgBox "You must populate the INPUT_DATE field."
        Forms!frmInvGrp.[INPUT_DATE].SetFocus
        GoTo PROC_EXIT
    Else
        dteInputDate = Me.INPUT_DATE
    End If
    
    'dteInputDate = Me.INPUT_DATE
    Call SaveInvoiceDate(dteInputDate)
    
Exit Sub
    
PROC_EXIT:
  Exit Sub
    
PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next
    
End Sub

Private Sub INPUT_DATE_LostFocus()
    Call INPUT_DATE_AfterUpdate
End Sub

Public Sub btnPrtInvQCDRate_Click()

On Error GoTo Err_btnPrtInvQCDRate_Click

    Dim strDocName As String
    Dim strCriteria As String
    Dim dteInvoiceDate As Date
    Dim strGroupType  As String
    
    strGroupType = "QCD Only"
    
    If IsNull(Forms!frmInvGrp.[INPUT_DATE]) Or Forms!frmInvGrp.[INPUT_DATE] = "" Then
        MsgBox "You must populate the INPUT_DATE field."
        Forms!frmInvGrp.[INPUT_DATE].SetFocus
        GoTo Exit_btnPrtInvQCDRate_Click
    Else
        dteInvoiceDate = Me.INPUT_DATE
    End If
    
    strCriteria = "[ARTRANH_local].[Spare3] = '" & strGroupType & "' And " & "[DocumentDate] = #" & dteInvoiceDate & "#"
        
    strDocName = "rptInv"
    DoCmd.OpenReport strDocName, acPreview, , strCriteria

Exit_btnPrtInvQCDRate_Click:
    Exit Sub

Err_btnPrtInvQCDRate_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_btnPrtInvQCDRate_Click
    
End Sub