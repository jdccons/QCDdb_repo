Version =20
VersionRequired =20
Checksum =386811525
Begin Form
    AutoResize = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    ShortcutMenu = NotDefault
    NavigationButtons = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =4980
    DatasheetFontHeight =10
    ItemSuffix =16
    Left =7872
    Top =684
    Right =13140
    Bottom =3384
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xf83462b8dcbae240
    End
    Caption ="Print Cards"
    MenuBar ="Dialog"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00682243cf800701000100ea0a6f08640001000f00fdff02000100 ,
        0x0000020001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x020000001e010000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200b008ec0a7c1784174da20000000000000000000000000000000000000000 ,
        0x00000000000000004c0000000000000000000000000000000000000000000000 ,
        0x0000000004000000000000000000000000000100010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000100 ,
        0x0100000001000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000010000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000b0080000534d544a ,
        0x000000001000a008480050002000440065007300690067006e006a0065007400 ,
        0x2000540031003200300030007000730020004800500047004c0032000000496e ,
        0x70757442696e00464f524d534f5552434500524553444c4c00556e6972657344 ,
        0x4c4c004850474c325f50414c45545445534f555243455f434f4d4d414e445300 ,
        0x5472756500485053656e644a6f6241734269746d6170004f626a6563744d6f64 ,
        0x65004850456e61626c6552415753706f6f6c696e670054727565004850526570 ,
        0x6f72745051546f4170706c69636174696f6e005472756500485041626f757446 ,
        0x69726d776172650054727565004f7269656e746174696f6e00504f5254524149 ,
        0x540053454e445f504150455253495a455f504a4c00547275650048504c61796f ,
        0x757454797065005374616e646172640048505053446f63756d656e744f707469 ,
        0x6f6e730041637475616c53697a6500485050534175746f5363616c696e67004f ,
        0x666600506170657253697a65004c4554544552004850436f6e73756d65724375 ,
        0x73746f6d5061706572004850437573746f6d0048505072696e746572436c6173 ,
        0x7300485044657369676e4a65740048504f4f565072696e745072657669657700 ,
        0x54727565004d656469615479706500414e590048504e55736544696666466972 ,
        0x73745061676543686f69636500547275650048504e57617465726d61726b0054 ,
        0x727565005265736f6c7574696f6e00363030647069004465766963655265736f ,
        0x6c7574696f6e00363030647069005072696e745175616c69747947726f757000 ,
        0x505147726f75705f31005072696e745175616c6974790046617374004850536c ,
        0x6964657200536c6964657231004850446f6350726f705265736f757263654461 ,
        0x746100687069686c37736d2e6361620048504d6178696d756d44657461696c00 ,
        0x44697361626c656400485045636f6e6f6d6f64650044697361626c6564004850 ,
        0x5472616e7376657273650046616c7365004d696e696d756d5265736f6c757469 ,
        0x6f6e00333030647069004850526564756365645265736f6c7574696f6e004175 ,
        0x746f0048504d696e5265736f6c7574696f6e4269675375726661636573003735 ,
        0x6470690048504175746f726f746174650046616c736500485053696d706c6966 ,
        0x696564554900547275650048504c6f63616c4d65646961486973746f72790054 ,
        0x72756500485050757265426c61636b416e645768697465005472756500485043 ,
        0x6f6c6f724f7074696f6e7300436f6c6f72004850494344506170657253697a65 ,
        0x547265657669657700385f38004850494344505153657474696e677300537461 ,
        0x6e646172644f7074696f6e73004850494344526f6c6c5769647468436f6e7472 ,
        0x6f6c0046726f6d5072696e7465720048504943444d6564696154797065547265 ,
        0x6576696577436f756e740038004850496e707574436f6c6f7253706163650053 ,
        0x524742004850436f6c6f724d676d744f7074696f6e73005072696e7465724d61 ,
        0x6e61676564436f6c6f7273004850436f6c6f724d676d74005352474200485045 ,
        0x6d756c617465645072696e7465727300454d554c415445445052494e54455253 ,
        0x5f44554d4d595f4f5054494f4e0048504d6972726f725072696e740046616c73 ,
        0x6500485053617665526f6c6c50617065720046616c736500485044697361626c ,
        0x654175746f4375747465720046616c7365004850416476436f6c6f7241646a75 ,
        0x73746d656e74730046616c7365004850416476616e63656441646a73746d656e ,
        0x747352616e67650054727565005053416c69676e6d656e7446696c6500485049 ,
        0x4c5337736d004850536d61727448756200496e65745f5349445f3236335f4249 ,
        0x445f3531345f4849445f3236350048504d656469615479706554726565766965 ,
        0x77506f7075700054727565004850436f6c6f724d6f646500434f4c4f525f4d4f ,
        0x444500455350524954537570706f72746564005472756500485050444c547970 ,
        0x650050444c5f4850474c320048504d61785265736f6c7574696f6e0050444d5f ,
        0x31323030445049004850504a4c456e636f64696e6700555446380048504a6f62 ,
        0x4163636f756e74696e670048504a4f42414343545f4a4f4241434e545f434f4c ,
        0x4f52415554480048504f76657273697a655061706572537570706f7274656400 ,
        0x5472756500485050617065724d617267696e56616c7565536865657400313432 ,
        0x5f3134325f3134325f34383200485050617065724d617267696e56616c756552 ,
        0x6f6c6c003134325f3134325f3134325f31343200485050617065724d61726769 ,
        0x6e56616c756544656661756c74003134325f3134325f3134325f313432004850 ,
        0x436f6e73747261696e747300547275650048504e6f437573746f6d4d65646961 ,
        0x537570706f727400547275650048504a6f6242794a6f624f7665727269646500 ,
        0x4a424a4f00436f6c6f724d6f646500323462707000485052656d6f76654d6172 ,
        0x67696e734265747765656e50616765730046616c736500485042696469496e70 ,
        0x757442696e00526f6c6c310048505072696e74576974684d617267696e730053 ,
        0x74616e64617264004850426f726465726c657373004175746f4f666600485041 ,
        0x63636f756e74696e67546162446973706c61790048504163636f756e74494400 ,
        0x4850456e61626c6543726f704c696e65730046616c7365004850455753507269 ,
        0x6e74507265766965770046616c7365004e756d6265726f66526f6c6c73003200 ,
        0x505353657276696365734f7074696f6e00446f63756d656e746174696f6e5f53 ,
        0x49445f3238395f4249445f3838385f4849445f3135353138004850584d4c4669 ,
        0x6c65557365640068706974313231762e786d6c00000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000007c1700004955504815000100789ced99df6bd35014c7bf99 ,
        0x3f187b992022224840f471c80c458d28218d5b597575ed9ce27ce84c7485ae29 ,
        0xed66abf8a00f22fe0bfe09fa0ff8d847ff005fc557e95fe09b7ecf4d02594a8b ,
        0xb86174bb9fcb49cebdf7dc7bcf4d9adb9c9b97a781a257593c0503c214e51825 ,
        0xca451c49e90693af8e53cad688db9411609b294007e330309c09a7819f19a48f ,
        0xe3635bfd1e46e62c9c995fda556fe2215a0829011eed713ccdff87beff871b87 ,
        0x6b53037534f37644930b16a512ebc9ffc46030d87546aa5ec41fe9e5d5cd4963 ,
        0x1899fc2cd324aa7840a9c1c3ed89769a83ca75ae4b3b7c730ab1c5b5699b2bd4 ,
        0x63dcc8db29cd01c018a30bb33867a4cfd93a91a371fed3f9e86c4d4792f457c0 ,
        0x25261f6dfe66ffd43f197dd4038d46a3d16834870dfd3aa0d92bb2475d51fb3d ,
        0x2dc65426f3a23f53fbd32636196d7555f9136a527219f3d8a08594d5f946dbce ,
        0x7b02a418c784320713abf458bcefc28617cfe479bc9b69d336a0ff3b78ca14cd ,
        0x316dbf48adc93995d9d706cbeaaaed2a4b7c15732676e9360eebb6d4d80d75ad ,
        0x3aca3254b511364ab8a3f62e5668ed522be11e7336f565d654792c336ff2b88c ,
        0x055566c7d1ee26c769c5d16ee4819ff1b9461b19d964bb0e6755579ebc886364 ,
        0x99b7adfa75d96339d7fba4d1fcabc8b739f9c6d66d377b61af60cd05fd40ca8d ,
        0xbf20c93e422269bfb231bf645d5cc33ad6d49ae3f309eff1e95fa7b4b976f554 ,
        0xbe000b735c21fa08f6f93a6934e328551cb7b8b256ac2e3835d7a994ceda1f6f ,
        0xbdb5be7bafbf7cbb72f2aebd34d2a0f1feeb9b8b3fbc771786573f9ce87fde4f ,
        0x5fe4fbf97006b8cf07fb17153995bd0000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000
    End
    PrtDevNames = Begin
        0x080023003e000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000004850 ,
        0x44657369676e6a65745431323030506f737453637269707400
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin Section
            Height =2700
            BackColor =-2147483633
            Name ="Detail"
            GUID = Begin
                0xb0ae89ecaa6b584aa84b2bd2dd3a13d6
            End
            Begin
                Begin OptionGroup
                    OverlapFlags =85
                    Left =960
                    Top =360
                    Width =3065
                    Height =1200
                    Name ="optGrpPrintCards"
                    DefaultValue ="1"
                    GUID = Begin
                        0xbda22a777eb4cd488a768277bf03906c
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            Left =1560
                            Top =240
                            Width =1140
                            Height =240
                            BackColor =-2147483633
                            Name ="Cards to print"
                            Caption ="Cards to print:"
                            EventProcPrefix ="Cards_to_print"
                            GUID = Begin
                                0xfb902f65d0f4a6468ed27f2988a994e0
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =1560
                            Top =720
                            OptionValue =1
                            Name ="optPrintAll"
                            GUID = Begin
                                0x3d53fe310ac46f49949278f204627df9
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =1790
                                    Top =690
                                    Width =645
                                    Height =240
                                    Name ="Label6"
                                    Caption ="Print all"
                                    GUID = Begin
                                        0x9c8f799f9aa263499568717884363a19
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =1560
                            Top =1140
                            OptionValue =2
                            Name ="optNotPrevPrinted"
                            GUID = Begin
                                0x059bbb4e6abe5648b9fc41833b2989cf
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =1790
                                    Top =1110
                                    Width =2175
                                    Height =240
                                    Name ="Label9"
                                    Caption ="Print not previously printed"
                                    GUID = Begin
                                        0x60dea077a5272043a38d75f8acd162ca
                                    End
                                End
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =2400
                    Top =1800
                    Width =1260
                    Height =479
                    TabIndex =1
                    Name ="cmdCancel"
                    Caption ="Cancel"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x369a5480323a7c47a58b43295a1a121f
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =900
                    Top =1800
                    Width =1260
                    Height =479
                    TabIndex =2
                    Name ="cmdPrint"
                    Caption ="Print"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xa34cd6b7cfb5ca43b2c1eed981e2ca77
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Private Sub cmdPrint_Click()

On Error GoTo Err_cmdPrint_Click
    
    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset
    Dim strResponse As String
    Dim strDocName As String
    Dim strGroupID As String
    Dim strSQL As String
    Dim intSubsWithMissingEffDates As Integer
    Dim intGroupType As Integer
    Dim strUserName As String


    Set dbs = CurrentDb()

    strUserName = GetCurrentUserName()
    strGroupID = Forms![frmGrp]![ctlGROUPid]
    intGroupType = Forms![frmGrp]![optgrpGroupType]

    'figure out what type of group it is and print the appropriate card
    Select Case intGroupType
        Case 1
            strDocName = "rptCardMemGrp"
        Case 2
            strDocName = ""
        Case 3
            strDocName = ""
        Case 4
            strDocName = "rptCardMemAA"
    End Select

    'count how many subscribers have no effective dates
    'for purposes of warning the user that there are
    'subscribers with no effective dates; the effective
    'date gets printed on the card
    strSQL = "SELECT tblSubscr.SubSSN, tblSubscr.SubGroupID, " & _
             "tblSubscr.SubEffDate " & _
             "FROM tblSubscr " & _
             "WHERE (((tblSubscr.SubGroupID)='" & strGroupID & "') " & _
             "AND ((tblSubscr.SubEffDate) Is Null));"

    Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
    If rst.RecordCount > 0 Then
        rst.MoveLast
        intSubsWithMissingEffDates = rst.RecordCount
    Else
        intSubsWithMissingEffDates = 0
    End If

    'warn the user about the subscribers with missing effective dates
    If rst.RecordCount > 0 Then
        strResponse = MsgBox("The effective date on the membership cards are printed " & vbCrLf & _
            "from the group subscribers' effective dates. " & vbCrLf & vbCrLf & _
            "There are " & intSubsWithMissingEffDates & " subscribers in this group who do not have effective " & vbCrLf & _
            "dates.  You must enter effective dates for these " & intSubsWithMissingEffDates & vbCrLf & _
            "subscribers before printing membership cards for this group.", vbCritical, "Missing Subscriber Effective Dates")
        GoTo Exit_cmdPrint_Click
    End If

    'print all of the cards for the group that the user in on
    Dim Response As String
    If (Me![optGrpPrintCards] = 1) Then
       Response = MsgBox("You have chosen to print all cards.  Is this really what you want to do?", vbYesNo, "Do you want to print all?")
        If Response = vbYes Then
            'need to update tmpEDI_rpt
            ExecuteSQL "DELETE FROM tmpEDI_rpt"
            
            strSQL = "INSERT INTO tmpEDI_Rpt ( SUBssn , SUBfirstNAME , " & _
                        "SUBlastNAME , SUBStreet , SUBcity , SUBstate , " & _
                        "SUBzip , GroupID ) " & _
                        "SELECT tblSubscr.SubSSN , tblSubscr.SubFirstName ," & _
                        " tblSubscr.SubLastName , [SubStreet1] + ' ' + " & _
                        "[SubStreet2] AS Street , tblSubscr.SubCity , " & _
                        "tblSubscr.SubState , tblSubscr.SubZip , tblSubscr.SubGroupID " & _
                        "FROM tblSubscr " & _
                        "WHERE (((tblSubscr.SubGroupID)='" & strGroupID & "'))"
            ExecuteSQL strSQL
            
            
            
            'run the report that prints the card
            DoCmd.OpenReport strDocName, acViewNormal, , "[GroupID] = '" & strGroupID & "'"
            DoCmd.SetWarnings False
            
            'update the subscriber table to indicate that the card was
            'printed, the date it was printed, and who printed it
'            strSQL = "UPDATE tblSubscr SET tblSubscr.SUBcardPRT = Yes, " & _
'                        "tblSubscr.SUBcardPRTdte = Date(), " & _
'                        "tblSubscr.DateUpdated = Date(), tblSubscr.UserName = '" & strUserName & "' " & _
'                        "WHERE (((tblSubscr.SUBgroupID)='" & strGroupID & "'));"
'            dbs.Execute strSQL, dbSeeChanges

            'update the subscriber table to indicate that the card was
            'printed, the date it was printed, and who printed it
            strSQL = "UPDATE tblSubscr " & _
                        "SET SubCardPrt = 1, SubCardPrtDte = CONVERT(varchar(10), GetDate(), 101), " & _
                        "UserName = '" & strUserName & "', " & _
                        "ModifyDate = CONVERT(varchar(10), GetDate(), 101), " & _
                        "DateUpdated = CONVERT(varchar(10), GetDate(), 101) " & _
                        "WHERE SubGroupID = '" & strGroupID & "'"
                        
            ExecuteSQL strSQL
            
            DoCmd.SetWarnings True
            MsgBox "Cards sent to the printer!", vbExclamation, "Cards Printed"
            
            'clean up tmpEDI_rpt
            ExecuteSQL "DELETE FROM tmpEDI_rpt"
            
        End If
        
    End If

    'print those cards not previously printed for the group that the user is on
    If (Me![optGrpPrintCards] = 2) Then

        strSQL = "SELECT tblSubscr.SubSSN, tblSubscr.SubGroupID, " & _
             "tblSubscr.SubStatus, tblSubscr.SubEffDate, " & _
             "tblSubscr.SubCardPrt, tblSubscr.SubCardPrtDte " & _
             "FROM tblSubscr " & _
             "WHERE (((tblSubscr.SubGroupID)='" & strGroupID & "') " & _
             "AND (tblSubscr.SubStatus)='GRSUB') AND ((tblSubscr.SubCardPrt)=0) " & _
             "ORDER BY tblSubscr.SubGroupID;"

        'don't do anything if no one in the database needs to have a card printed
        Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
        If rst.RecordCount > 0 Then

            'print not previously printed cards
            ExecuteSQL "DELETE FROM tmpEDI_rpt"
            strSQL = "INSERT INTO tmpEDI_Rpt ( SUBssn , SUBfirstNAME , " & _
                        "SUBlastNAME , SUBStreet , SUBcity , SUBstate , " & _
                        "SUBzip , GroupID ) " & _
                        "SELECT tblSubscr.SubSSN , tblSubscr.SubFirstName ," & _
                        " tblSubscr.SubLastName , [SubStreet1] + ' ' + " & _
                        "[SubStreet2] AS Street , tblSubscr.SubCity , " & _
                        "tblSubscr.SubState , tblSubscr.SubZip , tblSubscr.SubGroupID " & _
                        "FROM tblSubscr " & _
                        "WHERE (((tblSubscr.SubStatus)='GRSUB') AND ((tblSubscr.SubCardPrt)=0) " & _
                        "AND ((tblSubscr.SubGroupID)='" & strGroupID & "'));"
                        
            ExecuteSQL strSQL

            'run the report that prints the card
            DoCmd.OpenReport strDocName, acViewNormal, , "[GroupID] = '" & strGroupID & "' And [SUBcardPRT] Is Null" & " Or [SubCardPrt] = 0"
            DoCmd.SetWarnings False
            
            'update the subscriber table indicated that the card was
            'printed, the date it was printed, and who printed it
            'strSQL = "UPDATE tblSubscr SET tblSubscr.SUBcardPRT = True, " & _
                        "tblSubscr.SUBcardPRTdte = Date(), " & _
                        "tblSubscr.DateUpdated = Date(), " & _
                        "tblSubscr.UserName = '" & strUserName & "' " & _
                        "WHERE (((tblSubscr.SubStatus)='GRSUB') AND ((tblSubscr.SubCardPrt)=0)" & _
                        "AND ((tblSubscr.SubGroupID)='" & strGroupID & "'));"
                        
            'dbs.Execute strSQL, dbSeeChanges
            
            'update the subscriber table indicated that the card was
            'printed, the date it was printed, and who printed it
            strSQL = "UPDATE tblSubscr " & _
                        "SET SubCardPrt = 1, SubCardPrtDte = CONVERT(varchar(10), GetDate(), 101), " & _
                        "UserName = '" & strUserName & "', " & _
                        "ModifyDate = CONVERT(varchar(10), GetDate(), 101), " & _
                        "DateUpdated = CONVERT(varchar(10), GetDate(), 101) " & _
                        "WHERE SubStatus = 'GRSUB' AND SubCardPrt = 0 AND SubGroupID = '" & strGroupID & "'"
                        
            
            ExecuteSQL strSQL
            DoCmd.SetWarnings True
            MsgBox "Cards sent to the printer!", vbExclamation, "Cards Printed"
            
            'clean up tmpEDI_rpt
            ExecuteSQL "DELETE FROM tmpEDI_rpt"
            

        Else

            MsgBox "No subscribers to be printed!", vbExclamation, "No subscribers."

        End If

    End If

    rst.Close
    Set rst = Nothing
    dbs.Close
    Set dbs = Nothing

Exit_cmdPrint_Click:
    Exit Sub

Err_cmdPrint_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_cmdPrint_Click
    
End Sub

Private Sub cmdCancel_Click()
On Error GoTo Err_cmdCancel_Click


    DoCmd.Close

Exit_cmdCancel_Click:
    Exit Sub

Err_cmdCancel_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_cmdCancel_Click
    
End Sub