Version =20
VersionRequired =20
Checksum =-735853083
Begin Form
    Modal = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    BorderStyle =1
    Width =6045
    ItemSuffix =23
    Left =4056
    Top =2532
    Right =10212
    Bottom =6996
    RecSrcDt = Begin
        0x2223dcb3b2c4e140
    End
    Caption ="Contract Expiration Report - Individual"
    MenuBar ="Dialog"
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    Begin
        Begin CommandButton
            TextFontFamily =2
        End
        Begin Section
            Height =5250
            BackColor =12632256
            Name ="Detail0"
            GUID = Begin
                0xffc5bde4cbaa1e43909835f9c7bd1f23
            End
            Begin
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =3
                    Left =720
                    Top =735
                    Width =2565
                    Height =210
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text67"
                    Caption ="Contract Ending Date From: "
                    GUID = Begin
                        0xa60bf28da2239f459d65de2c20447e71
                    End
                End
                Begin OptionGroup
                    SpecialEffect =1
                    OverlapFlags =85
                    Left =1995
                    Top =2370
                    Width =2879
                    Height =1335
                    TabIndex =4
                    Name ="OptSortBy"
                    DefaultValue ="1"
                    GUID = Begin
                        0xc71a0309dc2b3b4c8cfe38d536601350
                    End
                    Begin
                        Begin Label
                            BackStyle =0
                            OverlapFlags =215
                            Left =2175
                            Top =2535
                            Width =1560
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="LblSortBy"
                            Caption ="Sort By"
                            GUID = Begin
                                0xa192817a742ced459740f478f58b9176
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =2715
                            Top =2850
                            Width =165
                            Height =180
                            OptionValue =1
                            Name ="BtnCustID"
                            GUID = Begin
                                0x8f906643055c824bbd95df7ce157eacc
                            End
                            Begin
                                Begin Label
                                    BackStyle =0
                                    OverlapFlags =95
                                    Left =3003
                                    Top =2850
                                    Width =1740
                                    Height =240
                                    BackColor =12632256
                                    Name ="LblContractEnd"
                                    Caption ="Contract Ending Date"
                                    GUID = Begin
                                        0x046b52428939714a8eb4f61fa3a88d3a
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =2
                            OverlapFlags =87
                            Left =2715
                            Top =3090
                            Width =165
                            Height =180
                            OptionValue =2
                            Name ="BtnCustName"
                            GUID = Begin
                                0x5476033179fb5144aa978fcc771e235c
                            End
                            Begin
                                Begin Label
                                    BackStyle =0
                                    OverlapFlags =87
                                    Left =3003
                                    Top =3090
                                    Width =1740
                                    Height =240
                                    BackColor =12632256
                                    Name ="LblGeo"
                                    Caption ="Geographical"
                                    GUID = Begin
                                        0xd8a2b2b19eabb04ba515c18ce8d5ddb6
                                    End
                                End
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =82
                    Left =3165
                    Top =4050
                    Width =717
                    Height =478
                    TabIndex =5
                    Name ="PreviewButton"
                    Caption ="Print Preview&R"
                    StatusBarText ="Preview Report"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000017000000160000000100040000000000080100000000000000000000 ,
                        0x1000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff0000ff000000ffff00ff000000ff00ff00 ,
                        0xffff0000ffffff00888888888888888888888889888888888888888888888884 ,
                        0x88888888888888888888888388888888888888888888888e8888000000000000 ,
                        0x8800888288880ffffffffff08000888d88880fffffff00007008888888880fff ,
                        0xfff078870788888588880fffff0788f77088888288880fffff08888780888884 ,
                        0x88880fffff08f8878088888888880fffff07ff877088888088880ffffff07887 ,
                        0x0888888088880fffffff00008888888088880ffffffffff08888888088880fff ,
                        0xffff00008888888088880fffffff08088888888188880fffffff008888888886 ,
                        0x8888000000000888888888808888888888888888888888808888888888888888 ,
                        0x8888888088888888888888888888888000000000000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff00000000ff0000ffff00000000ff00ff00ff0000ffff00 ,
                        0xffffff0000000000
                    End
                    GUID = Begin
                        0xb22da2f654c7454f82e82cc0d00b7029
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =87
                    Left =3285
                    Top =735
                    Width =1005
                    Name ="FromDate"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0000;0;_"
                    GUID = Begin
                        0x3c91a7e6d11e8644a67243377bff4707
                    End
                End
                Begin TextBox
                    SpecialEffect =2
                    OverlapFlags =85
                    Left =3285
                    Top =1095
                    Width =1005
                    TabIndex =1
                    Name ="ToDate"
                    Format ="m/d/yyyy"
                    InputMask ="99/99/0000;0;_"
                    GUID = Begin
                        0x66fa20f3d4927c48b54236b9c5fe4cef
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =2700
                            Top =1095
                            Width =555
                            Height =240
                            FontWeight =700
                            BackColor =12632256
                            Name ="Text7"
                            Caption ="To: "
                            GUID = Begin
                                0x98813af0cf2b164bb73c09d9cab16b72
                            End
                        End
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =3
                    Left =1293
                    Top =1455
                    Width =2010
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text15"
                    Caption ="Geographical From: "
                    GUID = Begin
                        0x492f769a88ca6c49a2cf5cca48f7998a
                    End
                End
                Begin Label
                    BackStyle =0
                    OverlapFlags =93
                    TextAlign =3
                    Left =1269
                    Top =1815
                    Width =2010
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text8"
                    Caption =" To: "
                    GUID = Begin
                        0x592ca5103a7f7f4dab323898eead5c6f
                    End
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    SpecialEffect =2
                    OverlapFlags =215
                    ColumnCount =2
                    ListWidth =3670
                    Left =3285
                    Top =1455
                    Width =1000
                    TabIndex =2
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"10\""
                    GUID = Begin
                        0x9de44658fe4d69498c0cbf887eec0603
                    End
                    Name ="c-GEOfrom"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT qryGeoID.GEOid AS Geo_ID, qryGeoID.GEOdesc AS Geo_Description FROM qryGeo"
                        "ID ORDER BY qryGeoID.GEOid;"
                    ColumnWidths ="915;2505"
                    EventProcPrefix ="c_GEOfrom"
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    SpecialEffect =2
                    OverlapFlags =87
                    ColumnCount =2
                    ListWidth =3670
                    Left =3285
                    Top =1815
                    Width =1000
                    TabIndex =3
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"10\""
                    GUID = Begin
                        0x5608d6189548e64c8a8aca8ecc010048
                    End
                    Name ="c-GEOto"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT qryGeoID.GEOid AS Geo_ID, qryGeoID.GEOdesc AS Geo_Description FROM qryGeo"
                        "ID ORDER BY qryGeoID.GEOid;"
                    ColumnWidths ="915;2505"
                    EventProcPrefix ="c_GEOto"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit

Private Sub PreviewButton_Click()

On Error GoTo Err_PreviewButton_Click

    Dim strWhere As String
    Dim strData As String
    strData = "qrptContExpirIndiv"

    'contract expiration date
    If Not IsNull([FromDate]) Then
        If Not IsNull([ToDate]) Then
            strWhere = "[SUBcontEND] BETWEEN #" & Me![FromDate] & "# AND #" & Me![ToDate] & "#"
        Else
            strWhere = "[SUBcontEND] >= #" & [FromDate] & "#"
        End If
    ElseIf Not IsNull([ToDate]) Then
        strWhere = "[SUBcontEND] <= #" & Me![ToDate] & "#"
    End If

    'geographical id
    If Not IsNull([c-GEOfrom]) Then
        If Not IsNull([c-GEOto]) Then
            If strWhere = "" Then
                strWhere = "[SUBgeoID] BETWEEN '" & Me![c-GEOfrom] & "' AND '" & Me![c-GEOto] & "'"
            Else
                strWhere = strWhere & " AND [SUBgeoID] BETWEEN '" & Me![c-GEOfrom] & "' AND '" & Me![c-GEOto] & "'"
            End If
        Else
            If strWhere = "" Then
                strWhere = "[SUBgeoID] >= '" & Me![c-GEOfrom] & "'"
            Else
                strWhere = strWhere & " AND [SUBgeoID] >= '" & Me![c-GEOfrom] & "'"
            End If
        End If
    ElseIf Not IsNull([c-GEOto]) Then
        If strWhere = "" Then
            strWhere = "[SUBgeoID] <= '" & Me![c-GEOto] & "'"
        Else
            strWhere = strWhere & " AND [SUBgeoID] <= '" & Me![c-GEOto] & "'"
        End If
    End If
    
    
    
    If DCount("*", strData, strWhere) = 0 Then
        MsgBox "The criteria you have chosen has resulted in no records." & vbCrLf & vbCrLf & "Please make another criteria selection and try again!"
        DoCmd.Hourglass False
    Exit Sub
    
 Else

    gintSortOrder = Me![OptSortBy]
    Me.Visible = False
    DoCmd.OpenReport "rptContExpirIndiv", A_PREVIEW, , strWhere

End If


Exit_PreviewButton_Click:
    Exit Sub

Err_PreviewButton_Click:
    MsgBox Error$
    Resume Exit_PreviewButton_Click

End Sub