Version =20
VersionRequired =20
Checksum =201235823
Begin Form
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    BorderStyle =3
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =5220
    DatasheetFontHeight =10
    ItemSuffix =37
    Left =7560
    Top =240
    Right =12780
    Bottom =6750
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xf4f15965d3a0e240
    End
    GUID = Begin
        0xdbf06046d5d68f439ad26e45c1610b9a
    End
    NameMap = Begin
        0x0acc0e5500000000000000000000000000000000000000000c00000003000000 ,
        0x0000000000000000000000000000
    End
    Caption ="All American Sync"
    MenuBar ="Dialog"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00f01a53ef800101000100ea0a6f08640001000f00b00402000100 ,
        0xb004030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000092010000 ,
        0xf01a000030000000a80400000000000003000000030000000100000001000000 ,
        0x0f270000000600000100000004000000cc030000e20e68100100000000000000 ,
        0x00000000e803c8055a000000060000000d0000000d0000000d00000001000000 ,
        0xf900000008000000080000000100000001000000000000000600000001040000 ,
        0x430061006e006f006e0020004d00580039003200300020007300650072006900 ,
        0x650073002000320023003a0032000000430061006e006f006e0020004d005800 ,
        0x39003200300020007300650072006900650073002000320023003a0032000000 ,
        0x0000000000000000000000000000000001040006dc00cc0353ff800101000100 ,
        0xea0a6f08640001000f004b00020001004b00030001004c006500740074006500 ,
        0x7200000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000000000000000100000002000000010000000000000000000000 ,
        0x00000000000000000000000050524956e2300000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000180000000000102710271027000010270000000000000000f800cc03 ,
        0x0000000000000000000000000000000000000000000000000200000000000000 ,
        0x000010005c4b0300684304000000000000000000000000000000000000000000 ,
        0x0000000000000000c7a88e32050000000300ff00010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000001000000000000000000000000000000 ,
        0xf8000000534d544a000000001000e80054005000200050005300200044007200 ,
        0x6900760065007200200031004600410039003100410037004300300046003200 ,
        0x4500340030006100650041003500460035004300380032004300460044004200 ,
        0x3900310044004300350000005061676553697a65004134005061676552656769 ,
        0x6f6e0000496e707574536c6f740044656661756c74005265736f6c7574696f6e ,
        0x003735647069004475706c6578004e6f6e650000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000004100750074006f00 ,
        0x6d00610074006900630061006c006c0079002000530065006c00650063007400 ,
        0x0000000000000000440065006600610075006c00740000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000004d0061006e007500 ,
        0x61006c0020004600650065006400000000000000000000000000000000000000 ,
        0x00000000000000000f00010102014b0000004b00000096000000960000002c01 ,
        0x00002c01000058020000580200004c0065007400740065007200000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000010000000200000004000000060000000900 ,
        0x0000100000004c00650074007400650072000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000004c006500670061006c0000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000004100330000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000004100340000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000004100350000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000042003400200028004a0049005300290000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000004200340020002800490053004f00290000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000004a006100700061006e00650073006500200050006f0073007400 ,
        0x6300610072006400000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000003100300078003100310000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000003100350078003100310000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000004a006100700061006e00650073006500200044006f0075006200 ,
        0x6c006500200050006f0073007400630061007200640000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000005500530020004c00650074007400650072000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000005500530020004c006500670061006c0000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000001000500080009000b000c002a002b002d002e004500e200e300 ,
        0x6f080000ea0a00006f080000e40d00009a0b000068100000340800009a0b0000 ,
        0xc8050000340800000a0a0000380e0000c4090000ca0d0000e8030000c8050000 ,
        0xec090000ea0a0000e20e0000ea0a0000d0070000c80500006f080000ea0a0000 ,
        0x6f080000e40d000050006f007300740053006300720069007000740000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000004000d00cb0000000b010000580200001403000000000000 ,
        0x4b0000004b0000006a0000004b0000004b0000007e0200003903000013000000 ,
        0x130000000000000000000000cb0000005701000058020000f503000000000000 ,
        0x4b0000004b0000006a0000004b0000004b0000007e0200001a04000013000000 ,
        0x1300000000000000000000001c0100009701000048030000b304000000000000 ,
        0x4b0000004b0000006a0000004b0000004b0000006d030000d904000013000000 ,
        0x130000000000000000000000c50000001c010000460200004803000000000000 ,
        0x4b0000004b0000006a0000004b0000004b0000006c0200006d03000013000000 ,
        0x13000000000000000000000087000000c5000000900100004602000000000000 ,
        0x4b0000004b0000006a0000004b0000004b000000b60100006c02000013000000 ,
        0x130000000000000000000000f40000005f010000d20200000e04000000000000 ,
        0x4b0000004b0000006a0000004b0000004b000000f70200003304000013000000 ,
        0x130000000000000000000000ed00000054010000bd020000ed03000000000000 ,
        0x4b0000004b0000006a0000004b0000004b000000e30200001304000013000000 ,
        0x130000000000000000000000640000009400000027010000b401000000000000 ,
        0x4b0000004b0000006a0000004b0000004b00000027010000b601000000000000 ,
        0x010000000000000000000000f10000000b010000c90200001403000000000000 ,
        0x4b0000004b0000006a0000004b0000004b000000ee0200003903000013000000 ,
        0x130000000000000000000000700100000b010000400400001403000000000000 ,
        0x4b0000004b0000006a0000004b0000004b000000650400003903000013000000 ,
        0x130000000000000000000000c8000000940000004e020000b401000000000000 ,
        0x4b0000004b0000006a0000004b0000004b0000004f020000b601000000000000 ,
        0x010000000000000000000000cb0000000b010000580200001403000000000000 ,
        0x4b0000004b0000006a0000004b0000004b0000007e0200003903000013000000 ,
        0x130000000000000000000000cb0000005701000058020000f503000000000000 ,
        0x4b0000004b0000006a0000004b0000004b0000007e0200001a04000013000000 ,
        0x130000000000000000000000cb0000000b010000b00400002706000000000000 ,
        0x9600000096000000d40000009600000096000000fb0400007206000026000000 ,
        0x260000000000000000000000cb00000057010000b0040000e907000000000000 ,
        0x9600000096000000d40000009600000096000000fb0400003408000026000000 ,
        0x2600000000000000000000001c010000970100008f0600006609000000000000 ,
        0x9600000096000000d40000009600000096000000da060000b109000026000000 ,
        0x260000000000000000000000c50000001c0100008d0400008f06000000000000 ,
        0x9600000096000000d40000009600000096000000d8040000da06000026000000 ,
        0x26000000000000000000000087000000c5000000200300008d04000000000000 ,
        0x9600000096000000d400000096000000960000006b030000d804000026000000 ,
        0x260000000000000000000000f40000005f010000a40500001b08000000000000 ,
        0x9600000096000000d40000009600000096000000ef0500006608000026000000 ,
        0x260000000000000000000000ed000000540100007a050000da07000000000000 ,
        0x9600000096000000d40000009600000096000000c50500002508000026000000 ,
        0x26000000000000000000000064000000940000004e0200006803000000000000 ,
        0x9600000096000000d400000096000000960000004e0200006b03000000000000 ,
        0x020000000000000000000000f10000000b010000910500002706000000000000 ,
        0x9600000096000000d40000009600000096000000dc0500007206000026000000 ,
        0x260000000000000000000000700100000b0100007f0800002706000000000000 ,
        0x9600000096000000d40000009600000096000000ca0800007206000026000000 ,
        0x260000000000000000000000c8000000940000009b0400006803000000000000 ,
        0x9600000096000000d400000096000000960000009d0400006b03000000000000 ,
        0x020000000000000000000000cb0000000b010000b00400002706000000000000 ,
        0x9600000096000000d40000009600000096000000fb0400007206000026000000 ,
        0x260000000000000000000000cb00000057010000b0040000e907000000000000 ,
        0x9600000096000000d40000009600000096000000fb0400003408000026000000 ,
        0x260000000000000000000000cb0000000b010000600900004e0c000000000000 ,
        0x2c0100002c010000a80100002c0100002c010000f6090000e40c00004b000000 ,
        0x4b0000000000000000000000cb0000005701000060090000d20f000000000000 ,
        0x2c0100002c010000a80100002c0100002c010000f6090000681000004b000000 ,
        0x4b00000000000000000000001c010000970100001e0d0000cc12000000000000 ,
        0x2c0100002c010000a80100002c0100002c010000b40d0000621300004b000000 ,
        0x4b0000000000000000000000c50000001c010000190900001e0d000000000000 ,
        0x2c0100002c010000a80100002c0100002c010000af090000b40d00004b000000 ,
        0x4b000000000000000000000087000000c5000000400600001909000000000000 ,
        0x2c0100002c010000a80100002c0100002c010000d6060000af0900004b000000 ,
        0x4b0000000000000000000000f40000005f010000480b00003610000000000000 ,
        0x2c0100002c010000a80100002c0100002c010000de0b0000cc1000004b000000 ,
        0x4b0000000000000000000000ed00000054010000f40a0000b50f000000000000 ,
        0x2c0100002c010000a80100002c0100002c0100008a0b00004b1000004b000000 ,
        0x4b000000000000000000000064000000940000009b040000d006000000000000 ,
        0x2c0100002c010000a80100002c0100002c0100009b040000d606000000000000 ,
        0x040000000000000000000000f10000000b010000220b00004e0c000000000000 ,
        0x2c0100002c010000a80100002c0100002c010000b80b0000e40c00004b000000 ,
        0x4b0000000000000000000000700100000b010000fe1000004e0c000000000000 ,
        0x2c0100002c010000a80100002c0100002c01000094110000e40c00004b000000 ,
        0x4b0000000000000000000000c80000009400000036090000d006000000000000 ,
        0x2c0100002c010000a80100002c0100002c0100003b090000d606000000000000 ,
        0x040000000000000000000000cb0000000b010000600900004e0c000000000000 ,
        0x2c0100002c010000a80100002c0100002c010000f6090000e40c00004b000000 ,
        0x4b0000000000000000000000cb0000005701000060090000d20f000000000000 ,
        0x2c0100002c010000a80100002c0100002c010000f6090000681000004b000000 ,
        0x4b0000000000000000000000cb0000000b010000c01200009c18000000000000 ,
        0x5802000058020000500300005802000058020000ec130000c819000096000000 ,
        0x960000000000000000000000cb00000057010000c0120000a41f000000000000 ,
        0x5802000058020000500300005802000058020000ec130000d020000096000000 ,
        0x9600000000000000000000001c010000970100003d1a00009925000000000000 ,
        0x5802000058020000500300005802000058020000691b0000c526000096000000 ,
        0x960000000000000000000000c50000001c010000321200003d1a000000000000 ,
        0x58020000580200005003000058020000580200005e130000691b000096000000 ,
        0x96000000000000000000000087000000c5000000800c00003212000000000000 ,
        0x5802000058020000500300005802000058020000ac0d00005e13000096000000 ,
        0x960000000000000000000000f40000005f0100008f1600006c20000000000000 ,
        0x5802000058020000500300005802000058020000bb1700009821000096000000 ,
        0x960000000000000000000000ed00000054010000e81500006a1f000000000000 ,
        0x5802000058020000500300005802000058020000141700009620000096000000 ,
        0x960000000000000000000000640000009400000036090000a00d000000000000 ,
        0x580200005802000050030000580200005802000036090000ac0d000000000000 ,
        0x080000000000000000000000f10000000b010000441600009c18000000000000 ,
        0x580200005802000050030000580200005802000070170000c819000096000000 ,
        0x960000000000000000000000700100000b010000fc2100009c18000000000000 ,
        0x580200005802000050030000580200005802000028230000c819000096000000 ,
        0x960000000000000000000000c8000000940000006d120000a00d000000000000 ,
        0x580200005802000050030000580200005802000075120000ac0d000000000000 ,
        0x080000000000000000000000cb0000000b010000c01200009c18000000000000 ,
        0x5802000058020000500300005802000058020000ec130000c819000096000000 ,
        0x960000000000000000000000cb00000057010000c0120000a41f000000000000 ,
        0x5802000058020000500300005802000058020000ec130000d020000096000000 ,
        0x960000000000000000000000
    End
    PrtDevNames = Begin
        0x08001f0043000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000004c4d49504f52543a00
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin Section
            Height =6525
            BackColor =12632256
            Name ="Detail"
            GUID = Begin
                0x73c527ced0f3ce4391e59ca4fb3b8d42
            End
            Begin
                Begin Label
                    SpecialEffect =4
                    OldBorderStyle =1
                    BorderWidth =3
                    OverlapFlags =85
                    TextAlign =2
                    Left =1236
                    Top =132
                    Width =3120
                    Height =360
                    FontSize =12
                    FontWeight =700
                    Name ="Label0"
                    Caption ="All American Sync"
                    GUID = Begin
                        0x9232d63fc25e9a4eb895884536f95751
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =1872
                    Top =732
                    Width =1620
                    Height =432
                    Name ="cmdProcess"
                    Caption ="Process Groups"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xf5e7ef8a52a15547a794bc107a02830c
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =1770
                    Top =4005
                    Width =288
                    Height =288
                    TabIndex =7
                    Name ="cmdPrint"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x1929cc579ebead4db15aa0496aaab3f3
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =2058
                            Top =4005
                            Width =1656
                            Height =300
                            Name ="Label26"
                            Caption ="Cards Review"
                            GUID = Begin
                                0x9c9e19307a4c78478a57058bc8817750
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =1872
                    Top =4905
                    Width =1620
                    Height =432
                    TabIndex =8
                    Name ="cmdImport"
                    Caption ="Import New"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xad20297e1d67234bb7afac11b7f00147
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =2355
                    Top =5940
                    Width =432
                    Height =432
                    TabIndex =10
                    Name ="cmdClose"
                    Caption ="Command4"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Close Form"
                    GUID = Begin
                        0xa4e01d789df622429e28ccce79ef1720
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =1770
                    Top =3705
                    Width =288
                    Height =288
                    TabIndex =6
                    Name ="cmdViewChanges"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xfb1c2ed23dce8a459832d805c87b7593
                    End
                    Begin
                        Begin Label
                            OverlapFlags =95
                            Left =2058
                            Top =3705
                            Width =1656
                            Height =300
                            Name ="Label24"
                            Caption ="View Changed Details"
                            GUID = Begin
                                0xd90abcb8240fb84197858a4738eca1d4
                            End
                        End
                    End
                End
                Begin Rectangle
                    OverlapFlags =223
                    Left =768
                    Top =612
                    Width =4020
                    Height =4083
                    Name ="Box7"
                    GUID = Begin
                        0x0ff7ee3a51ad984299001ebb0f7c9423
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =1872
                    Top =1634
                    Width =1620
                    Height =432
                    TabIndex =2
                    Name ="btnTPA_Bad_Plan_and_Rate"
                    Caption ="Fix Plans and Covers"
                    OnClick ="[Event Procedure]"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff000000c0c0c000ffff00000000ff00c0c0c00000ffff00 ,
                        0xffffff0000000000
                    End
                    ControlTipText ="Open Form"
                    GUID = Begin
                        0xe263c699f21d71468249882a7e7a3f38
                    End
                End
                Begin CommandButton
                    OverlapFlags =223
                    Left =1770
                    Top =3105
                    Width =288
                    Height =288
                    TabIndex =4
                    Name ="cmdAdditions"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xa0d31d300ced8648894b080e3bfb4925
                    End
                    Begin
                        Begin Label
                            OverlapFlags =223
                            Left =2058
                            Top =3105
                            Width =1656
                            Height =300
                            Name ="Label25"
                            Caption ="Additions"
                            GUID = Begin
                                0x84cc0a5b68f49743b9c7eaab1d47d6a1
                            End
                        End
                    End
                End
                Begin Rectangle
                    OverlapFlags =223
                    Left =1125
                    Top =2205
                    Width =3420
                    Height =2280
                    Name ="Box22"
                    GUID = Begin
                        0x9c4f673470343a4abe78747d0d43aad1
                    End
                End
                Begin Label
                    SpecialEffect =4
                    OldBorderStyle =1
                    BorderWidth =3
                    OverlapFlags =215
                    TextAlign =2
                    Left =1887
                    Top =2265
                    Width =1620
                    Height =432
                    Name ="Label23"
                    Caption ="Reports"
                    GUID = Begin
                        0xbbb8652ed401284cb93a3ddde7b71cab
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =1770
                    Top =3405
                    Width =288
                    Height =288
                    TabIndex =5
                    Name ="cmdDrops"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x6a11e70370215a4f8ba4524a369977cf
                    End
                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =2058
                            Top =3405
                            Width =1656
                            Height =300
                            Name ="Label30"
                            Caption ="Drops"
                            GUID = Begin
                                0x58eb777b5ec6a84a8f426e808a049ee9
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =1770
                    Top =2805
                    Width =288
                    Height =288
                    TabIndex =3
                    Name ="cmdStatistics"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x5638014fde8928408e7953f0abbd81ec
                    End
                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =2058
                            Top =2805
                            Width =1656
                            Height =300
                            Name ="Label32"
                            Caption ="Statistics"
                            GUID = Begin
                                0x07a417d4f0463d4c92b42f8726398c62
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =1872
                    Top =1183
                    Width =1620
                    Height =432
                    TabIndex =1
                    Name ="btnDupSSNs"
                    Caption ="Fix Dup SSNs"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Open Form"
                    GUID = Begin
                        0xfce0f990da80ef4b9260817737f6b5d0
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =1872
                    Top =5370
                    Width =1620
                    Height =432
                    TabIndex =9
                    Name ="btnPendingDeletions"
                    Caption ="Pend Del"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x1b86de099eed6543b43fc2035febe7cb
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit
Dim mstrSQL As String
Dim mstrUser As String
Dim mstrPath As String
Dim mstrFileName As String
'-------------------------------------------------
' Object:           fdlgAASync
' Purpose:          processes data from tpa
'
' Change log:
' Date          Version     Developer       Comments
' 2007-01-01    1.0         T Cook          Created
' 2015-10-27    2.0         J Criswell      Changed design of form
'                                           to process data from new tpa

Private Function PickFile() As String

    On Error GoTo FUNC_ERR

    Dim clsFileDialog As CFileDialog
   
   ' creates a common file dialog object
    Set clsFileDialog = New CFileDialog
    With clsFileDialog
        ' Use the GetFileName method to Display the file open dialog
        ' and retrieve the file name.
        ' This method accepts parameters rather than requiring
        ' the class properties to be set.
        mstrFileName = .GetFileName(True, "*.csv", "", "CSV files (*.csv)|Text files (*.txt)|*.txt|All Files (*.*)|*.*")
        mstrPath = GetPathPart_TSB(mstrFileName)
        mstrFileName = Mid(mstrFileName, Len(mstrPath) + 1, Len(mstrFileName)) & "\"
        mstrPath = Replace(mstrPath, "F:\", "\\dc\datafiles\")
        mstrPath = Mid(mstrPath, 1, Len(mstrPath) - 1)
        
        ' make sure that it's a file
        If IsNull(mstrFileName) Then
            MsgBox "You cancelled the File Open dialog"
            PickFile = ""
            GoTo FUNC_EXIT
        Else
            PickFile = mstrFileName
        End If
    End With

FUNC_EXIT:
  Exit Function
  
FUNC_ERR:
  MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Function:  fdlgAASync.Func_PickFile"
  GoTo FUNC_EXIT
  
End Function
Private Function run_sp_flag_del_subs(strSQL As String, strUserName As String) As Integer

    On Error GoTo PROC_ERR
    
    If g_adoConnection.State = adStateOpen Then g_adoConnection.Close
    With g_adoConnection
         .ConnectionString = SetConnxn
         .Open
    End With
    With g_adoCommand
          .ActiveConnection = g_adoConnection
          .CommandType = adCmdStoredProc
          .CommandText = strSQL
          
          Set g_adoParm = .CreateParameter("@ReturnParm", adInteger, adParamReturnValue) 'Return parm
          .Parameters.Append g_adoParm
          
          Set g_adoParm = .CreateParameter("@UserName", adVarChar, adParamInput, 20)
          .Parameters.Append g_adoParm
          .Parameters("@UserName").Value = strUserName
          
          .Execute
          
          g_iRtnVal = .Parameters.Item("@ReturnParm")
    End With
    
    g_adoConnection.Close
  
    Set g_adoCommand = Nothing
    Set g_adoConnection = Nothing
    Set g_adoParm = Nothing
    
    run_sp_flag_del_subs = g_iRtnVal
    
PROC_EXIT:
    Exit Function
    
PROC_ERR:
    run_sp_flag_del_subs = False
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_fdlgAASync.run_sp_flag_del_subs"
    Call LogError(Err.Number, Err.Description, "Form_fdlgAASync.run_sp_flag_del_subs", , True)
    Resume PROC_EXIT


End Function

Private Function run_sp_del_subs(strSQL As String, dteDateDeleted As Date, strUserName As String) As Integer
    On Error GoTo PROC_ERR
    
    If g_adoConnection.State = adStateOpen Then g_adoConnection.Close
    With g_adoConnection
         .ConnectionString = SetConnxn
         .Open
    End With
    With g_adoCommand
          .ActiveConnection = g_adoConnection
          .CommandType = adCmdStoredProc
          '.Parameters.Refresh
          .CommandText = strSQL
          
          Set g_adoParm = .CreateParameter("@ReturnParm", adInteger, adParamReturnValue) 'Return parm
          .Parameters.Append g_adoParm
          
          Set g_adoParm = .CreateParameter("@DateDeleted", adDate, adParamInput, date)
          .Parameters.Append g_adoParm
          .Parameters("@DateDeleted").Value = dteDateDeleted
          
            Set g_adoParm = .CreateParameter("@UserName", adVarChar, adParamInput, 20)
          .Parameters.Append g_adoParm
          .Parameters("@UserName").Value = strUserName
          

          .Execute
          
          g_iRtnVal = .Parameters.Item("@ReturnParm")
    End With
    
    g_adoConnection.Close
  
    Set g_adoCommand = Nothing
    Set g_adoConnection = Nothing
    Set g_adoParm = Nothing
    
    run_sp_del_subs = g_iRtnVal
    
PROC_EXIT:
    Exit Function
    
PROC_ERR:
    run_sp_del_subs = False
    MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure: Form_fdlgAASync.run_sp_del_subs"
    Call LogError(Err.Number, Err.Description, "Form_fdlgAASync.run_sp_del_subs", , True)
    Resume PROC_EXIT
    
    
End Function

Private Function run_procedure(strSQL As String, strUserName As String, strPath As String, strFileName As String) As Integer

On Error GoTo PROC_ERR
    
    If g_adoConnection.State = adStateOpen Then g_adoConnection.Close
    With g_adoConnection
         .ConnectionString = SetConnxn
         .CommandTimeout = 360
         .Open
    End With
    Set g_adoParm = Nothing
    With g_adoCommand
          .ActiveConnection = g_adoConnection
          .CommandTimeout = 360
          .CommandType = adCmdStoredProc
          .CommandText = strSQL
          
          g_adoParmName = "Return"
          Set g_adoParm = .CreateParameter(g_adoParmName, adInteger, adParamReturnValue, , 0) 'Return parm
          .Parameters.Append g_adoParm
          .Parameters(g_adoParmName).Value = 0
          
          g_adoParmName = "@User"
          Set g_adoParm = .CreateParameter(g_adoParmName, adVarChar, adParamInput, 50)
          .Parameters.Append g_adoParm
          .Parameters(g_adoParmName).Value = strUserName
          
          g_adoParmName = "@Path"
          Set g_adoParm = .CreateParameter(g_adoParmName, adVarChar, adParamInput, 100)
          .Parameters.Append g_adoParm
          .Parameters(g_adoParmName).Value = strPath
          
          g_adoParmName = "@File"
          Set g_adoParm = .CreateParameter(g_adoParmName, adVarChar, adParamInput, 50)
          .Parameters.Append g_adoParm
          .Parameters(g_adoParmName).Value = strFileName
          
          .Execute
    End With
    
    
    g_iRtnVal = g_adoCommand(0)
    g_adoConnection.Close
  
    Set g_adoCommand = Nothing
    Set g_adoConnection = Nothing
    Set g_adoParm = Nothing
    
    run_procedure = g_iRtnVal
    
PROC_EXIT:
   Exit Function
    
PROC_ERR:
  MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Function:  Form_fdlgAASync.Func_Run_Procedure"
  Resume PROC_EXIT
    
End Function


Private Sub btnDupSSNs_Click()

    On Error GoTo Err_btnDupSSNs_Click
    Dim stDocName As String
    Dim strSQL As String
    strSQL = "select * from vw_tpa_dup_ssn"
    LoadADORecordset strSQL, 360
    
    If g_adoRS.RecordCount > 0 Then
        ' open form to fix problems
         stDocName = "frmTPA_DupSSNs"
         DoCmd.OpenForm stDocName, acFormDS, , , acFormEdit, acWindowNormal
    Else
        MsgBox "There are no duplicate SSNs.", vbOKOnly, "QCD: Dup SSNs."
    End If
    
    g_adoRS.Close
        
Exit_btnDupSSNs_Click:
    Exit Sub

Err_btnDupSSNs_Click:
    MsgBox Err.Description
    Resume Exit_btnDupSSNs_Click
    
End Sub
Private Sub cmdAdditions_Click()
    ' Comments   :    Report with all new subscribers
    '                   and dependents from the tpa file
    ' Parameters hh
    ' Created    :    2015-10-26  J Criswell
    ' Modified   :
    '
    '
    '
    ' --------------------------------------------------------
  On Error GoTo PROC_ERR
    
    ' validation
    If ValidSSN And ValidPlanCover Then
            gintProcessStatus = 1
    Else
        If ValidSSN Then
            gintProcessStatus = ValidSSN
        Else
            gintProcessStatus = 0
        End If
        
        If ValidPlanCover Then
            gintProcessStatus = ValidPlanCover
        Else
            gintProcessStatus = 0
        End If
    End If
    
    ' process data
    If gintProcessStatus <> 1 Then
        MsgBox "You must process the data first.  Click " & vbCrLf & _
                "'Process Groups' button to process the data! ", vbCritical, _
                "Data Not Processed"
        gintProcessStatus = 0
    GoTo PROC_EXIT
    End If

    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    DoCmd.OpenReport "Additions", acViewPreview
    gintProcessStatus = 1
   
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
PROC_EXIT:
    Exit Sub

PROC_ERR:
    MsgBox Err.Description
    Resume PROC_EXIT

End Sub

Private Sub cmdDrops_Click()

    ' Comments   :    Report with all dropped subscribers
    '                   and dependents from the tpa file
    ' Parameters :
    ' Created    :    2015-10-26  J Criswell
    ' Modified   :
    '
    '
    '
    ' --------------------------------------------------------
  On Error GoTo PROC_ERR
    
    ' validation
    If ValidSSN And ValidPlanCover Then
            gintProcessStatus = 1
    Else
        If ValidSSN Then
            gintProcessStatus = ValidSSN
        Else
            gintProcessStatus = 0
        End If
        
        If ValidPlanCover Then
            gintProcessStatus = ValidPlanCover
        Else
            gintProcessStatus = 0
        End If
    End If
    
    ' process data
    If gintProcessStatus <> 1 Then
        MsgBox "You must process the data first.  Click " & vbCrLf & _
                "'Process Groups' button to process the data! ", vbCritical, _
                "Data Not Processed"
        gintProcessStatus = 0
        GoTo PROC_EXIT
    End If
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
        
    DoCmd.OpenReport "Drops", acViewPreview
    gintProcessStatus = 1

    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
PROC_EXIT:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub

PROC_ERR:
    MsgBox Err.Description
    Resume PROC_EXIT

End Sub
Private Sub cmdImport_Click()
  ' Comments   :    This is the final import for
  '                 subscribers and dependents
  '                 from the tpa csv file
  ' Parameters :    None
  ' Created    :    2015-10-19  J Criswell
  ' Modified   :
  '
  '
  '
  ' --------------------------------------------------------
  On Error GoTo HandleError
    
    Dim db As DAO.Database
    Dim rst As DAO.Recordset
    Dim intResp As Integer
    Dim strMsg As String
    Dim stDocName As String
    Dim strUserName As String
    
    Set db = CurrentDb()
    
    gintProcessStatus = 0
    
    ' validation
    If ValidSSN And ValidPlanCover Then
            gintProcessStatus = 1
    Else
        If ValidSSN Then
                gintProcessStatus = ValidSSN
        Else
            MsgBox "There are duplicates SSNs in the tpa file."
            gintProcessStatus = ValidPlanCover
        End If
        
        If ValidPlanCover Then
                gintProcessStatus = ValidPlanCover
        Else
            MsgBox "There are incorrect plans and coverages in the tpa file."
            gintProcessStatus = ValidSSN
        End If
    End If
    
    ' validate user running import data
    If gintProcessStatus <> 1 Then
        MsgBox "You're not clear to import data. " & vbCrLf & _
                "Check to see if all issues such as bad " & vbCrLf & _
                "plans and covers and duplicate SSN's " & vbCrLf & _
                "have been addressed. ", vbCritical, _
                "QCD: Data issues"
        gintProcessStatus = 0
        GoTo ExitProc
    End If
    
    strMsg = "Are you ready to begin the final import?"
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
                
    '  begin tpa data import into QCD database
    intResp = MsgBox(strMsg, vbQuestion + vbYesNo + vbDefaultButton2, "QCD: tpa import")
    If intResp = vbYes Then
        ' import tpa subscriber data into QCD database
        strUserName = GetCurrentUserName()
        mstrSQL = "usp_tpa_final"
        If run_procedure(mstrSQL, strUserName, "", "") Then
            gintProcessStatus = 1
            MsgBox "tpa import succeeded.", vbExclamation, "QCD: tpa import"
        Else
            Err.Raise vbObjectError + 513, "usp_tpa_final", "tpa import failed. Contact support."
            gintProcessStatus = 0
            GoTo HandleError
        End If
    End If
    ' end of data commit
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
        
ExitProc:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub

HandleError:
  gintProcessStatus = 0
  MsgBox "Error: " & Err.Description & _
     " (" & Err.Number & ")", vbCritical
  Resume ExitProc

End Sub

Private Sub cmdPrint_Click()
    ' Comments   : Prints a report of new subscribers
    ' Parameters : None
    ' Created    : 2/28/2004 1:31:11 PM Admin
    ' Modified   :
    '
    ' --------------------------------------------------------
    On Error GoTo HandleError
    
    ' validation
    If ValidSSN And ValidPlanCover Then
        gintProcessStatus = 1
    Else
        If ValidSSN Then
            gintProcessStatus = ValidSSN
        Else
            gintProcessStatus = 0
        End If
        
        If ValidPlanCover Then
            gintProcessStatus = ValidPlanCover
        Else
            gintProcessStatus = 0
        End If
    End If
    
    ' process data?
    If gintProcessStatus <> 1 Then
        MsgBox "You must process the data first.  Click " & vbCrLf & _
        "'Process Groups' button to process the data! ", vbCritical, _
        "Data Not Processed"
        gintProcessStatus = 0
        GoTo ExitProc
    End If
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    'update SQL Server temp table
    ExecuteSQL ("EXEC uspPrintAAreport")
    
    'print preview the report
    DoCmd.OpenReport "rptAA_NewSubscribers", acViewPreview
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
ExitProc:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub
    
HandleError:
    MsgBox "Error: " & Err.Description & _
    " (" & Err.Number & ")", vbExclamation
    Resume ExitProc
End Sub

   
Private Sub cmdProcess_Click()
    
    On Error GoTo PROC_ERR
    
    Dim db As DAO.Database
    Dim rst As DAO.Recordset
    Dim I As Integer
    Dim OutputMeter As Variant
    Dim MeterFull As Integer
    Dim MeterCount As Integer
    Dim stDocName As String
    Dim strUserName As String
    Dim dteDateDeleted As Date
   
    Set db = CurrentDb()
    
    gintProcessStatus = 0
    mstrUser = GetCurrentUserName()
    
    ' warn user about cancelled groups
    Dim Msg, Style, Title, Response
    Msg = "Did you cancel any dropped groups?" & vbCrLf & vbCrLf & _
    "Do you want to continue?"
    Style = vbYesNo + vbInformation + vbDefaultButton2
    Title = "Cancelled groups warning."
    Response = MsgBox(Msg, Style, Title)
    
    If Response = vbYes Then
        
        ' begin importing data into temporary tables
        Msg = "Do you want to import the tpa data?"
        Response = MsgBox(Msg, vbQuestion + vbYesNo + vbDefaultButton2, "QCD: Confirm Action")
        If Response = vbYes Then
            
            Application.SetOption "Show Status Bar", True
            MeterFull = 10
            MeterCount = 1
            DoCmd.Hourglass True
            DoCmd.SetWarnings False
            
            ' set pending deletions flag on subsciribers
            ' who are in a pending deletion status
            ' usp_SelAllPendDel
            mstrSQL = "usp_SelAllPendDel"
            If run_sp_flag_del_subs(mstrSQL, mstrUser) Then
                gintProcessStatus = 1
            Else
                MsgBox "The update to flag pending deletion subscribers failed.  Contatct Support.", vbInformation, "QCD: Flag pending deletions"
                gintProcessStatus = 0
                GoTo PROC_EXIT
            End If
                        
            ' update the pending deletions to deleted based on their date deleted value
            If gintProcessStatus = 1 Then
                mstrSQL = "usp_UpdateDeleted                "
                dteDateDeleted = LastDayOfMonth(date)
            
                If run_sp_del_subs(mstrSQL, dteDateDeleted, mstrUser) Then
                    gintProcessStatus = 1
                Else
                    MsgBox "The update for pending deletion subscribers failed.  Contatct Support.", vbInformation, "QCD: Process pending deletions"
                    gintProcessStatus = 0
                    GoTo PROC_EXIT
                End If
                
            Else
                GoTo PROC_EXIT
            End If
            
            If gintProcessStatus = 1 Then
                ' process data from tpa file
                mstrSQL = ""
                mstrSQL = "usp_tpa_import_csv"
                mstrFileName = PickFile()
                If mstrFileName <> "" Or Not IsNull(mstrFileName) Then
                    ' import data from tpa file with SSIS package
                    If run_procedure(mstrSQL, mstrUser, mstrPath, mstrFileName) Then
                        ' split data into subs and deps
                        mstrSQL = "usp_tpa_import_sub"
                        Call GetOutPutParm(mstrSQL)                      ' import subscribers
                        If g_sRtnVal = "Procedure Succeeded" Then
                            mstrSQL = "usp_tpa_import_dep"
                            Call GetOutPutParm(mstrSQL)                  ' import dependents
                            If g_sRtnVal = "Procedure Succeeded" Then
                                gintProcessStatus = 1
                            Else
                                MsgBox "tpa data import failed; contact support.", vbInformation, "QCD: Process tpa data"
                                gintProcessStatus = 0
                                GoTo PROC_EXIT
                            End If
                        End If
                    Else
                        MsgBox "The file processing failed; contact support.", vbInformation, "QCD: Process tpa data"
                        gintProcessStatus = 0
                        GoTo PROC_EXIT
                    End If
                End If
            Else
                GoTo PROC_EXIT
            End If
            
            ' validation
            If ValidSSN And ValidPlanCover Then
                gintProcessStatus = 1
            Else
                If ValidSSN Then
                    gintProcessStatus = ValidSSN
                Else
                    MsgBox "There are duplicates SSNs in the tpa file.", vbInformation, "QCD: Process tpa data"
                    gintProcessStatus = ValidPlanCover
                End If
                
                'check for invalid plans and covers
                If ValidPlanCover Then
                    gintProcessStatus = ValidPlanCover
                Else
                    MsgBox "There are incorrect plans and coverages in the tpa file.", vbInformation, "QCD: Process tpa data"
                    gintProcessStatus = ValidSSN
                End If
                
                ' check for duplicate dependents
            End If
        End If
    End If
    
    If gintProcessStatus = 1 Then
        MsgBox "File processed correctly.", vbInformation, "QCD: Process tpa data."
    Else
        MsgBox "You have data issues." & vbCrLf & _
        "Correct them with the buttons below:" & vbCrLf & vbCrLf & _
        "  . Fix Dup SSNs" & vbCrLf & _
        "  . Fix Plans and Covers" & vbCrLf & vbCrLf & _
        "Then move on to the import." & vbCrLf & vbCrLf & _
        "If you click process again, you must" & vbCrLf & _
        "start from the beginning.", vbCritical, "QCD: Process tpa data."
    End If
    
    Set db = Nothing
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
    OutputMeter = SysCmd(acSysCmdRemoveMeter)
    
PROC_EXIT:
    Set db = Nothing
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
    OutputMeter = SysCmd(acSysCmdRemoveMeter)
    Exit Sub
    

PROC_ERR:
  MsgBox "Error: (" & Err.Number & ") " & Err.Description, vbCritical, "Procedure:fdlgAASync.cmdProcess"
  Resume PROC_EXIT

    
End Sub

Private Sub cmdClose_Click()
On Error GoTo Err_cmdClose_Click


    DoCmd.Close

Exit_cmdClose_Click:
    Exit Sub

Err_cmdClose_Click:
    MsgBox Err.Description
    Resume Exit_cmdClose_Click
    
End Sub

Private Sub cmdStatistics_Click()

    On Error GoTo PROC_ERR

    ' validation
    If ValidSSN And ValidPlanCover Then
            gintProcessStatus = 1
    Else
        If ValidSSN Then
            gintProcessStatus = ValidSSN
        Else
            gintProcessStatus = 0
        End If
        
        If ValidPlanCover Then
            gintProcessStatus = ValidPlanCover
        Else
            gintProcessStatus = 0
        End If
    End If
        
    ' process data?
    If gintProcessStatus <> 1 Then
        MsgBox "You must process the data first.  Click " & vbCrLf & _
                "'Process Groups' button to process the data! ", vbCritical, _
                "Data Not Processed"
        gintProcessStatus = 0
        GoTo PROC_EXIT
    End If
    
    DoCmd.SetWarnings False
    DoCmd.Hourglass True
    
    mstrSQL = "usp_tpa_metrics"
    Call GetOutPutParm(mstrSQL)
    If g_sRtnVal = "Procedure Succeeded" Then
        DoCmd.OpenReport "rptAA_Stats", acViewPreview
    Else
        MsgBox "tpa statistics failed.  Contact support.", vbExclamation, "QCD: Statistics"
    End If
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
PROC_EXIT:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub

PROC_ERR:
    gintProcessStatus = 0
    MsgBox Err.Description
    Resume PROC_EXIT

End Sub

Private Sub cmdViewChanges_Click()
    
    On Error GoTo PROC_ERR

    ' validation
    If ValidSSN And ValidPlanCover Then
            gintProcessStatus = 1
    Else
        If ValidSSN Then
            gintProcessStatus = ValidSSN
        Else
            gintProcessStatus = 0
        End If
        
        If ValidPlanCover Then
            gintProcessStatus = ValidPlanCover
        Else
            gintProcessStatus = 0
        End If
    End If
    
    ' process data?
    If gintProcessStatus <> 1 Then
        MsgBox "You must process the data first.  Click " & vbCrLf & _
                "'Process Groups' button to process the data! ", vbCritical, _
                "Data Not Processed"
        gintProcessStatus = 0
        GoTo PROC_EXIT
    End If
    
    DoCmd.OpenReport "rptAA_VarianceReport", acViewPreview
    gintProcessStatus = 1

    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
PROC_EXIT:
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    Exit Sub

PROC_ERR:
    gintProcessStatus = 0
    MsgBox Err.Description
    Resume PROC_EXIT
End Sub
Private Sub btnTPA_Bad_Plan_and_Rate_Click()

On Error GoTo Err_btnTPA_Bad_Plan_and_Rate_Click


    Dim db As DAO.Database
    Dim rst As DAO.Recordset
    Dim strSSN() As String
    Dim I As Integer
    Dim J As Integer
    Dim stDocName As String
    Dim strWhere As String
    
    Set db = CurrentDb
    Set rst = db.OpenRecordset("vw_tpa_plan_cover", dbOpenDynaset)
    If rst.BOF And rst.EOF Then
        MsgBox "Plans and covers are correct", vbOKOnly, "QCD: Plans and covers."
        GoTo Exit_btnTPA_Bad_Plan_and_Rate_Click
    Else
        rst.MoveLast
        rst.MoveFirst
        I = 0
        J = rst.RecordCount
        strWhere = "SSN IN ("
        
        ReDim strSSN(I To J)
        If rst.RecordCount > 0 Then
            Do Until rst.EOF
                strSSN(I) = rst("SSN")
                If I <> J - 1 Then
                    strWhere = strWhere & "'" & strSSN(I) & "', "
                Else
                    strWhere = strWhere & "'" & strSSN(I) & "')"
                End If
                I = I + 1
                rst.MoveNext
            Loop
        End If
        stDocName = "frmTPA_Bad_Plan_and_Cover"
        DoCmd.OpenForm stDocName, acFormDS, , strWhere, acFormEdit, acWindowNormal
    End If
    rst.Close
    Set db = Nothing
    
Exit_btnTPA_Bad_Plan_and_Rate_Click:
    'rst.Close
    Set db = Nothing
    Exit Sub

Err_btnTPA_Bad_Plan_and_Rate_Click:
    MsgBox Err.Description
    Resume Exit_btnTPA_Bad_Plan_and_Rate_Click
    
End Sub

Private Sub btnPendingDeletions_Click()
On Error GoTo Err_btnPendingDeletions_Click

    Dim stDocName As String
    Dim stLinkCriteria As String

    stDocName = "frmPendingDeletions"
    DoCmd.OpenForm stDocName, , , stLinkCriteria

Exit_btnPendingDeletions_Click:
    Exit Sub

Err_btnPendingDeletions_Click:
    MsgBox Err.Description
    Resume Exit_btnPendingDeletions_Click
    
End Sub