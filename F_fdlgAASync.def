Version =20
VersionRequired =20
Checksum =1496707228
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =4260
    DatasheetFontHeight =10
    ItemSuffix =15
    Left =7080
    Top =345
    Right =11340
    Bottom =6660
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xf4f15965d3a0e240
    End
    GUID = Begin
        0x949db437a5bc4b46b48c5fb3b4ed6389
    End
    NameMap = Begin
        0x0acc0e5500000000000000000000000000000000000000000c00000003000000 ,
        0x0000000000000000000000000000
    End
    Caption ="All American Sync"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0009f95d04000000e0c08100c424fb0200000000ecc0810030503f00f4503f00 ,
        0x010418009c00b80353ef80010100010000000000640001000f00b00402000100 ,
        0xb004030001004c65747465720066b438e0c08100040000000000000000000000 ,
        0xbe61b43804000000000000000000000000000000000000000000000001000000 ,
        0x0000000000000000000000000000000000000000000000000000000094042e00 ,
        0x4850204c617365724a65742032323030205365726965732050434c2036000000 ,
        0x0000000000000400320090018603789c6590cf4b545114c7bfdf779ede9a3467 ,
        0x51265179d14a0d794d43b46da105428b20f2c7425733e4ab38679807a2483f66 ,
        0x19816d5a14b40882fe8408755bff48d4ba9d3fcaa6fbdee0207816df73bfdf7b ,
        0xb8f7f0c9b2e31511cb1c88427bca2f70ab24e07a0aedcdd5dad02b944db6db36 ,
        0xca56443dc19663ebbde845ca860c426722fd06db8a6d9cb646bd4cbd46bd4a9b ,
        0x6078608c09427bc812749ebac0dccd769c75dc5c70d6b9cbed3acb702ff2bf1b ,
        0xcfa9cf8a9149c680d662b714977037d5345b4ef5116c3146d8dce8f3a19f3294 ,
        0x37a00cf92135b85f12a1a830f39897a827693bd00334f7a17fa1c3b45dd81fe8 ,
        0x3fd859ea20f51cf59d98a70d51fa59839ea6956903b4d7d2fa24fa4a1a5ba2df ,
        0x23f9201f1118c86dbeec3317e908ddd702daf9422f14fa1b417b89c335808de4 ,
        0xf014e2b81b7f3e1af774e3b7ddd86dcb7554ab958a7f506fa6f5cc8fdf9fbae7 ,
        0x6f4dccd69b596aeafdcda49adc482a7ebabe92f83c2da8efe10c648af3914c07 ,
        0xd137d2b853e09c613fac443d45ed0bf862e6849ed0059261e3ff7ab562800000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080027003a000100000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000000048504c617365 ,
        0x724a657432323030000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000
    End
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin Section
            Height =6360
            BackColor =65280
            Name ="Detail"
            GUID = Begin
                0x6e9c65e9f37fe84e9974c9285996549e
            End
            Begin
                Begin Label
                    SpecialEffect =4
                    OldBorderStyle =1
                    BorderWidth =3
                    OverlapFlags =85
                    TextAlign =2
                    Left =165
                    Top =120
                    Width =3150
                    Height =360
                    FontSize =12
                    FontWeight =700
                    Name ="Label0"
                    Caption ="DCA Import"
                    GUID = Begin
                        0xa3394b526d3d9043b1089992dd5fc8e7
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =780
                    Top =3000
                    Width =1620
                    Height =420
                    Name ="cmdProcess"
                    Caption ="Process Groups"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x504f15d40c050d4aaef2b9444a5c730b
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =780
                    Top =4068
                    Width =1620
                    Height =420
                    TabIndex =1
                    Name ="cmdPrint"
                    Caption ="Print Report"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x1ddc4d80d105ef418897af34a05871df
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =780
                    Top =4602
                    Width =1620
                    Height =420
                    TabIndex =2
                    Name ="cmdImport"
                    Caption ="Import New"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x1a654dbf1ed7e1458f16f47b22d6640a
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3420
                    Top =5760
                    Width =726
                    Height =426
                    TabIndex =3
                    Name ="cmdClose"
                    Caption ="Command4"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadad0dadadadadaadad00adadadadaddad030dadadadada ,
                        0xad0330adadadadad0033300000000adaa03330ff0dadadadd03300ff0adad4da ,
                        0xa03330ff0dad44add03330ff0ad44444a03330ff0d444444d03330ff0ad44444 ,
                        0xa0330fff0dad44add030ffff0adad4daa00fffff0dadadadd00000000adadada ,
                        0xadadadadadadadad000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Close Form"
                    GUID = Begin
                        0x0ae60e9adcc51844b6d0dfc34376d6ae
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =780
                    Top =720
                    Width =1980
                    Height =480
                    TabIndex =4
                    Name ="cmdViewChanges"
                    Caption ="View Changed Details"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x582c59b0ff17d1498d12a8f001f8e7a5
                    End
                End
                Begin Rectangle
                    OverlapFlags =215
                    Left =420
                    Top =600
                    Width =2640
                    Name ="Box6"
                    GUID = Begin
                        0x63bf374783b62a49a62bf492ee709760
                    End
                End
                Begin Rectangle
                    OverlapFlags =223
                    Left =600
                    Top =2880
                    Width =1980
                    Height =3360
                    Name ="Box7"
                    GUID = Begin
                        0xe2218b68a22b3d40acef94e90488583d
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =780
                    Top =5670
                    Width =1620
                    Height =420
                    TabIndex =5
                    Name ="cmdPrintCards"
                    Caption ="Print Cards"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x9f363b1f7619a34f956172c05285d60d
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =780
                    Top =5136
                    Width =1620
                    Height =420
                    TabIndex =6
                    Name ="cmdRates"
                    Caption ="Rates Report"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x9e404caddc2b114697f0ed5e49c4e2b1
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =780
                    Top =3534
                    Width =1620
                    Height =420
                    TabIndex =7
                    Name ="btnPrintDupSSNReport"
                    Caption ="Dup SSN Report"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x6819b94ed96b584fb9f2f425dc103f86
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =240
                    Top =1560
                    Width =3840
                    Height =480
                    TabIndex =8
                    Name ="cmdAddUniqueID"
                    Caption ="Add Unique IDs and Mark Auto Dups"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x9a600c9f645c2845bb330fd2d4499a43
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =240
                    Top =2220
                    Width =1920
                    Height =420
                    TabIndex =9
                    Name ="cmdViewDups"
                    Caption ="View the Dups to Edit"
                    OnEnter ="[Event Procedure]"
                    GUID = Begin
                        0x6d7ead312be172469c3a3e814ccbd9c1
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =2280
                    Top =2220
                    Width =1800
                    Height =420
                    TabIndex =10
                    Name ="cmdRemoveDups"
                    Caption ="Remove Marked Dups"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc2ac21f2954f0743aff43424b8bd0dcc
                    End
                End
                Begin Rectangle
                    OverlapFlags =215
                    Left =120
                    Top =1380
                    Width =4020
                    Height =1380
                    Name ="Box14"
                    GUID = Begin
                        0xd5b87d4a5669bf42ad195cdb9250ac0c
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit
Dim mintProcessStatus As Integer
Dim strSQL As String
Dim db As DAO.Database


Private Sub btnPrintDupSSNReport_Click()

    On Error GoTo PROC_ERR
    
    Dim strDocName As String

    strDocName = "rptAAImport_DupSSNs"
    DoCmd.OpenReport strDocName, acPreview
  Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  Resume Next

End Sub

Private Sub cmdAddUniqueID_Click()
    
    DoCmd.SetWarnings False
    ' Add the Unique ID to the Import Table
    DoCmd.OpenQuery "EXGEXP_AddUniqueIDs"
    ' Create the DupSSN and populate the Dup Records
    DoCmd.OpenQuery "ELGEXP_ClearDupSSN"
    DoCmd.OpenQuery "ELGEXP_ClearDupRecs"
    DoCmd.OpenQuery "_ELGEXP_DupSSNs"
    DoCmd.OpenQuery "ELGEXP_DupRecs"
    ' Identify the Dup-Dups that can be removed automatically
    Call MarkDupRecs
    
    ' The rest will have manual intervention and will be handled on the Edit Dups form
    
    DoCmd.SetWarnings True
    MsgBox "Operation Complete.  Please review the Manual Dups.", vbInformation, "Complete"
    
End Sub

Private Sub MarkDupRecs()
Dim db As DAO.Database
Dim rs As DAO.Recordset
Dim rsU As DAO.Recordset
Dim strSQL As String
Dim strSQLu As String
Dim strUID As String

    Set db = CurrentDb()
    strSQL = "SELECT Count(ELGEXP_pd.UNIQUEID) AS CountOfUNIQUEID, ELGEXP_pd.UNIQUEID FROM ELGEXP_pd GROUP BY ELGEXP_pd.UNIQUEID HAVING (((Count(ELGEXP_pd.UNIQUEID))>1));"
    Set rs = db.OpenRecordset(strSQL, dbOpenSnapshot)
    If rs.RecordCount > 0 Then
    Do While Not rs.EOF
        strUID = rs.Fields("UNIQUEID")
        strSQLu = "SELECT ELGEXP_pd.Delete, ELGEXP_pd.UNIQUEID, ELGEXP_pd.RecID FROM ELGEXP_pd WHERE (((ELGEXP_pd.UNIQUEID)='" & strUID & "'));"
        Set rsU = db.OpenRecordset(strSQLu, dbOpenDynaset)
        With rsU
            .MoveFirst
            .Edit
            .Fields("Delete") = True
            .Update
        End With
        rsU.Close
        rs.MoveNext
    Loop
    End If

End Sub

Private Sub cmdImport_Click()
  ' Comments   :
  ' Parameters :
  ' Created    : 2/28/2004 Tim Cook
  ' Modified   : 11/29/2007 John Criswell
  '              built stored procedures instead of querydefs
  ' --------------------------------------------------------
  On Error GoTo HandleError
      
    Dim intResp As Integer
    Dim strGrp As String
    Dim lngImpS As Long
    Dim lngImpD As Long
    Dim lngCurS As Long
    Dim lngCurD As Long
    Dim lngDelASR As Long
    Dim strMsg As String
    Dim strGrpID As String
    Dim strSQL As String
    Dim strGroup As String
    Dim strGroupList As String
    
    Dim db As DAO.Database
    Dim rst As DAO.Recordset
    
    If mintProcessStatus <> 1 Then
        MsgBox "You have to process the data first.  Click " & vbCrLf & _
                "'Process Groups' button to process the data! ", vbCritical, _
                "Data Not Processed"
    mintProcessStatus = 0
    GoTo ExitProc
    End If
    
    Set db = CurrentDb()
      
    'check to make sure all of the groups in the GroupLink file have been set up
    'in the QCD database
    strSQL = "SELECT tblAAGroups.SUBgroupID " & _
              "FROM tblAAGroups LEFT JOIN tblGrp ON tblAAGroups." & _
              "SUBgroupID = tblGrp.GroupID " & _
              "WHERE (((tblGrp.GroupID) Is Null));"

    Set rst = db.OpenRecordset(strSQL, dbOpenDynaset)

    If rst.RecordCount > 0 Then

        Do Until rst.EOF
            strGroup = rst.Fields("SubGroupID") & vbCrLf
            rst.MoveNext
            strGroupList = strGroupList & strGroup
        Loop

        MsgBox "You have groups in the GroupLink synch file that have not been " & vbCrLf & _
                "setup in the QCD database yet.  You must set these groups up and " & vbCrLf & _
                "and then repeat the entire synch process." & vbCrLf & vbCrLf & _
                "Groups not set up : " & vbCrLf & strGroupList, vbCritical, "Groups Not Setup"

        rst.Close
        db.Close
        Set db = Nothing
        mintProcessStatus = 0
        GoTo ExitProc
    End If
      
    'check to make sure all of the groups have been
    'loaded with plan/coverages/rates
    'qselAA_GroupswithNoRates
    Set rst = db.OpenRecordset("qrptAA_GroupswithNoRates", dbOpenSnapshot)
    If rst.RecordCount > 0 Then
        MsgBox "You have groups without the proper Plans/Coverages/Rates setup. " & vbCrLf & _
                  "You must go back to those groups and setup the Plans/Coverages/Rates " & vbCrLf & _
                  "before you can import the GroupLink file.  In order to see which groups " & vbCrLf & _
                  "need maintenance, run the 'Groups with No Rates' report.", vbCritical, "Plans/Coverages/Rates Not Setup"
        rst.Close
        db.Close
        Set db = Nothing
        mintProcessStatus = 0
        GoTo ExitProc
    End If
            
      DoCmd.Hourglass True
      
      ' get pre-import Subscriber count
      strSQL = "SELECT Count(tblSubscr.SUBssn) AS CurSCnt " & _
             "FROM tblGrp " & _
             "INNER JOIN tblSubscr ON tblGrp.GroupID = tblSubscr.SUBgroupID " & _
             "WHERE (((tblGrp.GroupType)=4));"
             
      Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
      If rst.RecordCount > 0 Then
        lngCurS = rst.Fields("CurSCnt")
        rst.Close
      Else
        lngCurS = 0
      End If
      
      ' get pre-import Dependent count
      strSQL = "SELECT Count([tblDependent].[DepSubID]) AS CurDCnt " & _
             "FROM (tblGrp " & _
             "INNER JOIN tblSubscr ON tblGrp.GroupID = tblSubscr.SUBgroupID) " & _
             "INNER JOIN tblDependent ON tblSubscr.SUBssn = tblDependent.DEPsubID " & _
             "WHERE (((tblGrp.GroupType)=4));"
      
      Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
      If rst.RecordCount > 0 Then
        lngCurD = rst.Fields("CurDCnt")
        rst.Close
      Else
        lngCurD = 0
      End If
            
      ' get Import Subscriber count
      strSQL = "SELECT Count(tblEDI_App_Subscr.SUBssn) AS ImpSCnt FROM tblEDI_App_Subscr;"
       
      
      Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
      If rst.RecordCount > 0 Then
        lngImpS = rst.Fields("ImpSCnt")
        rst.Close
      Else
        lngImpS = 0
      End If
      
      ' get Import Dependent Count
      strSQL = "SELECT Count(tblEDI_App_Dep.DEPsubID) AS ImpDCnt FROM tblEDI_App_Dep;"
      
      Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
      If rst.RecordCount > 0 Then
        lngImpD = rst.Fields("ImpDCnt")
        rst.Close
      Else
        lngImpD = 0
      End If
                
      'strMsg = "Group: " & Me.cboGroups.Column(1) & vbCrLf & vbCrLf
      strMsg = strMsg & "Current Counts: " & vbCrLf
      strMsg = strMsg & "Subscribers - " & CStr(lngCurS) & vbCrLf
      strMsg = strMsg & "Dependents - " & CStr(lngCurD) & vbCrLf & vbCrLf
      strMsg = strMsg & "Group Link All American File:" & vbCrLf
      strMsg = strMsg & "Subscribers - " & CStr(lngImpS) & vbCrLf
      strMsg = strMsg & "Dependents - " & CStr(lngImpD) & vbCrLf & vbCrLf
      strMsg = strMsg & "Differences: " & vbCrLf
      strMsg = strMsg & "Subscribers - " & CStr(lngImpS - lngCurS) & vbCrLf
      strMsg = strMsg & "Dependents - " & CStr(lngImpD - lngCurD) & vbCrLf & vbCrLf
      strMsg = strMsg & "Are you sure you want to perform this update? " & vbCrLf
      strMsg = strMsg & "This procedure cannot be undone!"
    
      DoCmd.Hourglass False
      
      intResp = MsgBox(strMsg, vbQuestion + vbYesNo + vbDefaultButton2, "QCD: Confirm Action")
      If intResp = vbYes Then
            
            'process the subscribers and dependents
            DoCmd.Hourglass True
            DoCmd.SetWarnings False
            
            ' populate table for all AA groups
            db.Execute "DELETE tblAAGroups.* FROM tblAAGroups;", dbSeeChanges
            db.Execute "INSERT INTO tblAAGroups ( SUBgroupID )" & _
            "SELECT DISTINCT tblEDI_App_Subscr.SUBgroupID " & _
            "FROM tblEDI_App_Subscr;", dbSeeChanges
            
            ' delete subscribers first where the GroupID's match
            strSQL = "DELETE FROM tblSubscr WHERE SUBgroupID IN (Select SUBgroupID FROM tblAAGroups)"
            ExecuteSQL strSQL
            
            'delete subscribers second where the SSN's match
            strSQL = "DELETE FROM tblSubscr WHERE SUBssn IN (SELECT SUBssn FROM tblEDI_App_Subscr)"
            ExecuteSQL strSQL
                
            'populates the SubID control in tblEDI_App_Subscr
            'for all new subscribers who have not been
            'assigned a SubID yet
            Call PopulateEDISubIDs
                    
            'import GroupLink data into QCD database
            ExecuteSQL ("EXEC uspSubscrImport")
            ExecuteSQL ("EXEC uspDepImport")
                                     
            DoCmd.SetWarnings True
            DoCmd.Hourglass False
        
            MsgBox "Import File information imported.", vbExclamation, "QCD: Confirm"
            
            mintProcessStatus = 0
                      
        End If
            
        db.Close
        Set db = Nothing
        
ExitProc:
  Exit Sub

HandleError:
  mintProcessStatus = 0
  MsgBox "Error: " & Err.DESCRIPTION & _
     " (" & Err.Number & ")", vbExclamation
  Resume ExitProc

End Sub

Private Sub cmdPrint_Click()
  ' Comments   : Prints a report of new subscribers
  ' Parameters : None
  ' Created    : 2/28/2004 1:31:11 PM Admin
  ' Modified   :
  '
  ' --------------------------------------------------------
  On Error GoTo HandleError
  
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    'update SQL Server temp table
    ExecuteSQL ("EXEC uspPrintAAreport")
    
    'print preview the report
    DoCmd.OpenReport "rptAA_NewSubscribers", acViewPreview
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
ExitProc:
  Exit Sub

HandleError:
  MsgBox "Error: " & Err.DESCRIPTION & _
     " (" & Err.Number & ")", vbExclamation
  Resume ExitProc
End Sub
Private Sub cmdPrintCards_Click()
   
    On Error GoTo PROC_ERR
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    'update mail card status
    ExecuteSQL ("UPDATE tmpEDI_Rpt Set tmpEDI_Rpt.GRMailCard = tblGrp.GRMailCard " & _
                    "FROM tmpEDI_Rpt INNER JOIN tblGrp ON tmpEDI_Rpt.GroupID = tblGrp.GroupID;")

    DoCmd.OpenReport "rptCardMemAA", acViewPreview
    
    ExecuteSQL ("UPDATE tblSubscr SET tblSubscr.SUBcardPRT = 1, tblSubscr.SUBcardPRTdte = GetDate() " & _
                   "FROM tblSubscr INNER JOIN tmpEDI_Rpt ON tblSubscr.SUBssn = tmpEDI_Rpt.SUBssn;")
PROC_EXIT:

    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
    Exit Sub

PROC_ERR:
    MsgBox Err.DESCRIPTION
    Resume PROC_EXIT
    

End Sub
Private Sub cmdProcess_Click()

    On Error GoTo PROC_ERR
    
    Dim db As DAO.Database
    Dim rst As DAO.Recordset
    Dim strSQL As String
    Dim OutputMeter As Variant
    Dim MeterFull As Integer
    Dim MeterCount As Integer
    
    Set db = CurrentDb()
    
    mintProcessStatus = 0
    
    Application.SetOption "Show Status Bar", True
    MeterFull = 10
    MeterCount = 1
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    'first check to see if there are any duplicate SSN's
    'in the GroupLink table (ELGEXP)
    strSQL = "SELECT ELGEXP.[EISSN#] " & _
             "FROM ELGEXP " & _
             "WHERE (((ELGEXP.EIRECID)='P') AND ((Mid([EINMPLAN],8,3))='QCD')) " & _
             "OR (((ELGEXP.EIRECID)='P') AND ((ELGEXP.EINMPLAN)='QCDBLU-MNL')) " & _
             "GROUP BY ELGEXP.[EISSN#] " & _
             "HAVING (((Count(ELGEXP.[EISSN#]))>1)) OR (((Count(ELGEXP.[EISSN#]))>1));"
    'Debug.Print strSQL
    Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)
    If rst.RecordCount > 0 Then
        MsgBox "There are duplicate SSN's in the Group Link Access file."
        rst.Close
        Set rst = Nothing
        db.Close
        Set db = Nothing
        DoCmd.Hourglass False
        DoCmd.SetWarnings True
        GoTo PROC_EXIT
    End If
    
    ' Update the NULL EISSN#'s
    strSQL = "UPDATE ELGEXP SET ELGEXP.[EISSN#] = Left([EIMBRID],9) WHERE ELGEXP.[EISSN#] Is Null AND EIRECID = 'P';"
    db.Execute strSQL, dbSeeChanges
    strSQL = "UPDATE ELGEXP SET ELGEXP.[EISSN#] = '000000000' WHERE ELGEXP.[EISSN#] Is Null AND EIRECID = 'M';"
    db.Execute strSQL, dbSeeChanges

    'delete data from Group Link table on SQL Server
    OutputMeter = SysCmd(acSysCmdInitMeter, "Deleting data from import table . . .", MeterFull)
    MeterCount = MeterCount + 3
    OutputMeter = SysCmd(acSysCmdUpdateMeter, MeterCount)
    ExecuteSQL ("TRUNCATE TABLE ELGEXP_SQL")
    
    'move data from linked Group Link Access table
    'to Group Link table on SQL Server
    SysCmd (acSysCmdRemoveMeter)
    DoCmd.OpenQuery "qappELGEXP_to_SQL"
        
    'run stored procedures that copy all of the
    'Group Link subscribers and dependents
    'from the Group Link SQL table
    'to QCD tables (tblEDI_App_Subscr & tblEDI_App_Dep)
    OutputMeter = SysCmd(acSysCmdInitMeter, "Processing data from GroupLink . . .", MeterFull)
    MeterCount = MeterCount + 3
    OutputMeter = SysCmd(acSysCmdUpdateMeter, MeterCount)
    ExecuteSQL ("EXEC uspAA_Process")      ' populates tblEDI_App_Subscr & tblEDI_App_Dep
    ExecuteSQL ("EXEC uspUpdateAAImport")  ' updates certain fields on tblEDI_App_Subscr
    
    OutputMeter = SysCmd(acSysCmdRemoveMeter)
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
    MsgBox "The GroupLink data was processed successfully.", vbInformation, "QCD: All American Import"

    mintProcessStatus = 1
    
PROC_EXIT:
    Exit Sub

PROC_ERR:
    mintProcessStatus = 0
    MsgBox Err.DESCRIPTION
    Resume PROC_EXIT
    
End Sub

Private Sub cmdClose_Click()
On Error GoTo Err_cmdClose_Click


    DoCmd.Close

Exit_cmdClose_Click:
    Exit Sub

Err_cmdClose_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_cmdClose_Click
    
End Sub

Private Sub cmdRates_Click()
  ' Comments   : Prints a report of groups
  '              in the GroupLink file who
  '              have rates but the rates
  '              have not been setup in the
  '              QCD database
  ' Parameters : None
  ' Created    : 12/05/2007 John Criswell
  ' Modified   :
  '
  ' --------------------------------------------------------
  On Error GoTo HandleError
  
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    'print preview the report
    DoCmd.OpenReport "rptAA_GroupswithNoRates", acViewPreview
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
ExitProc:
  Exit Sub

HandleError:
  MsgBox "Error: " & Err.DESCRIPTION & _
     " (" & Err.Number & ")", vbExclamation
  Resume ExitProc
End Sub

Private Sub cmdViewChanges_Click()
    
    On Error GoTo PROC_ERR
    
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    
    ' Update the NULL EISSN#'s
    strSQL = "UPDATE ELGEXP SET ELGEXP.[EISSN#] = Left([EIMBRID],9) WHERE ELGEXP.[EISSN#) Is Null AND EIRECID = 'P';"
    db.Execute strSQL, dbSeeChanges
    strSQL = "UPDATE ELGEXP SET ELGEXP.[EISSN#] = '000000000' WHERE ELGEXP.[EISSN#) Is Null AND EIRECID = 'M';"
    db.Execute strSQL, dbSeeChanges

    ' move data from linked Access to SQL Server
    ExecuteSQL ("TRUNCATE TABLE ELGEXP_SQL")
    DoCmd.OpenQuery "qappELGEXP_to_SQL"
    
    ExecuteSQL ("EXEC uspAA_VarianceReport")
    
    DoCmd.OpenReport "rptAA_VarianceReport", acViewPreview
    
    DoCmd.SetWarnings True
    DoCmd.Hourglass False
    
PROC_EXIT:
    Exit Sub

PROC_ERR:
    MsgBox Err.DESCRIPTION
    Resume PROC_EXIT
End Sub


Private Sub Command10_Click()

End Sub
Private Sub cmdRemoveDups_Click()
On Error GoTo Err_cmdRemoveDups_Click

    Dim stDocName As String
    
    DoCmd.SetWarnings True
    stDocName = "ELGEXP_RemoveMarkedDups"
    DoCmd.OpenQuery stDocName, acNormal, acEdit
    
    MsgBox "Dups have been removed from the Import Table.", vbInformation, "Dups Removed"
    
Exit_cmdRemoveDups_Click:
    Exit Sub

Err_cmdRemoveDups_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_cmdRemoveDups_Click
    
End Sub

Private Sub cmdViewDups_Enter()
    DoCmd.OpenQuery "ELGSEP_DupEdit"
End Sub