Version =19
VersionRequired =19
Checksum =-790317522
Begin Form
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    DividingLines = NotDefault
    FilterOn = NotDefault
    OrderByOn = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    GridX =16
    GridY =16
    Width =10815
    ItemSuffix =242
    Left =4065
    Top =1710
    Right =14880
    Bottom =10605
    AfterInsert ="[Event Procedure]"
    Filter ="[GRcancelled] = False"
    OrderBy ="GRname"
    RecSrcDt = Begin
        0xc3f5281475a7e240
    End
    RecordSource ="tblGrp"
    Caption ="Group Information"
    OnCurrent ="[Event Procedure]"
    BeforeUpdate ="[Event Procedure]"
    AfterUpdate ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    MenuBar ="GrpMenuBar"
    PrtMip = Begin
        0xa0050000a0050000a0050000a0050000000000003f2a00009318000001000000 ,
        0x010000006801000000000000a10700000100000000000000
    End
    PrtDevMode = Begin
        0x5c5c7773323030335c4850343230300000000000000000000000000000000000 ,
        0x010400069c00ec1443ff800701000100ea0a6f08640001000f00580202000100 ,
        0x5802020000004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x020000000c010000ffffffff0000000000000000000000000000000044494e55 ,
        0x220030036c05800fbc9264af0000000000000000000000000000000000000000 ,
        0x0000000000000000200000000000000001000100000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000000000000 ,
        0x0000000000000200000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000030030000534d544a ,
        0x00000000100020034800500020004c0061007300650072004a00650074002000 ,
        0x34003200300030002000500043004c00200036000000496e70757442696e0046 ,
        0x4f524d534f5552434500524553444c4c00556e69726573444c4c005265736f6c ,
        0x7574696f6e0036303064706900466173745265730054727565004f7269656e74 ,
        0x6174696f6e00504f5254524149540048504f7269656e74526f74617465313830 ,
        0x0046616c7365004850537461706c696e674f70706f7365640046616c73650050 ,
        0x6170657253697a65004c4554544552004d6564696154797065004175746f0044 ,
        0x75706c6578004e4f4e45004850466f6e74496e7374616c6c6572005452554500 ,
        0x4850504a4c456e636f64696e670055544638004f757470757442696e00417574 ,
        0x6f00537461706c696e67004e6f6e6500537461706c696e67436d6443616c6c62 ,
        0x61636b00537461706c696e67436d64436200436f6c6c617465004f4646004a52 ,
        0x436f6e73747261696e7473004a524348445061727469616c004a524844496e73 ,
        0x74616c6c6564004a5248444f6666004a5248444e6f74496e7374616c6c656400 ,
        0x4a5248444f666600545441734269746d61707353657474696e670054544d6f64 ,
        0x654f75746c696e650052455443686f69636500547275650048504c706953656c ,
        0x656374696f6e004e6f6e6500485050434c36506173735468726f756768005472 ,
        0x7565004a52436d6443616c6c6261636b004a52004850436f6c6f724d6f646500 ,
        0x4d4f4e4f4348524f4d455f4d4f4445004850426f726e4f6e4461746500485042 ,
        0x4f440048504a6f6242794a6f624f76657272696465004a424a4f004850584d4c ,
        0x46696c6555736564004850584d4c46696c654e616d6500485050444c54797065 ,
        0x0050444c5f50434c36005072696e745175616c69747947726f75700050514772 ,
        0x6f75705f330045636f6e6f6d6f64650046616c73650048504a6f624163636f75 ,
        0x6e74696e670048504a4f42414343545f4a4f4241434e54000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000800f00004955504801001100000000000100000002000000 ,
        0x0100000000000000000000000300000000000000000000000100010064000100 ,
        0x000002000200000001000000020000004c006500740074006500720000000000 ,
        0x0000000000000000000000000000000000000000010000000600000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000020005b006e006f006e006500 ,
        0x5d00000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000020005b006e006f006e006500 ,
        0x5d00000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000041007200690061006c000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000340000005000000000000000 ,
        0x0100000000000000c0c0c00000000000c0c0c000040000000000000000000000 ,
        0x00000000010000000100000064000000000000000000803f0000000000000000 ,
        0x0000000000000000010000000000000000000000000000000201000008010000 ,
        0x000000000000000000000000010000000000000000000000000000004a004f00 ,
        0x48004e0043000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000003c00 ,
        0x4100750074006f006d0061007400690063003e00000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000000010000000100000001000000010000000100000001000000 ,
        0x0100000001000000000000000000000001000000000000000000000001000000 ,
        0x30000000010000000000000000000000010000000f0000000c01000000000000 ,
        0x0f0000000c010000000000000200000000000000000000000f0000000c010000 ,
        0x0f0000000c010000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x02000000ffffffff
    End
    PrtDevNames = Begin
        0x080012002300010077696e73706f6f6c00005c5c7773323030335c4850343230 ,
        0x300000485034323030000000000000000000000000000000000000
    End
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
        End
        Begin CommandButton
            TextFontFamily =2
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ListBox
            SpecialEffect =2
            FontName ="Tahoma"
        End
        Begin ComboBox
            AutoLabel = NotDefault
            Width =865
        End
        Begin Subform
            SpecialEffect =2
        End
        Begin Tab
            FontName ="Tahoma"
        End
        Begin FormHeader
            Height =0
            BackColor =12632256
            Name ="FormHeader1"
        End
        Begin Section
            CanGrow = NotDefault
            SpecialEffect =2
            Height =7470
            BackColor =12632256
            Name ="Detail0"
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =480
                    Top =60
                    Width =975
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text4"
                    Caption ="Group ID:"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =405
                    Top =345
                    Width =1050
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text5"
                    Caption ="Grp Name:"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =510
                    Top =615
                    Width =945
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text6"
                    Caption =" Address:"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =405
                    Top =885
                    Width =1050
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text7"
                    Caption ="Address 2:"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =351
                    Top =1155
                    Width =1104
                    Height =228
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text8"
                    Caption ="City/ST/Zip:"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =1479
                    Top =375
                    Width =3399
                    TabIndex =1
                    Name ="ctlGRname"
                    ControlSource ="GRname"
                    StatusBarText ="Green Color indicates that this group is either on hold or has cancelled."
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =1479
                    Top =645
                    Width =3399
                    TabIndex =2
                    Name ="GRstreet1"
                    ControlSource ="GRstreet1"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =1479
                    Top =915
                    Width =3399
                    TabIndex =3
                    Name ="GRstreet2"
                    ControlSource ="GRstreet2"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =1479
                    Top =1185
                    Width =1719
                    TabIndex =4
                    Name ="GRcity"
                    ControlSource ="GRcity"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =3261
                    Top =1185
                    Width =399
                    TabIndex =5
                    Name ="GRstate"
                    ControlSource ="GRstate"
                End
                Begin TextBox
                    DecimalPlaces =0
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =3711
                    Top =1185
                    Width =1179
                    TabIndex =6
                    Name ="GRzip"
                    ControlSource ="GRzip"
                    InputMask ="00000\\-9999;;_"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =816
                    Top =1770
                    Width =648
                    Height =228
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text17"
                    Caption ="Phone:"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =111
                    Top =1500
                    Width =1353
                    Height =228
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text18"
                    Caption ="Main Contact:"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =87
                    TextAlign =1
                    Left =1479
                    Top =1785
                    Width =1622
                    TabIndex =9
                    Name ="GRphone1"
                    ControlSource ="GRphone1"
                    InputMask ="!\\(999\") \"000\\-0000;0;_"
                    OnClick ="[Event Procedure]"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =87
                    TextAlign =1
                    Left =1479
                    Top =1500
                    Width =1628
                    TabIndex =7
                    Name ="GRmainCONT"
                    ControlSource ="GRmainCONT"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =90
                    Top =5595
                    Width =1323
                    Height =228
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text38"
                    Caption ="Contract Beg:"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =1458
                    Top =5595
                    Width =1119
                    TabIndex =17
                    Name ="GRcontBEG"
                    ControlSource ="GRcontBEG"
                    Format ="m/d/yyyy"
                    BeforeUpdate ="[Event Procedure]"
                    InputMask ="99/99/0000;0;_"
                    OnClick ="[Event Procedure]"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =3945
                    Top =5580
                    Width =1104
                    TabIndex =18
                    Name ="GRcontEND"
                    ControlSource ="GRcontEND"
                    Format ="m/d/yyyy"
                    BeforeUpdate ="[Event Procedure]"
                    InputMask ="99/99/0000;0;_"
                    OnClick ="[Event Procedure]"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =2625
                    Top =5595
                    Width =1245
                    Height =255
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text41"
                    Caption ="Contract End:"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =792
                    Top =2868
                    Width =672
                    Height =228
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text50"
                    Caption ="Geo Id:"
                End
                Begin ComboBox
                    SpecialEffect =2
                    OverlapFlags =87
                    TextAlign =1
                    ColumnCount =2
                    ListWidth =3130
                    Left =1479
                    Top =2883
                    Width =3398
                    TabIndex =15
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"50\""
                    Name ="GRPgeoID"
                    ControlSource ="GRPgeoID"
                    RowSourceType ="Table/Query"
                    RowSource ="Select [tblGeographical].GEOid,[GEOdesc] From [tblGeographical] ORDER BY [GEOdes"
                        "c];"
                    ColumnWidths ="0;1440"
                    BaseInfo ="\"Select [tblGeographical].GEOid,[GEOdesc] From [tblGeographical] ORDER BY [GEOd"
                        "esc];\";\"tblGeographical\";\"\";\"GEOid\";\"GEOdesc\";\"PK_tblGeographical\""
                End
                Begin Label
                    SpecialEffect =4
                    BackStyle =1
                    OldBorderStyle =1
                    BorderWidth =3
                    OverlapFlags =93
                    TextAlign =1
                    Left =5115
                    Top =660
                    Width =1899
                    Height =273
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text69"
                    Caption =" Agent Information"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =2958
                    Top =2334
                    Width =420
                    Height =228
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text73"
                    Caption ="Fax:"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =3414
                    Top =2334
                    Width =1454
                    TabIndex =13
                    Name ="GRfax"
                    ControlSource ="GRfax"
                    InputMask ="!\\(999\") \"000\\-0000;0;_"
                    OnClick ="[Event Procedure]"
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =8208
                    Top =6645
                    Width =1575
                    Height =225
                    FontWeight =700
                    BackColor =65535
                    Name ="Text149"
                    Caption ="Enter Group ID: "
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =223
                    Left =9228
                    Top =6600
                    Width =983
                    TabIndex =27
                    BackColor =65535
                    Name ="FindGROUPid"
                    AfterUpdate ="=FINDgroupID([FINDgroupID],\"GROUPid\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1275
                    Top =6690
                    Width =312
                    TabIndex =29
                    Name ="B"
                    Caption ="B"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1587
                    Top =6690
                    Width =327
                    TabIndex =30
                    Name ="C"
                    Caption ="C"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1914
                    Top =6690
                    Width =327
                    TabIndex =31
                    Name ="D"
                    Caption ="D"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =2241
                    Top =6690
                    Width =297
                    TabIndex =32
                    Name ="E"
                    Caption ="E"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =2538
                    Top =6690
                    Width =297
                    TabIndex =33
                    Name ="F"
                    Caption ="F"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =2835
                    Top =6690
                    Width =327
                    TabIndex =34
                    Name ="G"
                    Caption ="G"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =3162
                    Top =6690
                    Width =327
                    TabIndex =35
                    Name ="H"
                    Caption ="H"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =3489
                    Top =6690
                    Width =342
                    TabIndex =36
                    Name ="I"
                    Caption ="I"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =4158
                    Top =6690
                    Width =327
                    TabIndex =38
                    Name ="K"
                    Caption ="K"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =4485
                    Top =6690
                    Width =327
                    TabIndex =39
                    Name ="L"
                    Caption ="L"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =4812
                    Top =6690
                    Width =327
                    TabIndex =40
                    Name ="M"
                    Caption ="M"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =5139
                    Top =6690
                    Width =327
                    TabIndex =41
                    Name ="N"
                    Caption ="N"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =5466
                    Top =6690
                    Width =327
                    TabIndex =42
                    Name ="O"
                    Caption ="O"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =5793
                    Top =6690
                    Width =327
                    TabIndex =43
                    Name ="P"
                    Caption ="P"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =6120
                    Top =6690
                    Width =312
                    TabIndex =44
                    Name ="Q"
                    Caption ="Q"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =6432
                    Top =6690
                    Width =342
                    TabIndex =45
                    Name ="R"
                    Caption ="R"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =6774
                    Top =6690
                    Width =312
                    TabIndex =46
                    Name ="S"
                    Caption ="S"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7083
                    Top =6690
                    Width =312
                    TabIndex =47
                    Name ="T"
                    Caption ="T"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7398
                    Top =6690
                    Width =327
                    TabIndex =48
                    Name ="U"
                    Caption ="U"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7725
                    Top =6690
                    Width =327
                    TabIndex =49
                    Name ="V"
                    Caption ="V"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =215
                    Left =8058
                    Top =6690
                    Width =387
                    TabIndex =50
                    Name ="W"
                    Caption ="W"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =223
                    Left =8439
                    Top =6690
                    Width =312
                    TabIndex =51
                    Name ="X"
                    Caption ="X"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =223
                    Left =8748
                    Top =6690
                    Width =342
                    TabIndex =52
                    Name ="Y"
                    Caption ="Y"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =255
                    Left =9093
                    Top =6690
                    Width =327
                    TabIndex =53
                    Name ="Z"
                    Caption ="Z"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin ComboBox
                    ColumnHeads = NotDefault
                    LimitToList = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    AccessKey =78
                    ColumnCount =3
                    ListRows =5
                    Left =3795
                    Top =7116
                    Width =4476
                    TabIndex =54
                    BackColor =12632256
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"10\""
                    Name ="GroupPickList"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT DISTINCTROW tblGrp.GROUPid AS Group_ID, tblGrp.GRname AS Group_Name, tblG"
                        "rp.GRcancelled FROM tblGrp WHERE (((tblGrp.GROUPid) Like [Forms]![frmGrp]![Alpha"
                        "Control] & \"*\")) ORDER BY tblGrp.GROUPid;"
                    ColumnWidths ="936;2160;0"
                    StatusBarText ="Enter Group (last) name or click on arrow to view list."
                    AfterUpdate ="=FindID([Forms]![frmGrp],[GroupPickList],\"[GROUPid]\",\"GroupPickList\")"
                    OnEnter ="=SetLabelColor([],255)"
                    OnExit ="=SetLabelColor([],0)"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =2580
                            Top =7116
                            Width =1170
                            Height =240
                            FontWeight =700
                            BorderColor =16777215
                            Name ="lblGroupPickList"
                            Caption ="Group &Name:"
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =1
                    OverlapFlags =85
                    AccessKey =70
                    Left =1830
                    Top =7116
                    Width =675
                    Height =245
                    TabIndex =55
                    BackColor =12632256
                    Name ="AlphaControl"
                    StatusBarText ="Enter a letter or letters to filter on (e.g. \"smith\") and TAB out of field."
                    OnEnter ="=SetLabelColor([],255)"
                    OnExit ="=SearchBtn(\"GroupPickList\")"
                    DefaultValue ="\"*\""
                    FontName ="Helv"
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextFontFamily =0
                            Left =960
                            Top =7116
                            Width =840
                            Height =240
                            FontWeight =700
                            ForeColor =12582912
                            Name ="lblAlphaControl"
                            Caption ="&Filter on:"
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =963
                    Top =6690
                    Width =312
                    TabIndex =28
                    Name ="A"
                    Caption ="A"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =215
                    Left =3828
                    Top =6690
                    Width =342
                    TabIndex =37
                    Name ="J"
                    Caption ="J"
                    OnClick ="=AlphaBtn([Form],\"GroupPickList\")"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =1479
                    Top =78
                    Width =864
                    Name ="ctlGROUPid"
                    ControlSource ="GROUPid"
                    AfterUpdate ="[Event Procedure]"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =90
                    Top =5955
                    Width =690
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text93"
                    Caption ="Notes:"
                End
                Begin TextBox
                    EnterKeyBehavior = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =85
                    Left =855
                    Top =5895
                    Width =9588
                    Height =678
                    TabIndex =19
                    Name ="GRnotes"
                    ControlSource ="GRnotes"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =90
                    Top =2040
                    Width =1374
                    Height =228
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text96"
                    Caption ="Serv. Contact:"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =87
                    TextAlign =1
                    Left =1479
                    Top =2055
                    Width =1628
                    TabIndex =10
                    Name ="GRsrvCONT"
                    ControlSource ="GRsrvCONT"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =834
                    Top =2310
                    Width =648
                    Height =228
                    FontWeight =700
                    BackColor =12632256
                    Name ="Text100"
                    Caption ="Phone:"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =87
                    TextAlign =1
                    Left =1479
                    Top =2325
                    Width =1370
                    TabIndex =12
                    Name ="GRphone2"
                    ControlSource ="GRphone2"
                    InputMask ="!\\(999\") \"000\\-0000;0;_"
                    OnClick ="[Event Procedure]"
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =8790
                    Top =7191
                    Width =900
                    Height =255
                    FontWeight =700
                    BackColor =65535
                    Name ="Text91"
                    Caption ="CustClass"
                End
                Begin TextBox
                    Visible = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =223
                    Left =9210
                    Top =7146
                    Width =984
                    TabIndex =56
                    BackColor =65535
                    Name ="GRclassKEY"
                    ControlSource ="GRclassKEY"
                    DefaultValue ="=\"GROUP\""
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =255
                    TextAlign =3
                    Left =8553
                    Top =6795
                    Width =1215
                    Height =255
                    FontWeight =700
                    BackColor =65535
                    Name ="Text106"
                    Caption ="DateCreated:"
                End
                Begin TextBox
                    Visible = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =255
                    TextAlign =3
                    Left =9213
                    Top =6750
                    Width =1014
                    TabIndex =57
                    BackColor =65535
                    Name ="DateCreated"
                    ControlSource ="DateCreated"
                    Format ="m/d/yyyy"
                    DefaultValue ="=Date()"
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =255
                    TextAlign =3
                    Left =8445
                    Top =7011
                    Width =1275
                    Height =255
                    FontWeight =700
                    BackColor =65535
                    Name ="Text108"
                    Caption ="DateUpdated:"
                End
                Begin TextBox
                    Visible = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =247
                    TextAlign =3
                    Left =9165
                    Top =6966
                    Width =1089
                    TabIndex =58
                    BackColor =65535
                    Name ="DateUpdated"
                    ControlSource ="DateUpdated"
                    Format ="m/d/yyyy"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =6360
                    Top =60
                    Width =1260
                    Height =255
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label120"
                    Caption ="Cancel Date: "
                End
                Begin TextBox
                    Enabled = NotDefault
                    OldBorderStyle =1
                    OverlapFlags =87
                    Left =7635
                    Top =75
                    Width =921
                    Height =255
                    FontSize =7
                    TabIndex =21
                    Name ="ctlGRcancelledDate"
                    ControlSource ="GRcancelledDate"
                    Format ="m/d/yyyy"
                    BeforeUpdate ="[Event Procedure]"
                    InputMask ="99/99/0000;0;_"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =93
                    Left =9765
                    Top =60
                    Width =921
                    Height =255
                    FontSize =7
                    TabIndex =22
                    Name ="ctlGRreinstatedDate"
                    ControlSource ="GRreinstatedDate"
                    Format ="m/d/yyyy"
                    BeforeUpdate ="[Event Procedure]"
                    InputMask ="99/99/0000;0;_"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =87
                    TextAlign =3
                    Left =8625
                    Top =60
                    Width =1125
                    Height =255
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label123"
                    Caption ="Reinstated: "
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =5115
                    Top =75
                    Width =945
                    Height =255
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label124"
                    Caption ="Cancel: "
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =223
                    TextAlign =3
                    Left =6630
                    Top =390
                    Width =1560
                    Height =255
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label125"
                    Caption ="Spec.Cardstock: "
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =8520
                    Top =360
                    Width =1245
                    Height =255
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label127"
                    Caption ="Invoice Sort: "
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =87
                    TextAlign =2
                    Left =9765
                    Top =360
                    Width =306
                    Height =255
                    FontSize =7
                    TabIndex =26
                    Name ="ctlGRinvSort"
                    ControlSource ="GRinvSort"
                    Format =" "
                    StatusBarText ="Does this group want invoices sorted by (N)ame or (R)ate."
                    ValidationRule ="\"R\" Or \"N\""
                    ValidationText ="You must enter either an R for Rate or N for Name."
                    DefaultValue ="\"R\""
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =876
                    Top =2598
                    Width =588
                    Height =228
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label132"
                    Caption ="Email:"
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =87
                    TextAlign =1
                    Left =1479
                    Top =2613
                    Width =3398
                    TabIndex =14
                    Name ="ctlGRemail"
                    ControlSource ="GRemail"
                    StatusBarText ="Group's email address."
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =5130
                    Top =360
                    Width =915
                    Height =255
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label134"
                    Caption ="Bill.Hold: "
                End
                Begin CheckBox
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =215
                    Left =6075
                    Top =105
                    Width =540
                    Height =180
                    TabIndex =20
                    Name ="ctlGRcancelled"
                    ControlSource ="GRcancelled"
                    AfterUpdate ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =6075
                    Top =405
                    Width =540
                    Height =180
                    TabIndex =23
                    Name ="ctlGRhold"
                    ControlSource ="GRhold"
                    StatusBarText ="A check here indicates that this customer is not to receive an invoice."
                    AfterUpdate ="[Event Procedure]"
                End
                Begin CheckBox
                    OverlapFlags =215
                    Left =8175
                    Top =435
                    Width =315
                    Height =180
                    TabIndex =24
                    Name ="ctlGRcardstock"
                    ControlSource ="GRcardstock"
                    StatusBarText ="A check here indicates that this customer requires special cardstock when printi"
                        "ng member cards."
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =3144
                    Top =2055
                    Width =540
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label141"
                    Caption ="Title: "
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =87
                    TextAlign =1
                    Left =3684
                    Top =2055
                    Width =1193
                    TabIndex =11
                    Name ="ctlGRsrvCONTtitle"
                    ControlSource ="GRsrvCONTtitle"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    TextAlign =3
                    Left =3144
                    Top =1500
                    Width =540
                    Height =240
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label143"
                    Caption ="Title: "
                End
                Begin TextBox
                    OldBorderStyle =1
                    OverlapFlags =87
                    TextAlign =1
                    Left =3684
                    Top =1500
                    Width =1193
                    TabIndex =8
                    Name ="ctlGRmainCONTtitle"
                    ControlSource ="GRmainCONTtitle"
                End
                Begin Subform
                    OverlapFlags =85
                    Left =1497
                    Top =3162
                    Width =2673
                    Height =474
                    TabIndex =59
                    Name ="Child150"
                    SourceObject ="Form.fsubEligEmps"
                    LinkChildFields ="GroupID"
                    LinkMasterFields ="GROUPid"
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =1050
                    Top =3150
                    Width =360
                    Height =228
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label153"
                    Caption ="EE:"
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    SpecialEffect =2
                    OverlapFlags =85
                    TextAlign =1
                    ColumnCount =2
                    Left =1512
                    Top =3690
                    Width =1080
                    TabIndex =16
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"100\""
                    Name ="GRannvDATE"
                    ControlSource ="GRannvDATE"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tblCalendar.calID, tblCalendar.calMonth FROM tblCalendar;"
                    ColumnWidths ="0;1080"
                    StatusBarText ="Group's Section 125 Anniversary Date"
                    DefaultValue ="13"
                    BaseInfo ="\"SELECT tblCalendar.calID, tblCalendar.calMonth FROM tblCalendar;\";\"tblCalend"
                        "ar\";\"\";\"calID\";\"calMonth\";\"PK_tblCalendar\""
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            TextAlign =3
                            Left =90
                            Top =3690
                            Width =1365
                            Height =270
                            FontWeight =700
                            BackColor =12632256
                            Name ="Text111"
                            Caption ="Sec 125 Anniv:"
                        End
                    End
                End
                Begin OptionGroup
                    OverlapFlags =85
                    Left =180
                    Top =4215
                    Width =1127
                    Height =973
                    TabIndex =60
                    Name ="optgrpMailCard"
                    ControlSource ="GRMailCard"
                    DefaultValue ="1"
                    Begin
                        Begin Label
                            SpecialEffect =4
                            BackStyle =1
                            OldBorderStyle =1
                            BorderWidth =3
                            OverlapFlags =215
                            Left =300
                            Top =4095
                            Width =1035
                            Height =270
                            FontWeight =700
                            BackColor =12632256
                            Name ="Label175"
                            Caption ="Mail Card"
                        End
                        Begin OptionButton
                            OverlapFlags =95
                            Left =360
                            Top =4453
                            OptionValue =1
                            Name ="Option177"
                            Begin
                                Begin Label
                                    OverlapFlags =255
                                    Left =590
                                    Top =4425
                                    Width =480
                                    Height =240
                                    Name ="Label178"
                                    Caption ="Empr"
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =95
                            Left =360
                            Top =4693
                            OptionValue =2
                            Name ="Option179"
                            Begin
                                Begin Label
                                    OverlapFlags =255
                                    Left =590
                                    Top =4665
                                    Width =525
                                    Height =240
                                    Name ="Label180"
                                    Caption ="Empe"
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =360
                            Top =4933
                            OptionValue =3
                            Name ="Option181"
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =590
                                    Top =4905
                                    Width =375
                                    Height =240
                                    Name ="Label182"
                                    Caption ="Oth"
                                End
                            End
                        End
                    End
                End
                Begin OptionGroup
                    OverlapFlags =85
                    Left =1530
                    Top =4185
                    Width =1982
                    Height =765
                    TabIndex =61
                    Name ="optgrpGroupType"
                    ControlSource ="GroupType"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"
                    Begin
                        Begin Label
                            SpecialEffect =4
                            BackStyle =1
                            OldBorderStyle =1
                            BorderWidth =3
                            OverlapFlags =215
                            Left =1650
                            Top =4065
                            Width =1125
                            Height =300
                            FontWeight =700
                            BackColor =12632256
                            Name ="Label186"
                            Caption ="Group Type"
                        End
                        Begin OptionButton
                            OverlapFlags =95
                            Left =1710
                            Top =4453
                            OptionValue =1
                            Name ="Option188"
                            Begin
                                Begin Label
                                    OverlapFlags =255
                                    Left =1890
                                    Top =4425
                                    Width =1464
                                    Height =240
                                    Name ="Label189"
                                    Caption ="QCD Only"
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =247
                            Left =1710
                            Top =4680
                            OptionValue =4
                            Name ="Option194"
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =1890
                                    Top =4665
                                    Width =1464
                                    Height =239
                                    Name ="Label195"
                                    Caption ="All American"
                                End
                            End
                        End
                    End
                End
                Begin CheckBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =8175
                    Top =690
                    TabIndex =25
                    Name ="Ins"
                    ControlSource ="Ins"
                    StatusBarText ="Insurance/Indemnity groups"
                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =8409
                            Top =660
                            Width =2244
                            Height =228
                            FontWeight =700
                            Name ="Label172"
                            Caption ="Mixed - MCB && Insurance"
                        End
                    End
                End
                Begin Subform
                    OverlapFlags =87
                    Left =5130
                    Top =1260
                    Width =5400
                    Height =1800
                    TabIndex =62
                    Name ="sfrmAgents"
                    SourceObject ="Form.sfrmAgents"
                    LinkChildFields ="GROUPid"
                    LinkMasterFields ="GROUPid"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =2
                    Left =5340
                    Top =990
                    Width =630
                    Height =270
                    FontWeight =700
                    Name ="lblName"
                    Caption ="Name"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =2
                    Left =8775
                    Top =990
                    Width =270
                    Height =270
                    FontWeight =700
                    Name ="lblID"
                    Caption ="ID"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =2
                    Left =9570
                    Top =990
                    Width =540
                    Height =270
                    FontWeight =700
                    Name ="lblRate"
                    Caption ="Rate"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =2
                    Left =7710
                    Top =990
                    Width =540
                    Height =270
                    FontWeight =700
                    Name ="lblType"
                    Caption ="Type"
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =2
                    Left =8265
                    Top =990
                    Width =330
                    Height =270
                    FontWeight =700
                    Name ="Label206"
                    Caption ="Pri"
                End
                Begin ComboBox
                    SpecialEffect =2
                    OldBorderStyle =0
                    OverlapFlags =87
                    ColumnCount =2
                    Left =3510
                    Top =3705
                    Width =1350
                    TabIndex =63
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"60\""
                    Name ="GRClientSvcRepID"
                    ControlSource ="GRClientSvcRepID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tlkpClientServiceReps.RepID, tlkpClientServiceReps.RepName FROM tlkpClien"
                        "tServiceReps;"
                    ColumnWidths ="0;1440"
                    BaseInfo ="\"SELECT tlkpClientServiceReps.RepID, tlkpClientServiceReps.RepName FROM tlkpCli"
                        "entServiceReps;\";\"tlkpClientServiceReps\";\"\";\"RepID\";\"RepName\";\"PK_tlkp"
                        "ClientServiceReps\""
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =2655
                            Top =3705
                            Width =855
                            Height =240
                            FontWeight =700
                            Name ="Label207"
                            Caption ="Grp Size:"
                        End
                    End
                End
                Begin OptionGroup
                    OverlapFlags =85
                    Left =3690
                    Top =4170
                    Width =1577
                    Height =778
                    TabIndex =64
                    Name ="Frame209"
                    ControlSource ="InvoiceType"
                    DefaultValue ="1"
                    Begin
                        Begin Label
                            SpecialEffect =4
                            BackStyle =1
                            OldBorderStyle =1
                            BorderWidth =3
                            OverlapFlags =215
                            Left =3810
                            Top =4050
                            Width =1245
                            Height =285
                            FontWeight =700
                            BackColor =12632256
                            Name ="Label210"
                            Caption ="Invoice Type"
                        End
                        Begin OptionButton
                            OverlapFlags =95
                            Left =3876
                            Top =4408
                            OptionValue =1
                            Name ="Option212"
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =4106
                                    Top =4380
                                    Width =405
                                    Height =240
                                    Name ="Label213"
                                    Caption ="SSN"
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =3870
                            Top =4663
                            OptionValue =2
                            Name ="Option214"
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =4100
                                    Top =4635
                                    Width =1035
                                    Height =240
                                    Name ="Label215"
                                    Caption ="Subscriber ID"
                                End
                            End
                        End
                    End
                End
                Begin ListBox
                    ColumnHeads = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =3
                    Left =5580
                    Top =4050
                    Width =4950
                    Height =1350
                    TabIndex =68
                    Name ="lstCoverageRate"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tblPlans.PlanDesc AS Plan, tblCoverage.COVERdescr AS Description, Format("
                        "[Rate],\"Standard\") AS Rates, tblRates.RateID, tblRates.PlanID, tblRates.CoverI"
                        "D FROM (tblRates INNER JOIN tblCoverage ON tblRates.CoverID = tblCoverage.CoverI"
                        "D) INNER JOIN tblPlans ON tblRates.PlanID = tblPlans.PlanID WHERE (((tblRates.Gr"
                        "oupID)=[Forms]![frmGrp]![ctlGROUPid])) ORDER BY tblRates.PlanID, tblRates.CoverI"
                        "D;"
                    ColumnWidths ="1080;2520;720"
                    OnDblClick ="[Event Procedure]"
                    GUID = Begin
                        0x5566386d36cdf3488fd970212340e9f7
                    End
                End
                Begin ComboBox
                    SpecialEffect =2
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =3024
                    Left =6435
                    Top =3660
                    Width =1890
                    Height =270
                    TabIndex =66
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"100\""
                    GUID = Begin
                        0x1398f7c454f9204491273e7fcfbf08ee
                    End
                    Name ="cboCoverage"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tblCoverage.CoverID, tblCoverage.COVERdescr, tblCoverage.COVERcode FROM t"
                        "blCoverage ORDER BY tblCoverage.CoverID;"
                    ColumnWidths ="0;2160;720"
                    AfterUpdate ="[Event Procedure]"
                    BaseInfo ="\"SELECT tblCoverage.CoverID, tblCoverage.COVERdescr, tblCoverage.COVERcode FROM"
                        " tblCoverage ORDER BY tblCoverage.CoverID;\";\"tblCoverage\";\"\";\"CoverID\";\""
                        "COVERdescr\";\"PK_tblCoverage\""
                End
                Begin TextBox
                    DecimalPlaces =2
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =8370
                    Top =3660
                    Width =810
                    Height =270
                    TabIndex =67
                    Name ="txtRate"
                    Format ="$#,##0.00;($#,##0.00)"
                    GUID = Begin
                        0x2814fffb81aa5042addb84498e1b2822
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =6030
                    Top =3150
                    Width =810
                    Height =270
                    TabIndex =69
                    BackColor =10092543
                    Name ="txtRateID"
                    GUID = Begin
                        0x5c42ad4f3d190b4ebfe7480e52a3dc04
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =9270
                    Top =3600
                    Width =1260
                    FontSize =8
                    TabIndex =70
                    Name ="cmdRateAddUpdate"
                    Caption ="Add/Update"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    GUID = Begin
                        0x82c176a440209a41a1f8a7baefe33600
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =9270
                    Top =3240
                    Width =900
                    Height =317
                    FontSize =8
                    TabIndex =71
                    Name ="cmdRateCoverageDelete"
                    Caption ="Delete"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    GUID = Begin
                        0xb8b60e6f2829c04cac0f61d6d180adfc
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =8910
                    Top =5490
                    Width =1530
                    FontSize =8
                    TabIndex =72
                    Name ="cmdEditCoverages"
                    Caption ="Edit Coverages"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    GUID = Begin
                        0x71065f84c79e1c4a9a34e4287cdeed30
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =247
                    TextAlign =3
                    Left =6435
                    Top =3390
                    Width =960
                    Height =225
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label230"
                    Caption ="Coverage:"
                    GUID = Begin
                        0x2f66b69e1222b04783efd76659a591c0
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    SpecialEffect =2
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =1080
                    Left =5295
                    Top =3660
                    Width =1080
                    Height =270
                    TabIndex =65
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"100\""
                    GUID = Begin
                        0xa68820694cfb4243a6b7f7883304568c
                    End
                    Name ="cboPlan"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tblPlans.PlanID, tblPlans.PlanDesc FROM tblPlans;"
                    ColumnWidths ="0;2160"
                    BaseInfo ="\"SELECT tblPlans.PlanID, tblPlans.PlanDesc FROM tblPlans;\";\"tblPlans\";\"\";\""
                        "PlanID\";\"PlanDesc\";\"PK_tblPlans\""
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =1
                    Left =5280
                    Top =3390
                    Width =585
                    Height =225
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label232"
                    Caption ="Plan:"
                    GUID = Begin
                        0xadc1446418c95f4eabab30cb8c79dd06
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =3
                    Left =8370
                    Top =3390
                    Width =585
                    Height =225
                    FontWeight =700
                    BackColor =12632256
                    Name ="Label233"
                    Caption ="Rate:"
                    GUID = Begin
                        0x8a3547e4eb37414483c6f78278739e28
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =93
                    IMESentenceMode =3
                    ListRows =4
                    ListWidth =1080
                    Left =1530
                    Top =5220
                    Width =1080
                    Height =270
                    TabIndex =73
                    GUID = Begin
                        0xca88ab06afdc2647afdae467fbda2bdf
                    End
                    Name ="cboOrthoCoverage"
                    ControlSource ="OrthoCoverage"
                    RowSourceType ="Value List"
                    RowSource ="\"Adult\";\"Child\";\"Both\";\"None\""
                    ColumnWidths ="1440"
                    DefaultValue ="\"None\""
                End
                Begin Label
                    OverlapFlags =95
                    Left =1530
                    Top =4980
                    Width =1440
                    Height =240
                    FontWeight =700
                    Name ="Label237"
                    Caption ="Ortho Coverage"
                    GUID = Begin
                        0xfe64563e5108454e95d44d311fcd8c1c
                    End
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =95
                    IMESentenceMode =3
                    ListWidth =1080
                    Left =2970
                    Top =5220
                    Width =1080
                    Height =270
                    TabIndex =74
                    GUID = Begin
                        0xbb388424fe074d45a5f8d648c7a4822b
                    End
                    Name ="cboOrthoLimit"
                    ControlSource ="OrthoLifetimeLimit"
                    RowSourceType ="Value List"
                    RowSource ="\"1,000\";\"1,500\";\"2,000\";\"2,500\""
                    ColumnWidths ="1440"
                End
                Begin Label
                    OverlapFlags =87
                    Left =2970
                    Top =4980
                    Width =1080
                    Height =240
                    FontWeight =700
                    Name ="Label239"
                    Caption ="Ortho Limit"
                    GUID = Begin
                        0x237b3e856b72714183b367108d02a015
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =93
                    IMESentenceMode =3
                    ListWidth =360
                    Left =4140
                    Top =5220
                    Width =1080
                    Height =270
                    TabIndex =75
                    GUID = Begin
                        0x309f2643de97644baaf00dad0c345a5e
                    End
                    Name ="cboWaitingPeriod"
                    ControlSource ="WaitingPeriod"
                    RowSourceType ="Value List"
                    RowSource ="\"Yes\";\"No\""
                    ColumnWidths ="360"
                End
                Begin Label
                    OverlapFlags =87
                    Left =4140
                    Top =4980
                    Width =1080
                    Height =240
                    FontWeight =700
                    Name ="Label241"
                    Caption ="Wait Period"
                    GUID = Begin
                        0x096959927beb2146be283b094e723fbf
                    End
                End
            End
        End
        Begin FormFooter
            BackColor =12632256
            Name ="FormFooter2"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =4515
                    Top =930
                    Width =432
                    Height =432
                    FontSize =8
                    Name ="btnGotoSubscriber"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =6435
                    Top =930
                    Width =432
                    Height =432
                    FontSize =8
                    TabIndex =2
                    Name ="btnPrintMemCards"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5475
                    Top =930
                    Width =432
                    Height =432
                    FontSize =8
                    TabIndex =1
                    Name ="btnInviteLtr"
                    OnClick ="[Event Procedure]"
                    OnDblClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =7395
                    Top =930
                    Width =432
                    Height =432
                    FontSize =8
                    TabIndex =3
                    Name ="btnPrevMemCards"
                    OnClick ="[Event Procedure]"
                    OnExit ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3555
                    Top =930
                    Width =432
                    Height =432
                    FontSize =8
                    TabIndex =4
                    Name ="cmdLog"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =3450
                    Top =435
                    Width =600
                    Height =465
                    FontWeight =700
                    Name ="Label158"
                    Caption ="Go To\015\012Log"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =4395
                    Top =435
                    Width =675
                    Height =465
                    FontWeight =700
                    Name ="Label159"
                    Caption ="Go To\015\012Subscr"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =5190
                    Top =435
                    Width =900
                    Height =465
                    FontWeight =700
                    Name ="Label160"
                    Caption ="Print\015\012Invite Ltr"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =6120
                    Top =300
                    Width =945
                    Height =600
                    FontWeight =700
                    Name ="Label161"
                    Caption ="Print\015\012Member\015\012Cards"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =7080
                    Top =285
                    Width =1110
                    Height =615
                    FontWeight =700
                    Name ="Label162"
                    Caption ="Preview\015\012Member Cards"
                End
                Begin Line
                    OverlapFlags =85
                    Left =15
                    Top =45
                    Width =10800
                    Name ="Line163"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =8580
                    Top =930
                    Width =432
                    Height =432
                    FontSize =8
                    TabIndex =5
                    Name ="cmdEligEmps"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =8265
                    Top =285
                    Width =1110
                    Height =615
                    FontWeight =700
                    Name ="Label165"
                    Caption ="Beginning\015\012Eligible\015\012Employees"
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =2655
                    Top =915
                    Width =432
                    Height =432
                    TabIndex =6
                    Name ="btnCancelGrp"
                    OnClick ="[Event Procedure]"
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =2
                    Left =2400
                    Top =420
                    Width =990
                    Height =600
                    FontWeight =700
                    Name ="Label173"
                    Caption ="Cancel Group "
                End
                Begin TextBox
                    OverlapFlags =85
                    Left =2400
                    Top =105
                    Width =1005
                    Height =255
                    TabIndex =7
                    Name ="txtPassword"
                    InputMask ="Password"
                End
                Begin CommandButton
                    Visible = NotDefault
                    OverlapFlags =93
                    Left =630
                    Top =914
                    Width =450
                    Height =450
                    TabIndex =8
                    Name ="cmdAllAmerican"
                    OnClick ="[Event Procedure]"
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextAlign =2
                    Left =360
                    Top =299
                    Width =990
                    Height =720
                    FontWeight =700
                    Name ="lblAllAmerican"
                    Caption ="All American Upload"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons

Option Explicit
Dim mstrVarRetVal As String
Dim mintGintNewRecord As Integer
Dim strCustKey As String
Dim strCustName As String, strGeoID As String, strAddr1 As String, strAddr2 As String
Dim strCity As String, strState As String, strZip As String, strPhone1 As String, strPhone2 As String
Dim strAttnName As String, strContName As String, strFax As String, strCustClass As String, strAgent As String
Dim Msg As String
Dim Response As String
Dim fValid As Boolean
Private Sub btnCancelGrp_Click()

On Error GoTo Err_btnCancelGrp_Click
    
    Dim strPassword As String
    strPassword = Nz(Me![txtPassword])
    
    If strPassword <> "panthers" Or strPassword = "" Then
        MsgBox "You have not entered the correct password and will not be allowed to continue."
        Exit Sub
    End If

    Dim intResponse As Integer
    Dim Msg As String
    Dim strGroupID As String
    
    strGroupID = Me!ctlGROUPid
    
    Msg = "You are about to cancel a group!" & vbCrLf
    Msg = Msg & "Do you have permission to cancel a group?" & vbCrLf
    Msg = Msg & vbCrLf
    Msg = Msg & "If you do not have permission to cancel a group, click 'Cancel' now!" & vbCrLf
    Msg = Msg & vbCrLf
    Msg = Msg & "Do you want to delete all of the subscribers in the group from the database," & vbCrLf
    Msg = Msg & "or do you want to change their status to pending?" & vbCrLf
    Msg = Msg & "Changing the status of the subscribers to pending allows you to print flyers" & vbCrLf
    Msg = Msg & "for each subscriber inviting them to join the QCD Individual Benefit Program." & vbCrLf
    Msg = Msg & vbCrLf
    Msg = Msg & "Press the 'Yes' button to delete the subscribers from the database." & vbCrLf
    Msg = Msg & "Press the 'No' button to change the status of the subscribers to pending." & vbCrLf
    Msg = Msg & "Press the 'Cancel' button to leave everything as it is."
    
    intResponse = MsgBox(Msg, vbYesNoCancel + vbQuestion, "Cancel group!")
    
    If intResponse = vbYes Then
        'delete all of the subscribers in the group
        intResponse = MsgBox("This will delete all of the subscribers in the group from the database.  Are you sure you want to do that?", vbYesNo + vbExclamation, "Delete subscribers.")
        If intResponse = vbYes Then
            Call DeleteSubscribers(strGroupID)
            With Me
                .ctlGRcancelledDate = Now()
                .ctlGRcancelled = True
                .ctlGROUPid.BackColor = 65280
                .ctlGRname.BackColor = 65280
            End With
        Else
            Exit Sub
        End If
    ElseIf intResponse = vbNo Then
        'change the status of subscribers to pending
        If Not SetPending_GrpSubr(strGroupID) Then
            MsgBox "There was an error changing the Status of the Group Subscribers to Pending.", vbExclamation, "Processing Error"
        Else
            MsgBox "The Group Subscribers status has been changed to Pending.", vbInformation, "Status Update"
            With Me
                .ctlGRcancelledDate = Now()
                .ctlGRcancelled = True
                .ctlGROUPid.BackColor = 65280
                .ctlGRname.BackColor = 65280
            End With
        End If
    End If
               
Exit_btnCancelGrp_Click:
    Exit Sub
    
Err_btnCancelGrp_Click:
    MsgBox "Error number " & Err.Number & ": " & Err.DESCRIPTION
    GoTo Exit_btnCancelGrp_Click:

End Sub
Private Sub btnGotoSubscriber_Click()

On Error GoTo Err_btnGotoSubscriber

    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset
    Dim strSQL As String
    Dim strGroupID
    
    Dim strDocName As String
    Dim strLinkCriteria As String
    Dim intGroupType As Integer
    Dim strRS As String
    
    Call Form_BeforeUpdate(False)
    
    If fValid = False Then
        GoTo Exit_btnGotoSubscriber
    End If
            
    Set dbs = CurrentDb()
    
    strGroupID = Me.GROUPid
    
    'save everything on the group screen before going to the subscriber screen
    'Me.Dirty = False
    
    'check to see if the coverage list box has been populated
    'if it has not then display a message and exit
    strSQL = "SELECT tblPlans.PlanDesc AS Plan, tblCoverage." & _
             "COVERdescr AS Description, Format([Rate],'Standard') AS Rates, " & _
             "tblRates.RateID, tblRates.PlanID, tblRates.CoverID " & _
             "FROM (tblRates " & _
             "INNER JOIN tblCoverage ON tblRates.CoverID = tblCoverage.CoverID) " & _
             "INNER JOIN tblPlans ON tblRates.PlanID = tblPlans.PlanID " & _
             "WHERE ((tblRates.GroupID)='" & strGroupID & "') " & _
             "ORDER BY tblRates.PlanID, tblRates.CoverID;"
   
    Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
    
    If rst.RecordCount > 0 Then
        
        'if the group is cancelled then open the pending subscriber form
        'otherwise open the normal subscriber form
        If Me.ctlGRcancelled = True Then
            strDocName = "frmPendingSubscr"
        Else
            strDocName = "frmGrpSubscr"
        End If
        
        'detemine what type of group it is, i.e. All American etc
        intGroupType = optgrpGroupType.Value
        strRS = "SELECT DISTINCTROW tblSubscr.*, tblGrp.GRcontBEG, tblGrp.GRcontEND, tblGrp.GRname, " & _
                "tblGrp.GRcancelled, tblGrp.GRhold, tblGrp.GroupType, tblCoverage.COVERdescr, " & _
                "tblCoverage.COVERcode, tblRates.Rate " & _
                "FROM ((tblSubscr " & _
                "LEFT JOIN tblGrp ON tblSubscr.SUBgroupID = tblGrp.GroupID) " & _
                "LEFT JOIN tblCoverage ON tblSubscr.CoverID = tblCoverage.CoverID) " & _
                "LEFT JOIN tblRates ON tblSubscr.RateID = tblRates.RateID " & _
                "WHERE (((tblSubscr.SUBgroupID) = '" & Me.ctlGROUPid & "') " & _
                "And ((tblSubscr.SUBstatus) = 'GRSUB')) " & _
                "ORDER BY tblSubscr.SUBlastNAME;"
        
        'open the form in design view and set the recordsouce
        'close the form in design view
        'open the form with the recordsource set
        'pass the group type as an open arg
'        DoCmd.Echo False
'        DoCmd.OpenForm strDocName, acViewDesign
'        With Forms(strDocName)
'              .Tag = strGroupID & "|" & CStr(intGroupType)
'              .RecordSource = strRS
'              .FilterOn = True
'        End With
'        DoCmd.Close acForm, strDocName, acSaveYes
'        DoCmd.Echo True
'        DoCmd.OpenForm strDocName, , , , acFormEdit, acWindowNormal, intGroupType

        DoCmd.OpenForm strDocName, , , "SUBgroupID ='" & strGroupID & "'"
    Else
        MsgBox "You must populate the plans, coverages, and rates on the Group form before setting up subscribers."
    End If
    
    Set dbs = Nothing

Exit_btnGotoSubscriber:
    Exit Sub

Err_btnGotoSubscriber:
    MsgBox Error$
    DoCmd.SetWarnings True
    DoCmd.Hourglass False

    Resume Exit_btnGotoSubscriber

End Sub

Private Sub btnInviteLtr_Click()

On Error GoTo btnInviteLtr_Err

    Dim strGroupID As String
    strGroupID = Me![GROUPid]
    DoCmd.OpenReport "rptInvite", A_PREVIEW, , "[GroupID] = '" & strGroupID & "'"

btnInviteLtr_Exit:
    Exit Sub

btnInviteLtr_Err:
    MsgBox Error$
    Resume btnInviteLtr_Exit

End Sub
Private Sub btnPrevMemCards_Click()

    On Error GoTo PROC_ERR
    
    Dim strResponse As String
    Dim Response As String
    Dim Msg As String
    Dim strGroupID As String
    Dim strSQL As String

    If DCount("[SUBssn]", "tblSubscr", "IsNull([SUBeffDATE]) AND [SUBgroupID] = Forms![frmGrp]![GroupID]") > 0 Then
        strResponse = MsgBox("The Effective Date on the Membership Cards are printed from the Group Subscriber's Effective Dates.  There are " + Str$(DCount("[SUBssn]", "tblSubscr", "IsNull([SUBeffDATE]) AND [SUBgroupID] = Forms![frmGrp]![GroupID]")) + " Subscribers in this Group which do not have Effective Dates." + Chr$(13) + "You must enter Effective Dates for these " + Str$(DCount("[SUBssn]", "tblSubscr", "IsNull([SUBeffDATE]) AND [SUBgroupID] = Forms![frmGrp]![GroupID]")) + " Subscribers before printing Membership Cards for this Group.", 16, "MISSING Subscriber EFFECTIVE DATES")
        Exit Sub
    End If
'Debug.Print DCount("[SUBssn]", "tblSubscr", "IsNull([SUBeffDATE]) AND [SUBgroupID] = Forms![frmGrp]![GroupID]")
    If Me![ctlGRcardstock] = -1 Then
        Msg = "This Group requires special card stock to print member cards!" & vbCrLf
        Msg = Msg & "Are you ready to start printing?"
        Response = MsgBox(Msg, vbYesNo + vbExclamation + vbDefaultButton2, "Special Condition!")

        If Response = vbNo Then
            DoCmd.Hourglass False
        Else
            strGroupID = Me![GROUPid]
            
            'need to update tmpEDI_rpt
            ExecuteSQL "DELETE FROM tmpEDI_rpt"
            
            strSQL = "INSERT INTO tmpEDI_Rpt ( SUBssn , SUBfirstNAME , " & _
                        "SUBlastNAME , SUBStreet , SUBcity , SUBstate , " & _
                        "SUBzip , GroupID ) " & _
                        "SELECT tblSubscr.SubSSN , tblSubscr.SubFirstName ," & _
                        " tblSubscr.SubLastName , [SubStreet1] + ' ' + " & _
                        "[SubStreet2] AS Street , tblSubscr.SubCity , " & _
                        "tblSubscr.SubState , tblSubscr.SubZip , tblSubscr.SubGroupID " & _
                        "FROM tblSubscr " & _
                        "WHERE (((tblSubscr.SubGroupID)='" & strGroupID & "'))"
            ExecuteSQL strSQL
            
            'DoCmd.OpenReport "rptCardMemGrp", acViewPreview, , "[GroupID] = '" & strGroupID & "'"
            DoCmd.OpenReport "rptCardMemGrp", acViewPreview
            DoCmd.SetWarnings False
            DoCmd.RunSQL "UPDATE DISTINCTROW tblSubscr SET tblSubscr.SUBcardPRT =" & "Yes" & ", tblSubscr.SUBcardPRTdte = Date() WHERE (((tblSubscr.SUBgroupID)=[Forms]![frmGrp]![GroupID]));"
            DoCmd.SetWarnings True
            Msg = "Please change the card stock back to the original stock!"
            Response = MsgBox(Msg, vbOKOnly, "Special Condition!")
            Exit Sub
        End If

    Else
            strGroupID = Me![GROUPid]
            
            'need to update tmpEDI_rpt
            ExecuteSQL "DELETE FROM tmpEDI_rpt"
            
            strSQL = "INSERT INTO tmpEDI_Rpt ( SUBssn , SUBfirstNAME , " & _
                        "SUBlastNAME , SUBStreet , SUBcity , SUBstate , " & _
                        "SUBzip , GroupID ) " & _
                        "SELECT tblSubscr.SubSSN , tblSubscr.SubFirstName ," & _
                        " tblSubscr.SubLastName , [SubStreet1] + ' ' + " & _
                        "[SubStreet2] AS Street , tblSubscr.SubCity , " & _
                        "tblSubscr.SubState , tblSubscr.SubZip , tblSubscr.SubGroupID " & _
                        "FROM tblSubscr " & _
                        "WHERE (((tblSubscr.SubGroupID)='" & strGroupID & "'))"
            ExecuteSQL strSQL
            
            'DoCmd.OpenReport "rptCardMemGrp", acViewPreview, , "[GroupID] = '" & strGroupID & "'"
            DoCmd.OpenReport "rptCardMemGrp", acViewPreview
            DoCmd.SetWarnings False
            DoCmd.RunSQL "UPDATE DISTINCTROW tblSubscr SET tblSubscr.SUBcardPRT =" & "Yes" & ", tblSubscr.SUBcardPRTdte = Date() WHERE (((tblSubscr.SUBgroupID)=[Forms]![frmGrp]![GroupID]));"
            DoCmd.SetWarnings True
    End If

    Exit Sub

PROC_EXIT:
    Exit Sub

PROC_ERR:
    MsgBox Err.DESCRIPTION
    Resume PROC_EXIT
    
End Sub
Private Sub btnPrevMemCards_Exit(Cancel As Integer)

'12-06-1999 Added this print preview button for those new larger groups
'if too many cards are printed at once, the printer tends to jam - Suzanne Johnsen
 
 On Error GoTo PROC_ERR
 
    DoCmd.SetWarnings False
    DoCmd.RunSQL "UPDATE DISTINCTROW tblSubscr SET tblSubscr.SUBcardPRT =" & "Yes" & ", tblSubscr.SUBcardPRTdte = Date() WHERE (((tblSubscr.SUBgroupID)=[Forms]![frmGrp]![GroupID]));"
    DoCmd.SetWarnings True

  Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  DoCmd.SetWarnings True
  DoCmd.Hourglass False

  Resume Next
End Sub
Private Sub btnPrintMemCards_Click()
    
    On Error GoTo Err_btnPrintMemCards_Click

    Dim stDocName As String
    Dim stLinkCriteria As String

    stDocName = "fdlgPrintGrpCards"
    DoCmd.OpenForm stDocName, , , stLinkCriteria

Exit_btnPrintMemCards_Click:
    Exit Sub

Err_btnPrintMemCards_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_btnPrintMemCards_Click

    
End Sub
Private Sub cboCoverage_AfterUpdate()
    
    With Me
        .txtRate = ""
        .txtRateID = ""
        .txtRate.SetFocus
        '.cmdRateCoverageDelete.Enabled = False
    End With
    
End Sub
Private Sub cmdAllAmerican_Click()

    On Error GoTo ErrorHandler
    
    ' Upload data to create export TextFile
    Dim FileDialog As clsFileDialog
  
    
    Dim strSQL As String
    Dim strSQL2 As String
    Dim dbs As DAO.Database
    Dim rst As DAO.Recordset
    Dim rst2 As DAO.Recordset
    Dim strID As String
    Dim strNewBRID As String
    Dim newCnt As Long
    Dim I As Integer
    Dim strSpec As String
    Dim strTableName As String
    Dim strFileName As String
    
    DoCmd.SetWarnings False
    DoCmd.Hourglass True
    
    ' Export the Group Subscribers and dependents
    ExecuteSQL ("TRUNCATE TABLE tmpExportAllAmerican")
    
    DoCmd.OpenQuery "qappAllAmerican_Upload_Subscr"
    DoCmd.OpenQuery "qappAllAmerican_Upload_Dep"
    
    ' Update the MemberID
    Set dbs = CurrentDb()
    
    'first process the whites and red pluses only with dependents
    strSQL = "SELECT DISTINCT tmpExportAllAmerican.EISBRID " & _
             "FROM tmpExportAllAmerican " & _
             "WHERE (((tmpExportAllAmerican.EINMPLAN)='QCDWHT-" & _
             "QCD' Or (tmpExportAllAmerican.EINMPLAN)='QCDWHT-" & _
             "NGL' Or (tmpExportAllAmerican.EINMPLAN)='QCDRPL-" & _
             "QCD' Or (tmpExportAllAmerican.EINMPLAN)='QCDRPL-" & _
             "NGL') AND ((tmpExportAllAmerican.EIRECID)='M'));"
    
    Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)

    If rst.RecordCount > 0 Then
    
    Do While Not rst.EOF
        With rst
        strID = .Fields("EISBRID")
        newCnt = 2
        
        strSQL2 = "SELECT tmpExportAllAmerican.EIMBRID " & _
                "FROM tmpExportAllAmerican " & _
                "WHERE (((tmpExportAllAmerican.EISBRID)= '" & strID & "')" & _
                "AND ((Right([tmpExportAllAmerican].[EIMBRID],1))='2') " & _
                "AND ((tmpExportAllAmerican.EIRECID)='M'));"
                
        Set rst2 = dbs.OpenRecordset(strSQL2, dbOpenDynaset, dbSeeChanges)
            If rst2.RecordCount > 0 Then
                Do While Not rst2.EOF
                    I = 1
                    For I = 1 To 2
                        rst2.Edit
                        rst2.Fields("EIMBRID") = Left(rst2.Fields("EIMBRID"), 10) & newCnt
                        rst2.Update
                    rst2.MoveNext
                    Next I
                    newCnt = newCnt + 1
                Loop
            End If
            
        .MoveNext
        End With
    Loop
    End If
    
    'next process reds and blues with dependents
    strSQL = "SELECT DISTINCT tmpExportAllAmerican.EISBRID " & _
           "FROM tmpExportAllAmerican " & _
           "WHERE (((tmpExportAllAmerican.EINMPLAN)= 'QCDRED-QCD' " & _
           "Or (tmpExportAllAmerican.EINMPLAN)= 'QCDBLU-NGL') " & _
           "AND ((tmpExportAllAmerican.EIRECID)='M'));"
           
    Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)

    If rst.RecordCount > 0 Then
    
    Do While Not rst.EOF
        
        With rst
        strID = .Fields("EISBRID")
        newCnt = 2
        
        strSQL2 = "SELECT tmpExportAllAmerican.EIMBRID " & _
                "FROM tmpExportAllAmerican " & _
                "WHERE (((tmpExportAllAmerican.EISBRID)= '" & strID & "')" & _
                "AND ((Right([tmpExportAllAmerican].[EIMBRID],1))='2') " & _
                "AND ((tmpExportAllAmerican.EIRECID)='M'));"
                
        Set rst2 = dbs.OpenRecordset(strSQL2, dbOpenDynaset, dbSeeChanges)
        
        If rst2.RecordCount > 0 Then
            Do While Not rst2.EOF
                rst2.Edit
                rst2.Fields("EIMBRID") = Left(rst2.Fields("EIMBRID"), 10) & newCnt
                rst2.Update
                rst2.MoveNext
                newCnt = newCnt + 1
            Loop
        End If
        
        .MoveNext
        End With
        
    Loop
    
    End If
    
    strSpec = "ImportAllAmerican"
    strTableName = "qseltmpExportAllAmerican"
    
    Set FileDialog = New clsFileDialog
  
    With FileDialog
        .DefaultExt = "txt"
        .DialogTitle = "Save Group Link Export file"
        .Filter = "Text files (*.txt)|*.txt|All Files (*.*)|*.*"
        .FilterIndex = 0
        'strFileName = "F:\jdcConsulting\Group Link\" & Me.ctlGroupID & "_AA_Export.txt"
        .FileName = Me.ctlGROUPid & "_AA_Export.txt"
        .Flags = FleFileMustExist + FleHideReadOnly + FleCreatePrompt
        .hWndParent = 0 'Use your form's .hwnd property if available
        .MaxFileSize = 255
        
        If .Show(False) Then
            strFileName = .FileName
            DoCmd.TransferText acExportFixed, strSpec, strTableName, strFileName, 0
        Else
            MsgBox "User cancelled"
        End If
      
    End With
    
    Set FileDialog = Nothing
    
Exit_Point:
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
    
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
        
End Sub
Private Sub cmdEditCoverages_Click()

    DoCmd.OpenForm "frmCoverageCodes", acNormal
    
End Sub
Private Sub cmdEligEmps_Click()

On Error GoTo cmdEligEmps_Click_Err
   
   Dim stDocName As String
   Dim strGroupID As String
   strGroupID = Me![ctlGROUPid]
   stDocName = "fdlgEligEmps"
   DoCmd.OpenForm stDocName, , , , , , strGroupID
    
cmdEligEmps_Click_Exit:
Exit Sub

cmdEligEmps_Click_Err:
    MsgBox "Error number " & Err.Number & ": " & Err.DESCRIPTION
    GoTo cmdEligEmps_Click_Exit
    
End Sub
Private Sub cmdLog_Click()

On Error GoTo Err_cmdLog_Click

    Dim stDocName As String
    Dim stLinkCriteria As String

    stDocName = "frmGrpLogSwitch"
        
    DoCmd.OpenForm stDocName

Exit_cmdLog_Click:
    Exit Sub

Err_cmdLog_Click:
    MsgBox Err.DESCRIPTION
    Resume Exit_cmdLog_Click
    
End Sub
Private Sub cmdRateAddUpdate_Click()
    
    On Error GoTo ErrorHandler
    
    Dim strCustKey As String
    Dim strGroupID As String
    Dim intCoverID As Integer
    Dim lngPlanID As Integer
    Dim dblRate As Double
    
    strCustKey = Me.ctlGROUPid
      
     ' Check to see if this Group is on the Group Table first
    If IsThereGrpQCD(strCustKey) Then
      With Me
        If .cboCoverage <> "" And .txtRate <> "" And .cboPlan <> "" Then
            intCoverID = Me.cboCoverage
            lngPlanID = Me.cboPlan
            dblRate = Me.txtRate
            ExecuteSQL "EXEC uspRateMaintenance '" & strCustKey & "'," & intCoverID & "," & lngPlanID & "," & dblRate & ";"
        Else
            MsgBox "You must enter a Rate and/or Coverage to continue.", vbExclamation, "Processing Stopped"
        End If
        .lstCoverageRate.Requery
        .cboCoverage = ""
        .cboPlan = ""
        .txtRate = ""
      End With
      
    Else
        MsgBox "This group is not in the group table."
    End If
    
Exit_Point:
    
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub
Function IsThereGrpQCD(strGrpID As String) As Boolean

On Error GoTo Err_IsThereGrpQCD

    Dim db As DAO.Database
    Dim rs As DAO.Recordset
    Dim strSQL As String
    strSQL = "SELECT tblGrp.* FROM tblGrp WHERE (((tblGrp.GroupID)='" & strGrpID & "'));"
    
    Set db = CurrentDb()
        
    Set rs = db.OpenRecordset(strSQL, dbOpenSnapshot)
    If rs.RecordCount > 0 Then
        IsThereGrpQCD = True
    Else
        IsThereGrpQCD = False
    End If

    rs.Close
    db.Close
    Set db = Nothing

Exit_IsThereGrpQCD:
    Exit Function

Err_IsThereGrpQCD:
    MsgBox "Error no. " & Err & vbCrLf & vbCrLf & "The following error occurred:  " & Error$
    Resume Exit_IsThereGrpQCD
End Function
Private Sub cmdRateCoverageDelete_Click()
    
    On Error GoTo ErrorHandler
    
    Dim intResp As Integer
    Dim lngRateID As Long
    
    lngRateID = Me.lstCoverageRate.Column(3)
    
    If Me.txtRateID = "" Or IsNull(Me.txtRateID) Then
        MsgBox "Please select a Rate to delete from the list.", vbInformation, "No record selected"
    Else
        'check to see if this Rate is being used on the subscriber table
        If RateUsedCheck(lngRateID) = False Then
            intResp = MsgBox("Are you sure you want to delete this record?", vbQuestion + vbYesNo, "Confirm Delete")
            If intResp = vbYes Then
                'delete the rate from the rate table
                ExecuteSQL "DELETE FROM tblRates WHERE RateID =" & lngRateID & ";"
                With Me
                    .lstCoverageRate.Requery
                    .cboPlan = ""
                    .cboCoverage = ""
                    .txtRate = ""
                    .txtRateID = ""
                End With
            End If
        Else
            MsgBox "The Coverage you are trying to delete is in use.  Please reassign the Subscribers to another coverage and try again.", vbInformation, "No record Deleted"
        End If
    End If
    
Exit_Point:
   Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub
Private Sub ctlGRcancelled_AfterUpdate()

On Error GoTo ErrorHandler
    
   '12-06-1999 If this group is cancelled, move to cancelled date control
    With Me
    Dim fCheck As Boolean
    
    'set all of the subscribers to a pending status
    If Me.ctlGRcancelled = -1 Or ctlGRhold = -1 Then
        DoCmd.GoToControl "ctlGRcancelledDate"
        .ctlGROUPid.BackColor = 65280
        .ctlGRname.BackColor = 65280
        fCheck = SetPending_CancelGrp()
        .GroupPickList.Requery
    'set all of the subscribers back to a group subscriber status
    Else
        .ctlGROUPid.BackColor = 16777215
        .ctlGRname.BackColor = 16777215
        fCheck = SetActive_CancelGrp()
        .GroupPickList.Requery
    End If
       
    End With
    
Exit_Point:
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
    
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub
Private Sub ctlGRcancelled_Exit(Cancel As Integer)
  
  On Error GoTo ErrorHandler
    
  With Me
    
    If Me.ctlGRcancelled = -1 Or ctlGRhold = -1 Then
        .ctlGROUPid.BackColor = 65280
        .ctlGRname.BackColor = 65280
        Else
        .ctlGROUPid.BackColor = 16777215
        .ctlGRname.BackColor = 16777215
    End If
        
    End With
    
Exit_Point:
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
    
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub
Private Sub ctlGRcancelledDate_BeforeUpdate(Cancel As Integer)

On Error GoTo ErrorHandler
    
 With Me
    
    If IsNull(Me.[ctlGRcancelledDate]) And Me.ctlGRcancelled = -1 Then
        
       Msg = "This customer was cancelled" & vbCrLf
       Msg = Msg & "and must have a cancel date!"
       Response = MsgBox(Msg, vbCritical, "Special Condition!")
       DoCmd.CancelEvent
       Exit Sub
    End If
    
    
    End With
    
Exit_Point:
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
    
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point

End Sub
Private Sub ctlGRhold_AfterUpdate()

On Error GoTo ErrorHandler
    
 With Me
    If Me.ctlGRcancelled = -1 Or ctlGRhold = -1 Then
            .ctlGRname.BackColor = 65280
            .ctlGROUPid.BackColor = 65280
        Else
            .ctlGRname.BackColor = 16777215
            .ctlGROUPid.BackColor = 16777215
            
    End If
    End With
    
Exit_Point:
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
    
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub
Private Sub ctlGroupID_AfterUpdate()

On Error GoTo PLTcustKEY_Err

    Dim strCustKey As String
    Dim strSSN As String
    
    strCustKey = Me![ctlGROUPid]

    If IsTherePlatinum(strCustKey) Then
        MsgBox "This ID already exists in Platinum.  " _
        & "Please enter a different Platinum ID  "
        Me.ctlGROUPid.SetFocus
    Else
        ' Do nothing
    End If

PLTcustKEY_Exit:
    DoCmd.Hourglass False
    Exit Sub

PLTcustKEY_Err:
    If Err = 94 Then
        Resume Next
    End If

    DoCmd.Hourglass False
    MsgBox Error$
    Resume PLTcustKEY_Exit
End Sub
Private Sub ctlGRreinstatedDate_BeforeUpdate(Cancel As Integer)
    
    On Error GoTo ErrorHandler
        
    If IsNull(Me![ctlGRreinstatedDate]) And (Me![ctlGRcancelled]) = 0 And Not IsNull(Me![ctlGRcancelledDate]) Then
        Msg = "This customer was cancelled" & vbCrLf
        Msg = Msg & "(there is a cancel date)" & vbCrLf
        Msg = Msg & "and must have a reinstatement date!"
        Response = MsgBox(Msg, vbCritical, "Special Condition!")
        DoCmd.CancelEvent
        Exit Sub
    End If
    
Exit_Point:
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
    
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point

End Sub
Private Sub Form_AfterInsert()
'----------------------------------------------------------------------
'Purpose:  Inserts a new customer record into the Platinum table ARCUST
'----------------------------------------------------------------------
'' 11/30/1999 New routine - DAO was used before but PFW did not like it
''            so it was replaced with queries - Suzanne Johnsen
On Error GoTo PROC_ERR

    Dim db As DAO.Database
    Dim rs As DAO.Recordset
    Dim stDocName As String
    
    strCustKey = Me![GROUPid]
    
    'Check to see if this group is in PFW

    If IsTherePlatinum(strCustKey) Then
        'If true, then update PFW
        DoCmd.Hourglass True
        DoCmd.SetWarnings False
        DoCmd.OpenQuery "qupdPFWcust"
        DoCmd.Hourglass False
        DoCmd.SetWarnings True
        Exit Sub
    End If
    
    'Check to see if there is a Geo ID on this Group?
    If IsNull(Me![GRPgeoID]) Then
        MsgBox "Please enter a GEO ID!"
        DoCmd.CancelEvent
       Exit Sub
    End If
    
    ' Check to see if record is in Access;
    'if not, save in Access prior to inserting ARCUST.
    If IsThereAccessGroup(strCustKey) = False Then
        strCustKey = Me![GROUPid]
        strCustName = Nz(Me![GRname], " ")
        strAddr1 = Nz(Me![GRstreet1], " ")
        strAddr2 = Nz(Me![GRstreet2], " ")
        strCity = Nz(Me![GRcity], " ")
        strState = Nz(Me![GRstate], " ")
        strZip = Nz(Me![GRzip], " ")
        strPhone1 = Nz(Me![GRphone1], "")
        strPhone2 = Nz(Me![GRphone2], "")
        strAttnName = Nz(Me![GRmainCONT], " ")
        strContName = Nz(Me![GRsrvCONT], " ")
        strFax = Nz(Me![GRfax], "")
        strGeoID = Nz(Me![GRPgeoID], "")
        'strAgent = Nz(Me![GRagentID1], "")

        Set db = CurrentDb()
        Set rs = db.OpenRecordset("tblGrp", dbOpenDynaset, dbSeeChanges)
    
        rs.AddNew
        rs("GroupID") = strCustKey
        rs("GRname") = strCustName
        rs("GRstreet1") = strAddr1
        rs("GRstreet2") = strAddr2
        rs("GRcity") = strCity
        rs("GRstate") = strState
        rs("GRzip") = strZip
        rs("GRPhone1") = strPhone1
        rs("GRPhone2") = strPhone2
        rs("GRMainCONT") = strAttnName
        rs("GRsrvCONT") = strContName
        rs("GRfax") = strFax
        rs("GRPgeoID") = strGeoID
        'rs("GRagentID1") = strAgent
    
        rs.Update
        rs.Close
        db.Close
    End If
        
    'Append record to PFW
    DoCmd.Hourglass True
    DoCmd.SetWarnings False
    DoCmd.OpenQuery "qappPFWcust"
    
    'MsgBox "Customer's information successfully saved!"
    
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
        
    Exit Sub

PROC_ERR:
  MsgBox "The following error occured: " & Error$
  DoCmd.SetWarnings True
  DoCmd.Hourglass False

  Resume Next

End Sub
Private Sub Form_AfterUpdate()

On Error GoTo Err_Form_AfterUpdate

    Dim strCustKey As String
    strCustKey = Me![GROUPid]
      
    DoCmd.Hourglass True

    If mintGintNewRecord Then
        'did an insert just occur?
        'if yes then,
        'Exit Sub
        DoCmd.Hourglass False
        Exit Sub
    ElseIf IsTherePlatinum(strCustKey) And IsThereAccessGroup(strCustKey) Then
        'If the customer is in Platinum and Access then,
        'this is an true update.
        DoCmd.Hourglass True
        DoCmd.SetWarnings False
        DoCmd.OpenQuery "qupdPFWcust"
       
        DoCmd.SetWarnings True
        DoCmd.Hourglass False
        'MsgBox "Save completed successfully!"
    Else
        'If customer is not in Platinum and in Access then,
        'the customer needs to be copied into Platinum
        DoCmd.Hourglass False
        MsgBox "This customer is not in Platinum.  You must copy the customer information from Access to Platinum before you can update the customer's record in Platinum."
    End If

Exit_Form_AfterUpdate:
    DoCmd.Hourglass False
    Exit Sub

Err_Form_AfterUpdate:
    If Err = 94 Then
        Resume Next
    DoCmd.SetWarnings True
    DoCmd.Hourglass False

    End If

    DoCmd.Hourglass False
    MsgBox Error$
    Resume Exit_Form_AfterUpdate

End Sub
Private Sub Form_BeforeUpdate(intCancel As Integer)

On Error GoTo BeforeUpdate_Err

    strCustKey = Me![GROUPid]
    
    ' check to see if the group type control has been populated
    If IsNull(Me.optgrpGroupType) Then
        MsgBox "Please select a Group Type"
        intCancel = True
        fValid = False
        Me.optgrpGroupType.SetFocus
        GoTo BeforeUpdate_Exit
    End If
    
    ' check to see if the card mail option has been selected
    If IsNull(Me.GRMailCard) Then
        MsgBox "Please select a card mail option!"
        intCancel = True
        fValid = False
        Me.optgrpMailCard.SetFocus
        GoTo BeforeUpdate_Exit
    End If
        
    'Check to see if there is a Geo ID on this Group?
    If IsNull(Me![GRPgeoID]) Then
        MsgBox "Please enter a GEO ID!"
        intCancel = True
        fValid = False
        Me.GRPgeoID.SetFocus
        GoTo BeforeUpdate_Exit
    End If
    
    If IsNull(Me![ctlGRreinstatedDate]) And (Me![ctlGRcancelled]) = 0 And Not IsNull(Me![ctlGRcancelledDate]) Then
        Msg = "This customer was cancelled" & vbCrLf
        Msg = Msg & "(there is a cancel date)" & vbCrLf
        Msg = Msg & "and must have a reinstatement date!"
        Response = MsgBox(Msg, vbCritical, "Special Condition!")
        intCancel = True
        DoCmd.GoToControl "ctlGRreinstatedDate"
        Exit Sub
    End If
    
    If IsNull(Me.[ctlGRcancelledDate]) And Me.ctlGRcancelled = -1 Then
       Msg = "This customer was cancelled" & vbCrLf
       Msg = Msg & "and must have a cancel date!"
       Response = MsgBox(Msg, vbCritical, "Special Condition!")
       intCancel = True
       DoCmd.GoToControl "ctlGRcancelledDate"
       Exit Sub
    End If
    
    'test to see if this is an insert.  We find out by checking if
    'group is already in Access.  If group is not, it is an
    'insert; otherwise it is an update.
    If IsThereAccessGroup(strCustKey) Then
        mintGintNewRecord = False
    Else
        mintGintNewRecord = True
    End If

    If Me.Dirty Then
        Me![DateUpdated] = date
    End If
    
    fValid = True

BeforeUpdate_Exit:
    Exit Sub

BeforeUpdate_Err:
    MsgBox Error$
    Resume BeforeUpdate_Exit

End Sub
Private Sub Form_Current()

On Error GoTo Err_Form_Current

    'If the group id control is populated make sure
    'an agent has been assigned to the group
    If Not IsNull(Me.ctlGROUPid) Then
      If Left(Me.ctlGROUPid, 4) <> "INDV" Then
        If IsAgent(Me.GROUPid) = False Then
            MsgBox "You must populate the agent subform with at least one agent."
            DoCmd.CancelEvent
            Exit Sub
        End If
      End If
    End If
    
    With Me
        .lstCoverageRate.Requery
        .txtRateID = ""
        .txtRate = ""
        .cboCoverage = ""
        .cboPlan = ""
    End With
    
    Me![FindGROUPid] = Null
    Me![AlphaControl] = Null
    Me![GroupPickList] = Null
    
    ' Check to see if this group has been cancelled or put on hold, if true
    ' change backcolor to green
    With Me
        If Me![ctlGRcancelled] = True Or Me![ctlGRhold] = True Then
            .ctlGROUPid.BackColor = 65280
            .ctlGRname.BackColor = 65280
            
            'hide the buttons
            .btnCancelGrp.Visible = False
            .cmdLog.Visible = False
            .btnGotoSubscriber.Visible = False
            .btnInviteLtr.Visible = False
            .btnPrintMemCards.Visible = False
            .btnPrevMemCards.Visible = False
            .cmdEligEmps.Visible = False
            
            'hide the labels
            .Label173.Visible = False
            .Label158.Visible = False
            .Label159.Visible = False
            .Label160.Visible = False
            .Label161.Visible = False
            .Label162.Visible = False
            .Label165.Visible = False
        ElseIf Left(Me.ctlGROUPid, 4) = "INDV" Then
            .ctlGROUPid.BackColor = 65280
            .ctlGRname.BackColor = 65280
            
            'hide the buttons
            .btnCancelGrp.Visible = False
            .cmdLog.Visible = False
            .btnGotoSubscriber.Visible = False
            .btnInviteLtr.Visible = False
            .btnPrintMemCards.Visible = False
            .btnPrevMemCards.Visible = False
            .cmdEligEmps.Visible = False
            
            'hide the labels
            .Label173.Visible = False
            .Label158.Visible = False
            .Label159.Visible = False
            .Label160.Visible = False
            .Label161.Visible = False
            .Label162.Visible = False
            .Label165.Visible = False
        Else
            .ctlGROUPid.BackColor = 16777215
            .ctlGRname.BackColor = 16777215
            
            'show the buttons
            .btnCancelGrp.Visible = True
            .cmdLog.Visible = True
            .btnGotoSubscriber.Visible = True
            .btnInviteLtr.Visible = True
            .btnPrintMemCards.Visible = True
            .btnPrevMemCards.Visible = True
            .cmdEligEmps.Visible = True
            
            'hide the labels
            .Label173.Visible = True
            .Label158.Visible = True
            .Label159.Visible = True
            .Label160.Visible = True
            .Label161.Visible = True
            .Label162.Visible = True
            .Label165.Visible = True
            
        End If
    End With
    
    ' Refresh the Agent IDs
    With Me
      .sfrmAgents.Requery
    End With
    
    'Check to see if this is a new record or existing group, if existing
    'lock Group ID field, so user cannot change it.
    If Not IsNull(Me![ctlGROUPid]) Then
        With Me![ctlGROUPid]
            .Locked = True
            .BackColor = 12632256 'gray
        End With
    Else
        With Me![ctlGROUPid]
            .Locked = False
            .BackColor = 16777215  'white
        End With
    End If
    
    ' Check to see if this is an All American group and unhide the Upload Button
    With Me
      If GroupType = 4 Then
        .cmdAllAmerican.Visible = True
        .lblAllAmerican.Visible = True
      Else
        .cmdAllAmerican.Visible = False
        .lblAllAmerican.Visible = False
      End If
    End With
        
Exit_Form_Current:
    Exit Sub

Err_Form_Current:
    MsgBox Error$
    Resume Exit_Form_Current

End Sub
Private Sub Form_Open(Cancel As Integer)

On Error GoTo ErrorHandler
    
    If Forms!frmGrp.OpenArgs = "Cancel" Then
        Forms!frmGrp.[ctlGRcancelled].Enabled = True
        Forms!frmGrp.[ctlGRcancelledDate].Enabled = True
        With Me
            .GroupPickList.RowSource = "SELECT DISTINCTROW tblGrp.GroupID AS Group_ID, tblGrp.GRname AS Group_Name, tblGrp.GRcancelled " & _
                     "FROM tblGrp WHERE (((tblGrp.GroupID) Like [Forms]![frmGrp]![AlphaControl] & '*') And ((tblGrp.GRcancelled) = 1)) ORDER BY tblGrp.GroupID;"
            .GroupPickList.Requery
        End With
    Else
        With Me
            .GroupPickList.RowSource = "SELECT DISTINCTROW tblGrp.GroupID AS Group_ID, tblGrp.GRname AS Group_Name, tblGrp.GRcancelled " & _
                     "FROM tblGrp WHERE (((tblGrp.GroupID) Like [Forms]![frmGrp]![AlphaControl] & '*') And ((tblGrp.GRcancelled) = 0)) ORDER BY tblGrp.GroupID;"
            .GroupPickList.Requery
        End With
    End If

Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub
Function IsAgent(strGroupID As String) As Boolean

    On Error GoTo ErrorHandler

    Dim dbs As DAO.Database
    Dim rs As DAO.Recordset
    Dim strSQL As String
    
    Set dbs = CurrentDb()

    strSQL = "SELECT tblGrpAgt.GroupID FROM tblGrpAgt WHERE (((tblGrpAgt.GroupID)='" & strGroupID & "'));"
    Set rs = dbs.OpenRecordset(strSQL, dbOpenSnapshot)
    If rs.RecordCount > 0 Then
        IsAgent = True
    Else
        IsAgent = False
    End If

    rs.Close
    dbs.Close
    Set dbs = Nothing
    
Exit_Point:
    Exit Function
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point


End Function

Private Sub GRcontBEG_BeforeUpdate(Cancel As Integer)
    
    On Error GoTo ErrorHandler
    
    If ValidateDateFormat(Me.GRcontBEG) = False Then
        MsgBox "Please correct the Contract Begin Date...it is not in the proper range." & vbCrLf & strMsg, vbCritical, "Validation Failed"
        Cancel = True
    End If
    
Exit_Point:
    DoCmd.Hourglass False
    DoCmd.SetWarnings True
    
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub

Private Sub GRcontBEG_Click()

On Error GoTo ErrorHandler
    
    With Me!GRcontBEG
        .SetFocus
        .SelStart = 0
    End With

Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point

End Sub

Private Sub GRcontEND_BeforeUpdate(Cancel As Integer)

    On Error GoTo ErrorHandler
    
    If ValidateDateFormat(Me.GRcontEND) = False Then
        MsgBox "Please correct the Contract End Date...it is not in the proper range." & vbCrLf & strMsg, vbCritical, "Validation Failed"
        Cancel = True
    End If
    
Exit_Point:
        
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
    
End Sub
Private Sub GRcontEND_Click()

On Error GoTo ErrorHandler
    
    With Me!GRcontEND
        .SetFocus
        .SelStart = 0
    End With

Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point

End Sub
Private Sub GRfax_Click()

On Error GoTo ErrorHandler
    
    With Me!GRfax
        .SetFocus
        .SelStart = 0
    End With

Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point

End Sub
Private Sub GRphone1_Click()

On Error GoTo ErrorHandler
    
    With Me!GRphone1
        .SetFocus
        .SelStart = 0
    End With

Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point

End Sub
Private Sub GRphone2_Click()

    On Error GoTo ErrorHandler
    
    With Me!GRphone2
        .SetFocus
        .SelStart = 0
    End With

Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point

End Sub
Private Sub lstCoverageRate_DblClick(Cancel As Integer)
    
    On Error GoTo ErrorHandler
        
    Dim strSQL As String
    Dim strGroupID As String
    Dim strPlanDesc As String
    Dim strCoverDesc As String
        
    If Not IsNull(RTrim(LTrim(Me.lstCoverageRate.Column(0)))) Or _
    Not IsNull(RTrim(LTrim(Me.lstCoverageRate.Column(1)))) Then
        With Me
        
        strGroupID = RTrim(LTrim(.ctlGROUPid))
        strPlanDesc = RTrim(LTrim(.lstCoverageRate.Column(0)))
        strCoverDesc = RTrim(LTrim(.lstCoverageRate.Column(1)))
            
            
            strSQL = "SELECT tblRates.RateID, tblRates.PlanID, tblRates.CoverID, " & _
                     "tblRates.GroupID, tblPlans.PlanDesc, tblCoverage." & _
                     "COVERdescr " & _
                     "FROM (tblRates INNER JOIN tblCoverage " & _
                     "ON tblRates.CoverID = tblCoverage.CoverID) " & _
                     "INNER JOIN tblPlans " & _
                     "ON tblRates.PlanID = tblPlans.PlanID " & _
                     "WHERE (((tblRates.GroupID)='" & strGroupID & "') " & _
                     "AND ((tblPlans.PlanDesc)='" & strPlanDesc & "') " & _
                     "AND ((tblCoverage.COVERdescr)='" & strCoverDesc & "')) " & _
                     "ORDER BY tblRates.PlanID, tblRates.CoverID;"
                     
            LoadADORecordSet strSQL
            
            .txtRateID = g_adoRS.Fields("RateID")
            .cboPlan = g_adoRS.Fields("PlanID")
            .cboCoverage = g_adoRS.Fields("CoverID")
            .txtRate = .lstCoverageRate.Column(2)
            
        End With
    
        g_adoRS.Close
    End If
        
Exit_Point:
    Exit Sub
    
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point
   
    
End Sub

Private Sub optgrpGroupType_AfterUpdate()

    On Error GoTo ErrorHandler
    
    'check to see if this is an All American group and unhide the Upload Button
    With Me
      If GroupType = 4 Then
        .cmdAllAmerican.Visible = True
        .lblAllAmerican.Visible = True
      Else
        .cmdAllAmerican.Visible = False
        .lblAllAmerican.Visible = False
      End If
    End With
    
Exit_Point:
    Exit Sub
        
ErrorHandler:
    MsgBox Err.DESCRIPTION & " " & Err.Number
    Resume Exit_Point

End Sub